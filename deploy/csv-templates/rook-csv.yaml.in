apiVersion: operators.coreos.com/v1alpha1
kind: ClusterServiceVersion
metadata:
  annotations:
    alm-examples: |-
      [
        {
          "apiVersion": "ceph.rook.io/v1",
          "kind": "CephCluster",
          "metadata": {
            "name": "my-rook-ceph",
            "namespace": "my-rook-ceph"
          },
          "spec": {
            "cephVersion": {
              "image": "quay.io/ceph/ceph:v17.2.5"
            },
            "dataDirHostPath": "/var/lib/rook",
            "mon": {
              "count": 3
            },
            "dashboard": {
              "enabled": true
            },
            "network": {
              "hostNetwork": false
            },
            "rbdMirroring": {
              "workers": 0
            },
            "storage": {
              "useAllNodes": true,
              "useAllDevices": true
            }
          }
        },
        {
          "apiVersion": "ceph.rook.io/v1",
          "kind": "CephBlockPool",
          "metadata": {
            "name": "replicapool",
            "namespace": "my-rook-ceph"
          },
          "spec": {
            "failureDomain": "host",
            "replicated": {
              "size": 3
            },
            "annotations": null
          }
        },
        {
          "apiVersion": "ceph.rook.io/v1",
          "kind": "CephObjectStore",
          "metadata": {
            "name": "my-store",
            "namespace": "my-rook-ceph"
          },
          "spec": {
            "metadataPool": {
              "failureDomain": "host",
              "replicated": {
                "size": 3
              }
            },
            "dataPool": {
              "failureDomain": "host",
              "replicated": {
                "size": 3
              }
            },
            "gateway": {
              "type": "s3",
              "sslCertificateRef": null,
              "port": 8080,
              "securePort": null,
              "instances": 1,
              "placement": null,
              "annotations": null,
              "resources": null
            }
          }
        },
        {
          "apiVersion": "ceph.rook.io/v1",
          "kind": "CephObjectStoreUser",
          "metadata": {
            "name": "my-user",
            "namespace": "my-rook-ceph"
          },
          "spec": {
            "store": "my-store",
            "displayName": "my display name"
          }
        },
        {
          "apiVersion": "ceph.rook.io/v1",
          "kind": "CephNFS",
          "metadata": {
            "name": "my-nfs",
            "namespace": "rook-ceph"
          },
          "spec": {
            "rados": {
              "pool": "myfs-data0",
              "namespace": "nfs-ns"
            },
            "server": {
              "active": 3,
              "placement": null,
              "annotations": null,
              "resources": null
            }
          }
        },
        {
          "apiVersion": "ceph.rook.io/v1",
          "kind": "CephClient",
          "metadata": {
            "name": "cinder",
            "namespace": "rook-ceph"
          },
          "spec": {
            "caps": {
              "mon": "profile rbd",
              "osd": "profile rbd pool=volumes, profile rbd pool=vms, profile rbd-read-only pool=images"
            }
          }
        },
        {
          "apiVersion": "ceph.rook.io/v1",
          "kind": "CephFilesystem",
          "metadata": {
            "name": "myfs",
            "namespace": "rook-ceph"
          },
          "spec": {
            "dataPools": [
              {
                "compressionMode": "",
                "crushRoot": "",
                "deviceClass": "",
                "erasureCoded": {
                  "algorithm": "",
                  "codingChunks": 0,
                  "dataChunks": 0
                },
                "failureDomain": "host",
                "replicated": {
                  "requireSafeReplicaSize": false,
                  "size": 1,
                  "targetSizeRatio": 0.5
                }
              }
            ],
            "metadataPool": {
              "compressionMode": "",
              "crushRoot": "",
              "deviceClass": "",
              "erasureCoded": {
                "algorithm": "",
                "codingChunks": 0,
                "dataChunks": 0
              },
              "failureDomain": "",
              "replicated": {
                "requireSafeReplicaSize": false,
                "size": 1,
                "targetSizeRatio": 0
              }
            },
            "metadataServer": {
              "activeCount": 1,
              "activeStandby": true,
              "placement": {},
              "resources": {}
            },
            "preservePoolsOnDelete": false,
            "preserveFilesystemOnDelete": false
          }
        },
        {
          "apiVersion": "ceph.rook.io/v1",
          "kind": "CephRBDMirror",
          "metadata": {
            "name": "my-rbd-mirror",
            "namespace": "rook-ceph"
          },
          "spec": {
            "annotations": null,
            "count": 1,
            "placement": {
              "topologyKey": "kubernetes.io/hostname"
            },
            "resources": null
          }
        }
      ]
    capabilities: Basic Install
    operators.operatorframework.io/builder: operator-sdk-v1.25.0
    operators.operatorframework.io/project_layout: unknown
    tectonic-visibility: ocs
    repository: https://github.com/rook/rook
    containerImage: '{{.RookOperatorImage}}'
    externalClusterScript: |-
      IiIiCkNvcHlyaWdodCAyMDIwIFRoZSBSb29rIEF1dGhvcnMuIEFsbCByaWdodHMgcmVzZXJ2ZWQu
      CgpMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxp
      Y2Vuc2UiKTsKeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3
      aXRoIHRoZSBMaWNlbnNlLgpZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQK
      CglodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKClVubGVzcyByZXF1
      aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUK
      ZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElT
      IiBCQVNJUywKV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVp
      dGhlciBleHByZXNzIG9yIGltcGxpZWQuClNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmlj
      IGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKbGltaXRhdGlvbnMgdW5kZXIgdGhl
      IExpY2Vuc2UuCiIiIgoKaW1wb3J0IGVycm5vCmltcG9ydCBzeXMKaW1wb3J0IGpzb24KaW1wb3J0
      IGFyZ3BhcnNlCmltcG9ydCByZQppbXBvcnQgc3VicHJvY2VzcwppbXBvcnQgaG1hYwpmcm9tIGhh
      c2hsaWIgaW1wb3J0IHNoYTEgYXMgc2hhCmZyb20gb3MgaW1wb3J0IGxpbmVzZXAgYXMgTElORVNF
      UApmcm9tIG9zIGltcG9ydCBwYXRoCmZyb20gZW1haWwudXRpbHMgaW1wb3J0IGZvcm1hdGRhdGUK
      aW1wb3J0IHJlcXVlc3RzCmZyb20gcmVxdWVzdHMuYXV0aCBpbXBvcnQgQXV0aEJhc2UKCnB5M2sg
      PSBGYWxzZQppZiBzeXMudmVyc2lvbl9pbmZvLm1ham9yID49IDM6CiAgICBweTNrID0gVHJ1ZQog
      ICAgaW1wb3J0IHVybGxpYi5wYXJzZQoKTW9kdWxlTm90Rm91bmRFcnJvciA9IEltcG9ydEVycm9y
      Cgp0cnk6CiAgICBpbXBvcnQgcmFkb3MKZXhjZXB0IE1vZHVsZU5vdEZvdW5kRXJyb3IgYXMgbm9N
      b2RFcnI6CiAgICBwcmludChmIkVycm9yOiB7bm9Nb2RFcnJ9XG5FeGl0aW5nIHRoZSBzY3JpcHQu
      Li4iKQogICAgc3lzLmV4aXQoMSkKCnRyeToKICAgIGltcG9ydCByYmQKZXhjZXB0IE1vZHVsZU5v
      dEZvdW5kRXJyb3IgYXMgbm9Nb2RFcnI6CiAgICBwcmludChmIkVycm9yOiB7bm9Nb2RFcnJ9XG5F
      eGl0aW5nIHRoZSBzY3JpcHQuLi4iKQogICAgc3lzLmV4aXQoMSkKCnRyeToKICAgICMgZm9yIDIu
      Ny54CiAgICBmcm9tIFN0cmluZ0lPIGltcG9ydCBTdHJpbmdJTwpleGNlcHQgTW9kdWxlTm90Rm91
      bmRFcnJvcjoKICAgICMgZm9yIDMueAogICAgZnJvbSBpbyBpbXBvcnQgU3RyaW5nSU8KCnRyeToK
      ICAgICMgZm9yIDIuNy54CiAgICBmcm9tIHVybHBhcnNlIGltcG9ydCB1cmxwYXJzZQpleGNlcHQg
      TW9kdWxlTm90Rm91bmRFcnJvcjoKICAgICMgZm9yIDMueAogICAgZnJvbSB1cmxsaWIucGFyc2Ug
      aW1wb3J0IHVybHBhcnNlCgp0cnk6CiAgICBmcm9tIGJhc2U2NCBpbXBvcnQgZW5jb2Rlc3RyaW5n
      CmV4Y2VwdDoKICAgIGZyb20gYmFzZTY0IGltcG9ydCBlbmNvZGVieXRlcyBhcyBlbmNvZGVzdHJp
      bmcKCgpjbGFzcyBFeGVjdXRpb25GYWlsdXJlRXhjZXB0aW9uKEV4Y2VwdGlvbik6CiAgICBwYXNz
      CgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMjIyMj
      IyMjIyMjIyMjIyMjIyBEdW1teVJhZG9zICMjIyMjIyMjIyMjIyMjIyMjIwojIyMjIyMjIyMjIyMj
      IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyB0aGlzIGlzIG1haW5seSBmb3Ig
      dGVzdGluZyBhbmQgY291bGQgYmUgdXNlZCB3aGVyZSAncmFkb3MnIGlzIG5vdCBhdmFpbGFibGUK
      CgpjbGFzcyBEdW1teVJhZG9zKG9iamVjdCk6CiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAg
      ICAgc2VsZi5yZXR1cm5fdmFsID0gMAogICAgICAgIHNlbGYuZXJyX21lc3NhZ2UgPSAiIgogICAg
      ICAgIHNlbGYuc3RhdGUgPSAiY29ubmVjdGVkIgogICAgICAgIHNlbGYuY21kX291dHB1dF9tYXAg
      PSB7fQogICAgICAgIHNlbGYuY21kX25hbWVzID0ge30KICAgICAgICBzZWxmLl9pbml0X2NtZF9v
      dXRwdXRfbWFwKCkKICAgICAgICBzZWxmLmR1bW15X2hvc3RfaXBfbWFwID0ge30KCiAgICBkZWYg
      X2luaXRfY21kX291dHB1dF9tYXAoc2VsZik6CiAgICAgICAganNvbl9maWxlX25hbWUgPSAidGVz
      dC1kYXRhL2NlcGgtc3RhdHVzLW91dCIKICAgICAgICBzY3JpcHRfZGlyID0gcGF0aC5hYnNwYXRo
      KHBhdGguZGlybmFtZShfX2ZpbGVfXykpCiAgICAgICAgY2VwaF9zdGF0dXNfc3RyID0gIiIKICAg
      ICAgICB3aXRoIG9wZW4oCiAgICAgICAgICAgIHBhdGguam9pbihzY3JpcHRfZGlyLCBqc29uX2Zp
      bGVfbmFtZSksIG1vZGU9InIiLCBlbmNvZGluZz0iVVRGLTgiCiAgICAgICAgKSBhcyBqc29uX2Zp
      bGU6CiAgICAgICAgICAgIGNlcGhfc3RhdHVzX3N0ciA9IGpzb25fZmlsZS5yZWFkKCkKICAgICAg
      ICBzZWxmLmNtZF9uYW1lc1siZnMgbHMiXSA9ICIiInsiZm9ybWF0IjogImpzb24iLCAicHJlZml4
      IjogImZzIGxzIn0iIiIKICAgICAgICBzZWxmLmNtZF9uYW1lc1sKICAgICAgICAgICAgInF1b3J1
      bV9zdGF0dXMiCiAgICAgICAgXSA9ICIiInsiZm9ybWF0IjogImpzb24iLCAicHJlZml4IjogInF1
      b3J1bV9zdGF0dXMifSIiIgogICAgICAgIHNlbGYuY21kX25hbWVzWwogICAgICAgICAgICAibWdy
      IHNlcnZpY2VzIgogICAgICAgIF0gPSAiIiJ7ImZvcm1hdCI6ICJqc29uIiwgInByZWZpeCI6ICJt
      Z3Igc2VydmljZXMifSIiIgogICAgICAgICMgYWxsIHRoZSBjb21tYW5kcyBhbmQgdGhlaXIgb3V0
      cHV0CiAgICAgICAgc2VsZi5jbWRfb3V0cHV0X21hcFsKICAgICAgICAgICAgc2VsZi5jbWRfbmFt
      ZXNbImZzIGxzIl0KICAgICAgICBdID0gIiIiW3sibmFtZSI6Im15ZnMiLCJtZXRhZGF0YV9wb29s
      IjoibXlmcy1tZXRhZGF0YSIsIm1ldGFkYXRhX3Bvb2xfaWQiOjIsImRhdGFfcG9vbF9pZHMiOlsz
      XSwiZGF0YV9wb29scyI6WyJteWZzLXJlcGxpY2F0ZWQiXX1dIiIiCiAgICAgICAgc2VsZi5jbWRf
      b3V0cHV0X21hcFsKICAgICAgICAgICAgc2VsZi5jbWRfbmFtZXNbInF1b3J1bV9zdGF0dXMiXQog
      ICAgICAgIF0gPSAiIiJ7ImVsZWN0aW9uX2Vwb2NoIjozLCJxdW9ydW0iOlswXSwicXVvcnVtX25h
      bWVzIjpbImEiXSwicXVvcnVtX2xlYWRlcl9uYW1lIjoiYSIsInF1b3J1bV9hZ2UiOjE0Mzg1LCJm
      ZWF0dXJlcyI6eyJxdW9ydW1fY29uIjoiNDU0MDEzODI5MjgzNjY5NjA2MyIsInF1b3J1bV9tb24i
      Olsia3Jha2VuIiwibHVtaW5vdXMiLCJtaW1pYyIsIm9zZG1hcC1wcnVuZSIsIm5hdXRpbHVzIiwi
      b2N0b3B1cyJdfSwibW9ubWFwIjp7ImVwb2NoIjoxLCJmc2lkIjoiYWY0ZTE2NzMtMGI3Mi00MDJk
      LTk5MGEtMjJkMjkxOWQwZjFjIiwibW9kaWZpZWQiOiIyMDIwLTA1LTA3VDAzOjM2OjM5LjkxODAz
      NVoiLCJjcmVhdGVkIjoiMjAyMC0wNS0wN1QwMzozNjozOS45MTgwMzVaIiwibWluX21vbl9yZWxl
      YXNlIjoxNSwibWluX21vbl9yZWxlYXNlX25hbWUiOiJvY3RvcHVzIiwiZmVhdHVyZXMiOnsicGVy
      c2lzdGVudCI6WyJrcmFrZW4iLCJsdW1pbm91cyIsIm1pbWljIiwib3NkbWFwLXBydW5lIiwibmF1
      dGlsdXMiLCJvY3RvcHVzIl0sIm9wdGlvbmFsIjpbXX0sIm1vbnMiOlt7InJhbmsiOjAsIm5hbWUi
      OiJhIiwicHVibGljX2FkZHJzIjp7ImFkZHJ2ZWMiOlt7InR5cGUiOiJ2MiIsImFkZHIiOiIxMC4x
      MTAuMjA1LjE3NDozMzAwIiwibm9uY2UiOjB9LHsidHlwZSI6InYxIiwiYWRkciI6IjEwLjExMC4y
      MDUuMTc0OjY3ODkiLCJub25jZSI6MH1dfSwiYWRkciI6IjEwLjExMC4yMDUuMTc0OjY3ODkvMCIs
      InB1YmxpY19hZGRyIjoiMTAuMTEwLjIwNS4xNzQ6Njc4OS8wIiwicHJpb3JpdHkiOjAsIndlaWdo
      dCI6MH1dfX0iIiIKICAgICAgICBzZWxmLmNtZF9vdXRwdXRfbWFwWwogICAgICAgICAgICBzZWxm
      LmNtZF9uYW1lc1sibWdyIHNlcnZpY2VzIl0KICAgICAgICBdID0gIiIieyJkYXNoYm9hcmQiOiJo
      dHRwczovL2NlcGgtZGFzaGJvYXJkOjg0NDMvIiwicHJvbWV0aGV1cyI6Imh0dHA6Ly9jZXBoLWRh
      c2hib2FyZC1kYjo5MjgzLyJ9IiIiCiAgICAgICAgc2VsZi5jbWRfb3V0cHV0X21hcFsKICAgICAg
      ICAgICAgIiIieyJjYXBzIjogWyJtb24iLCAiYWxsb3cgciwgYWxsb3cgY29tbWFuZCBxdW9ydW1f
      c3RhdHVzIiwgIm9zZCIsICJhbGxvdyByd3ggcG9vbD1kZWZhdWx0LnJndy5tZXRhLCBhbGxvdyBy
      IHBvb2w9LnJndy5yb290LCBhbGxvdyBydyBwb29sPWRlZmF1bHQucmd3LmNvbnRyb2wsIGFsbG93
      IHggcG9vbD1kZWZhdWx0LnJndy5idWNrZXRzLmluZGV4Il0sICJlbnRpdHkiOiAiY2xpZW50Lmhl
      YWx0aGNoZWNrZXIiLCAiZm9ybWF0IjogImpzb24iLCAicHJlZml4IjogImF1dGggZ2V0LW9yLWNy
      ZWF0ZSJ9IiIiCiAgICAgICAgXSA9ICIiIlt7ImVudGl0eSI6ImNsaWVudC5oZWFsdGhjaGVja2Vy
      Iiwia2V5IjoiQVFERmtiTmVmdDViRlJBQVRuZExOVVNFS3J1b3p4aVppM2xyZEE9PSIsImNhcHMi
      OnsibW9uIjoiYWxsb3cgciwgYWxsb3cgY29tbWFuZCBxdW9ydW1fc3RhdHVzIiwib3NkIjoiYWxs
      b3cgcnd4IHBvb2w9ZGVmYXVsdC5yZ3cubWV0YSwgYWxsb3cgciBwb29sPS5yZ3cucm9vdCwgYWxs
      b3cgcncgcG9vbD1kZWZhdWx0LnJndy5jb250cm9sLCBhbGxvdyB4IHBvb2w9ZGVmYXVsdC5yZ3cu
      YnVja2V0cy5pbmRleCJ9fV0iIiIKICAgICAgICBzZWxmLmNtZF9vdXRwdXRfbWFwWwogICAgICAg
      ICAgICAiIiJ7ImNhcHMiOiBbIm1vbiIsICJwcm9maWxlIHJiZCwgYWxsb3cgY29tbWFuZCAnb3Nk
      IGJsb2NrbGlzdCciLCAib3NkIiwgInByb2ZpbGUgcmJkIl0sICJlbnRpdHkiOiAiY2xpZW50LmNz
      aS1yYmQtbm9kZSIsICJmb3JtYXQiOiAianNvbiIsICJwcmVmaXgiOiAiYXV0aCBnZXQtb3ItY3Jl
      YXRlIn0iIiIKICAgICAgICBdID0gIiIiW3siZW50aXR5IjoiY2xpZW50LmNzaS1yYmQtbm9kZSIs
      ImtleSI6IkFRQk9nck5lSGJLMUF4QUF1YllCZVY4UzFVL0dQenE1U1ZlcTZnPT0iLCJjYXBzIjp7
      Im1vbiI6InByb2ZpbGUgcmJkLCBhbGxvdyBjb21tYW5kICdvc2QgYmxvY2tsaXN0JyIsIm9zZCI6
      InByb2ZpbGUgcmJkIn19XSIiIgogICAgICAgIHNlbGYuY21kX291dHB1dF9tYXBbCiAgICAgICAg
      ICAgICIiInsiY2FwcyI6IFsibW9uIiwgInByb2ZpbGUgcmJkLCBhbGxvdyBjb21tYW5kICdvc2Qg
      YmxvY2tsaXN0JyIsICJtZ3IiLCAiYWxsb3cgcnciLCAib3NkIiwgInByb2ZpbGUgcmJkIl0sICJl
      bnRpdHkiOiAiY2xpZW50LmNzaS1yYmQtcHJvdmlzaW9uZXIiLCAiZm9ybWF0IjogImpzb24iLCAi
      cHJlZml4IjogImF1dGggZ2V0LW9yLWNyZWF0ZSJ9IiIiCiAgICAgICAgXSA9ICIiIlt7ImVudGl0
      eSI6ImNsaWVudC5jc2ktcmJkLXByb3Zpc2lvbmVyIiwia2V5IjoiQVFCTmdyTmUxZ2V5S3hBQThl
      a1ZpUmRFK2hzczVPd2VZQmt3Tmc9PSIsImNhcHMiOnsibWdyIjoiYWxsb3cgcnciLCJtb24iOiJw
      cm9maWxlIHJiZCwgYWxsb3cgY29tbWFuZCAnb3NkIGJsb2NrbGlzdCciLCJvc2QiOiJwcm9maWxl
      IHJiZCJ9fV0iIiIKICAgICAgICBzZWxmLmNtZF9vdXRwdXRfbWFwWwogICAgICAgICAgICAiIiJ7
      ImNhcHMiOiBbIm1vbiIsICJhbGxvdyByLCBhbGxvdyBjb21tYW5kICdvc2QgYmxvY2tsaXN0JyIs
      ICJtZ3IiLCAiYWxsb3cgcnciLCAib3NkIiwgImFsbG93IHJ3IHRhZyBjZXBoZnMgKj0qIiwgIm1k
      cyIsICJhbGxvdyBydyJdLCAiZW50aXR5IjogImNsaWVudC5jc2ktY2VwaGZzLW5vZGUiLCAiZm9y
      bWF0IjogImpzb24iLCAicHJlZml4IjogImF1dGggZ2V0LW9yLWNyZWF0ZSJ9IiIiCiAgICAgICAg
      XSA9ICIiIlt7ImVudGl0eSI6ImNsaWVudC5jc2ktY2VwaGZzLW5vZGUiLCJrZXkiOiJBUUJPZ3JO
      ZUVOdW5LeEFBUENtZ0U3UjZHOERjWG5hSjFGMzJxZz09IiwiY2FwcyI6eyJtZHMiOiJhbGxvdyBy
      dyIsIm1nciI6ImFsbG93IHJ3IiwibW9uIjoiYWxsb3cgciwgYWxsb3cgY29tbWFuZCAnb3NkIGJs
      b2NrbGlzdCciLCJvc2QiOiJhbGxvdyBydyB0YWcgY2VwaGZzICo9KiJ9fV0iIiIKICAgICAgICBz
      ZWxmLmNtZF9vdXRwdXRfbWFwWwogICAgICAgICAgICAiIiJ7ImNhcHMiOiBbIm1vbiIsICJhbGxv
      dyByLCBhbGxvdyBjb21tYW5kICdvc2QgYmxvY2tsaXN0JyIsICJtZ3IiLCAiYWxsb3cgcnciLCAi
      b3NkIiwgImFsbG93IHJ3IHRhZyBjZXBoZnMgbWV0YWRhdGE9KiJdLCAiZW50aXR5IjogImNsaWVu
      dC5jc2ktY2VwaGZzLXByb3Zpc2lvbmVyIiwgImZvcm1hdCI6ICJqc29uIiwgInByZWZpeCI6ICJh
      dXRoIGdldC1vci1jcmVhdGUifSIiIgogICAgICAgIF0gPSAiIiJbeyJlbnRpdHkiOiJjbGllbnQu
      Y3NpLWNlcGhmcy1wcm92aXNpb25lciIsImtleSI6IkFRQk9nck5lQUZnY0dCQUF2R3FLT0FEMEQz
      eHhtVlkwUjkxMmRnPT0iLCJjYXBzIjp7Im1nciI6ImFsbG93IHJ3IiwibW9uIjoiYWxsb3cgciwg
      YWxsb3cgY29tbWFuZCAnb3NkIGJsb2NrbGlzdCciLCJvc2QiOiJhbGxvdyBydyB0YWcgY2VwaGZz
      IG1ldGFkYXRhPSoifX1dIiIiCiAgICAgICAgc2VsZi5jbWRfb3V0cHV0X21hcFsKICAgICAgICAg
      ICAgIiIieyJjYXBzIjogWyJtb24iLCAiYWxsb3cgciwgYWxsb3cgY29tbWFuZCAnb3NkIGJsb2Nr
      bGlzdCciLCAibWdyIiwgImFsbG93IHJ3IiwgIm9zZCIsICJhbGxvdyBydyB0YWcgY2VwaGZzIG1l
      dGFkYXRhPSoiXSwgImVudGl0eSI6ICJjbGllbnQuY3NpLWNlcGhmcy1wcm92aXNpb25lci1vcGVu
      c2hpZnQtc3RvcmFnZSIsICJmb3JtYXQiOiAianNvbiIsICJwcmVmaXgiOiAiYXV0aCBnZXQtb3It
      Y3JlYXRlIn0iIiIKICAgICAgICBdID0gIiIiW3siZW50aXR5IjoiY2xpZW50LmNzaS1jZXBoZnMt
      cHJvdmlzaW9uZXItb3BlbnNoaWZ0LXN0b3JhZ2UiLCJrZXkiOiJCUUJPZ3JOZUFGZ2NHQkFBdkdx
      S09BRDBEM3h4bVZZMFI5MTJkZz09IiwiY2FwcyI6eyJtZ3IiOiJhbGxvdyBydyIsIm1vbiI6ImFs
      bG93IHIsIGFsbG93IGNvbW1hbmQgJ29zZCBibG9ja2xpc3QnIiwib3NkIjoiYWxsb3cgcncgdGFn
      IGNlcGhmcyBtZXRhZGF0YT0qIn19XSIiIgogICAgICAgIHNlbGYuY21kX291dHB1dF9tYXBbCiAg
      ICAgICAgICAgICIiInsiY2FwcyI6IFsibW9uIiwgImFsbG93IHIsIGFsbG93IGNvbW1hbmQgJ29z
      ZCBibG9ja2xpc3QnIiwgIm1nciIsICJhbGxvdyBydyIsICJvc2QiLCAiYWxsb3cgcncgdGFnIGNl
      cGhmcyBtZXRhZGF0YT1teWZzIl0sICJlbnRpdHkiOiAiY2xpZW50LmNzaS1jZXBoZnMtcHJvdmlz
      aW9uZXItb3BlbnNoaWZ0LXN0b3JhZ2UtbXlmcyIsICJmb3JtYXQiOiAianNvbiIsICJwcmVmaXgi
      OiAiYXV0aCBnZXQtb3ItY3JlYXRlIn0iIiIKICAgICAgICBdID0gIiIiW3siZW50aXR5IjoiY2xp
      ZW50LmNzaS1jZXBoZnMtcHJvdmlzaW9uZXItb3BlbnNoaWZ0LXN0b3JhZ2UtbXlmcyIsImtleSI6
      IkNRQk9nck5lQUZnY0dCQUF2R3FLT0FEMEQzeHhtVlkwUjkxMmRnPT0iLCJjYXBzIjp7Im1nciI6
      ImFsbG93IHJ3IiwibW9uIjoiYWxsb3cgciwgYWxsb3cgY29tbWFuZCAnb3NkIGJsb2NrbGlzdCci
      LCJvc2QiOiJhbGxvdyBydyB0YWcgY2VwaGZzIG1ldGFkYXRhPW15ZnMifX1dIiIiCiAgICAgICAg
      c2VsZi5jbWRfb3V0cHV0X21hcFsKICAgICAgICAgICAgIiIieyJjYXBzIjogWyJtb24iLCAiYWxs
      b3cgciwgYWxsb3cgY29tbWFuZCBxdW9ydW1fc3RhdHVzLCBhbGxvdyBjb21tYW5kIHZlcnNpb24i
      LCAibWdyIiwgImFsbG93IGNvbW1hbmQgY29uZmlnIiwgIm9zZCIsICJhbGxvdyByd3ggcG9vbD1k
      ZWZhdWx0LnJndy5tZXRhLCBhbGxvdyByIHBvb2w9LnJndy5yb290LCBhbGxvdyBydyBwb29sPWRl
      ZmF1bHQucmd3LmNvbnRyb2wsIGFsbG93IHJ4IHBvb2w9ZGVmYXVsdC5yZ3cubG9nLCBhbGxvdyB4
      IHBvb2w9ZGVmYXVsdC5yZ3cuYnVja2V0cy5pbmRleCJdLCAiZW50aXR5IjogImNsaWVudC5oZWFs
      dGhjaGVja2VyIiwgImZvcm1hdCI6ICJqc29uIiwgInByZWZpeCI6ICJhdXRoIGdldC1vci1jcmVh
      dGUifSIiIgogICAgICAgIF0gPSAiIiJbeyJlbnRpdHkiOiJjbGllbnQuaGVhbHRoY2hlY2tlciIs
      ImtleSI6IkFRREZrYk5lZnQ1YkZSQUFUbmRMTlVTRUtydW96eGlaaTNscmRBPT0iLCJjYXBzIjp7
      Im1vbiI6ICJhbGxvdyByLCBhbGxvdyBjb21tYW5kIHF1b3J1bV9zdGF0dXMsIGFsbG93IGNvbW1h
      bmQgdmVyc2lvbiIsICJtZ3IiOiAiYWxsb3cgY29tbWFuZCBjb25maWciLCAib3NkIjogImFsbG93
      IHJ3eCBwb29sPWRlZmF1bHQucmd3Lm1ldGEsIGFsbG93IHIgcG9vbD0ucmd3LnJvb3QsIGFsbG93
      IHJ3IHBvb2w9ZGVmYXVsdC5yZ3cuY29udHJvbCwgYWxsb3cgcnggcG9vbD1kZWZhdWx0LnJndy5s
      b2csIGFsbG93IHggcG9vbD1kZWZhdWx0LnJndy5idWNrZXRzLmluZGV4In19XSIiIgogICAgICAg
      IHNlbGYuY21kX291dHB1dF9tYXBbCiAgICAgICAgICAgICIiInsiZm9ybWF0IjogImpzb24iLCAi
      cHJlZml4IjogIm1nciBzZXJ2aWNlcyJ9IiIiCiAgICAgICAgXSA9ICIiInsiZGFzaGJvYXJkIjog
      Imh0dHA6Ly9yb29rLWNlcGgtbWdyLWEtNTdjZjlmODRiYy1mNGpubDo3MDAwLyIsICJwcm9tZXRo
      ZXVzIjogImh0dHA6Ly9yb29rLWNlcGgtbWdyLWEtNTdjZjlmODRiYy1mNGpubDo5MjgzLyJ9IiIi
      CiAgICAgICAgc2VsZi5jbWRfb3V0cHV0X21hcFsKICAgICAgICAgICAgIiIieyJlbnRpdHkiOiAi
      Y2xpZW50LmhlYWx0aGNoZWNrZXIiLCAiZm9ybWF0IjogImpzb24iLCAicHJlZml4IjogImF1dGgg
      Z2V0In0iIiIKICAgICAgICBdID0gIiIieyJkYXNoYm9hcmQiOiAiaHR0cDovL3Jvb2stY2VwaC1t
      Z3ItYS01N2NmOWY4NGJjLWY0am5sOjcwMDAvIiwgInByb21ldGhldXMiOiAiaHR0cDovL3Jvb2st
      Y2VwaC1tZ3ItYS01N2NmOWY4NGJjLWY0am5sOjkyODMvIn0iIiIKICAgICAgICBzZWxmLmNtZF9v
      dXRwdXRfbWFwWwogICAgICAgICAgICAiIiJ7ImVudGl0eSI6ICJjbGllbnQuaGVhbHRoY2hlY2tl
      ciIsICJmb3JtYXQiOiAianNvbiIsICJwcmVmaXgiOiAiYXV0aCBnZXQifSIiIgogICAgICAgIF0g
      PSAiIiJbeyJlbnRpdHkiOiJjbGllbnQuaGVhbHRoY2hlY2tlciIsImtleSI6IkFRREZrYk5lZnQ1
      YkZSQUFUbmRMTlVTRUtydW96eGlaaTNscmRBPT0iLCJjYXBzIjp7Im1vbiI6ICJhbGxvdyByLCBh
      bGxvdyBjb21tYW5kIHF1b3J1bV9zdGF0dXMsIGFsbG93IGNvbW1hbmQgdmVyc2lvbiIsICJtZ3Ii
      OiAiYWxsb3cgY29tbWFuZCBjb25maWciLCAib3NkIjogImFsbG93IHJ3eCBwb29sPWRlZmF1bHQu
      cmd3Lm1ldGEsIGFsbG93IHIgcG9vbD0ucmd3LnJvb3QsIGFsbG93IHJ3IHBvb2w9ZGVmYXVsdC5y
      Z3cuY29udHJvbCwgYWxsb3cgcnggcG9vbD1kZWZhdWx0LnJndy5sb2csIGFsbG93IHggcG9vbD1k
      ZWZhdWx0LnJndy5idWNrZXRzLmluZGV4In19XSIiIgogICAgICAgIHNlbGYuY21kX291dHB1dF9t
      YXBbCiAgICAgICAgICAgICIiInsiZW50aXR5IjogImNsaWVudC5jc2ktY2VwaGZzLW5vZGUiLCAi
      Zm9ybWF0IjogImpzb24iLCAicHJlZml4IjogImF1dGggZ2V0In0iIiIKICAgICAgICBdID0gIiIi
      W10iIiIKICAgICAgICBzZWxmLmNtZF9vdXRwdXRfbWFwWwogICAgICAgICAgICAiIiJ7ImVudGl0
      eSI6ICJjbGllbnQuY3NpLXJiZC1ub2RlIiwgImZvcm1hdCI6ICJqc29uIiwgInByZWZpeCI6ICJh
      dXRoIGdldCJ9IiIiCiAgICAgICAgXSA9ICIiIltdIiIiCiAgICAgICAgc2VsZi5jbWRfb3V0cHV0
      X21hcFsKICAgICAgICAgICAgIiIieyJlbnRpdHkiOiAiY2xpZW50LmNzaS1yYmQtcHJvdmlzaW9u
      ZXIiLCAiZm9ybWF0IjogImpzb24iLCAicHJlZml4IjogImF1dGggZ2V0In0iIiIKICAgICAgICBd
      ID0gIiIiW10iIiIKICAgICAgICBzZWxmLmNtZF9vdXRwdXRfbWFwWwogICAgICAgICAgICAiIiJ7
      ImVudGl0eSI6ICJjbGllbnQuY3NpLWNlcGhmcy1wcm92aXNpb25lciIsICJmb3JtYXQiOiAianNv
      biIsICJwcmVmaXgiOiAiYXV0aCBnZXQifSIiIgogICAgICAgIF0gPSAiIiJbXSIiIgogICAgICAg
      IHNlbGYuY21kX291dHB1dF9tYXBbCiAgICAgICAgICAgICIiInsiZW50aXR5IjogImNsaWVudC5j
      c2ktY2VwaGZzLXByb3Zpc2lvbmVyLW9wZW5zaGlmdC1zdG9yYWdlIiwgImZvcm1hdCI6ICJqc29u
      IiwgInByZWZpeCI6ICJhdXRoIGdldCJ9IiIiCiAgICAgICAgXSA9ICIiIltdIiIiCiAgICAgICAg
      c2VsZi5jbWRfb3V0cHV0X21hcFsKICAgICAgICAgICAgIiIieyJlbnRpdHkiOiAiY2xpZW50LmNz
      aS1jZXBoZnMtcHJvdmlzaW9uZXItb3BlbnNoaWZ0LXN0b3JhZ2UtbXlmcyIsICJmb3JtYXQiOiAi
      anNvbiIsICJwcmVmaXgiOiAiYXV0aCBnZXQifSIiIgogICAgICAgIF0gPSAiIiJbXSIiIgogICAg
      ICAgIHNlbGYuY21kX291dHB1dF9tYXBbCiAgICAgICAgICAgICIiInsiZW50aXR5IjogImNsaWVu
      dC5jc2ktY2VwaGZzLXByb3Zpc2lvbmVyIiwgImZvcm1hdCI6ICJqc29uIiwgInByZWZpeCI6ICJh
      dXRoIGdldCJ9IiIiCiAgICAgICAgXSA9ICIiIlt7ImVudGl0eSI6ImNsaWVudC5jc2ktY2VwaGZz
      LXByb3Zpc2lvbmVyIiwia2V5IjoiQVFERmtiTmVmdDViRlJBQVRuZExOVVNFS3J1b3p4aVppM2xy
      ZEE9PSIsImNhcHMiOnsibW9uIjoiYWxsb3cgciIsICJtZ3IiOiJhbGxvdyBydyIsICJvc2QiOiJh
      bGxvdyBydyB0YWcgY2VwaGZzIG1ldGFkYXRhPSoifX1dIiIiCiAgICAgICAgc2VsZi5jbWRfb3V0
      cHV0X21hcFsKICAgICAgICAgICAgIiIieyJjYXBzIjogWyJtb24iLCAiYWxsb3cgciwgYWxsb3cg
      Y29tbWFuZCAnb3NkIGJsb2NrbGlzdCciLCAibWdyIiwgImFsbG93IHJ3IiwgIm9zZCIsICJhbGxv
      dyBydyB0YWcgY2VwaGZzIG1ldGFkYXRhPSoiXSwgImVudGl0eSI6ICJjbGllbnQuY3NpLWNlcGhm
      cy1wcm92aXNpb25lciIsICJmb3JtYXQiOiAianNvbiIsICJwcmVmaXgiOiAiYXV0aCBjYXBzIn0i
      IiIKICAgICAgICBdID0gIiIiW3siZW50aXR5IjoiY2xpZW50LmNzaS1jZXBoZnMtcHJvdmlzaW9u
      ZXIiLCJrZXkiOiJBUURGa2JOZWZ0NWJGUkFBVG5kTE5VU0VLcnVvenhpWmkzbHJkQT09IiwiY2Fw
      cyI6eyJtb24iOiJhbGxvdyByLCAgYWxsb3cgY29tbWFuZCAnb3NkIGJsb2NrbGlzdCciLCAibWdy
      IjoiYWxsb3cgcnciLCAib3NkIjoiYWxsb3cgcncgdGFnIGNlcGhmcyBtZXRhZGF0YT0qIn19XSIi
      IgogICAgICAgIHNlbGYuY21kX291dHB1dF9tYXBbJ3siZm9ybWF0IjogImpzb24iLCAicHJlZml4
      IjogInN0YXR1cyJ9J10gPSBjZXBoX3N0YXR1c19zdHIKCiAgICBkZWYgc2h1dGRvd24oc2VsZik6
      CiAgICAgICAgcGFzcwoKICAgIGRlZiBnZXRfZnNpZChzZWxmKToKICAgICAgICByZXR1cm4gImFm
      NGUxNjczLTBiNzItNDAyZC05OTBhLTIyZDI5MTlkMGYxYyIKCiAgICBkZWYgY29uZl9yZWFkX2Zp
      bGUoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBjb25uZWN0KHNlbGYpOgogICAgICAgIHBh
      c3MKCiAgICBkZWYgcG9vbF9leGlzdHMoc2VsZiwgcG9vbF9uYW1lKToKICAgICAgICByZXR1cm4g
      VHJ1ZQoKICAgIGRlZiBtb25fY29tbWFuZChzZWxmLCBjbWQsIG91dCk6CiAgICAgICAganNvbl9j
      bWQgPSBqc29uLmxvYWRzKGNtZCkKICAgICAgICBqc29uX2NtZF9zdHIgPSBqc29uLmR1bXBzKGpz
      b25fY21kLCBzb3J0X2tleXM9VHJ1ZSkKICAgICAgICBjbWRfb3V0cHV0ID0gc2VsZi5jbWRfb3V0
      cHV0X21hcFtqc29uX2NtZF9zdHJdCiAgICAgICAgcmV0dXJuIHNlbGYucmV0dXJuX3ZhbCwgY21k
      X291dHB1dCwgc3RyKHNlbGYuZXJyX21lc3NhZ2UuZW5jb2RlKCJ1dGYtOCIpKQoKICAgIGRlZiBf
      Y29udmVydF9ob3N0bmFtZV90b19pcChzZWxmLCBob3N0X25hbWUpOgogICAgICAgIGlwX3JlZ194
      ID0gcmUuY29tcGlsZShyIlxkezEsM30uXGR7MSwzfS5cZHsxLDN9LlxkezEsM30iKQogICAgICAg
      ICMgaWYgcHJvdmlkZWQgaG9zdCBpcyBkaXJlY3RseSBhbiBJUCBhZGRyZXNzLCByZXR1cm4gdGhl
      IHNhbWUKICAgICAgICBpZiBpcF9yZWdfeC5tYXRjaChob3N0X25hbWUpOgogICAgICAgICAgICBy
      ZXR1cm4gaG9zdF9uYW1lCiAgICAgICAgaW1wb3J0IHJhbmRvbQoKICAgICAgICBob3N0X2lwID0g
      c2VsZi5kdW1teV9ob3N0X2lwX21hcC5nZXQoaG9zdF9uYW1lLCAiIikKICAgICAgICBpZiBub3Qg
      aG9zdF9pcDoKICAgICAgICAgICAgaG9zdF9pcCA9IGYiMTcyLjkue3JhbmRvbS5yYW5kaW50KDAs
      IDI1NCl9LntyYW5kb20ucmFuZGludCgwLCAyNTQpfSIKICAgICAgICAgICAgc2VsZi5kdW1teV9o
      b3N0X2lwX21hcFtob3N0X25hbWVdID0gaG9zdF9pcAogICAgICAgIGRlbCByYW5kb20KICAgICAg
      ICByZXR1cm4gaG9zdF9pcAoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIFJhZG9zKGNvbmZmaWxl
      PU5vbmUpOgogICAgICAgIHJldHVybiBEdW1teVJhZG9zKCkKCgpjbGFzcyBTM0F1dGgoQXV0aEJh
      c2UpOgoKICAgICIiIkF0dGFjaGVzIEFXUyBBdXRoZW50aWNhdGlvbiB0byB0aGUgZ2l2ZW4gUmVx
      dWVzdCBvYmplY3QuIiIiCgogICAgc2VydmljZV9iYXNlX3VybCA9ICJzMy5hbWF6b25hd3MuY29t
      IgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBhY2Nlc3Nfa2V5LCBzZWNyZXRfa2V5LCBzZXJ2aWNl
      X3VybD1Ob25lKToKICAgICAgICBpZiBzZXJ2aWNlX3VybDoKICAgICAgICAgICAgc2VsZi5zZXJ2
      aWNlX2Jhc2VfdXJsID0gc2VydmljZV91cmwKICAgICAgICBzZWxmLmFjY2Vzc19rZXkgPSBzdHIo
      YWNjZXNzX2tleSkKICAgICAgICBzZWxmLnNlY3JldF9rZXkgPSBzdHIoc2VjcmV0X2tleSkKCiAg
      ICBkZWYgX19jYWxsX18oc2VsZiwgcik6CiAgICAgICAgIyBDcmVhdGUgZGF0ZSBoZWFkZXIgaWYg
      aXQgaXMgbm90IGNyZWF0ZWQgeWV0LgogICAgICAgIGlmICJkYXRlIiBub3QgaW4gci5oZWFkZXJz
      IGFuZCAieC1hbXotZGF0ZSIgbm90IGluIHIuaGVhZGVyczoKICAgICAgICAgICAgci5oZWFkZXJz
      WyJkYXRlIl0gPSBmb3JtYXRkYXRlKHRpbWV2YWw9Tm9uZSwgbG9jYWx0aW1lPUZhbHNlLCB1c2Vn
      bXQ9VHJ1ZSkKICAgICAgICBzaWduYXR1cmUgPSBzZWxmLmdldF9zaWduYXR1cmUocikKICAgICAg
      ICBpZiBweTNrOgogICAgICAgICAgICBzaWduYXR1cmUgPSBzaWduYXR1cmUuZGVjb2RlKCJ1dGYt
      OCIpCiAgICAgICAgci5oZWFkZXJzWyJBdXRob3JpemF0aW9uIl0gPSBmIkFXUyB7c2VsZi5hY2Nl
      c3Nfa2V5fTp7c2lnbmF0dXJlfSIKICAgICAgICByZXR1cm4gcgoKICAgIGRlZiBnZXRfc2lnbmF0
      dXJlKHNlbGYsIHIpOgogICAgICAgIGNhbm9uaWNhbF9zdHJpbmcgPSBzZWxmLmdldF9jYW5vbmlj
      YWxfc3RyaW5nKHIudXJsLCByLmhlYWRlcnMsIHIubWV0aG9kKQogICAgICAgIGlmIHB5M2s6CiAg
      ICAgICAgICAgIGtleSA9IHNlbGYuc2VjcmV0X2tleS5lbmNvZGUoInV0Zi04IikKICAgICAgICAg
      ICAgbXNnID0gY2Fub25pY2FsX3N0cmluZy5lbmNvZGUoInV0Zi04IikKICAgICAgICBlbHNlOgog
      ICAgICAgICAgICBrZXkgPSBzZWxmLnNlY3JldF9rZXkKICAgICAgICAgICAgbXNnID0gY2Fub25p
      Y2FsX3N0cmluZwogICAgICAgIGggPSBobWFjLm5ldyhrZXksIG1zZywgZGlnZXN0bW9kPXNoYSkK
      ICAgICAgICByZXR1cm4gZW5jb2Rlc3RyaW5nKGguZGlnZXN0KCkpLnN0cmlwKCkKCiAgICBkZWYg
      Z2V0X2Nhbm9uaWNhbF9zdHJpbmcoc2VsZiwgdXJsLCBoZWFkZXJzLCBtZXRob2QpOgogICAgICAg
      IHBhcnNlZHVybCA9IHVybHBhcnNlKHVybCkKICAgICAgICBvYmplY3RrZXkgPSBwYXJzZWR1cmwu
      cGF0aFsxOl0KCiAgICAgICAgYnVja2V0ID0gcGFyc2VkdXJsLm5ldGxvY1s6IC1sZW4oc2VsZi5z
      ZXJ2aWNlX2Jhc2VfdXJsKV0KICAgICAgICBpZiBsZW4oYnVja2V0KSA+IDE6CiAgICAgICAgICAg
      ICMgcmVtb3ZlIGxhc3QgZG90CiAgICAgICAgICAgIGJ1Y2tldCA9IGJ1Y2tldFs6LTFdCgogICAg
      ICAgIGludGVyZXN0aW5nX2hlYWRlcnMgPSB7ImNvbnRlbnQtbWQ1IjogIiIsICJjb250ZW50LXR5
      cGUiOiAiIiwgImRhdGUiOiAiIn0KICAgICAgICBmb3Iga2V5IGluIGhlYWRlcnM6CiAgICAgICAg
      ICAgIGxrID0ga2V5Lmxvd2VyKCkKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgbGsg
      PSBsay5kZWNvZGUoInV0Zi04IikKICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAg
      cGFzcwogICAgICAgICAgICBpZiBoZWFkZXJzW2tleV0gYW5kICgKICAgICAgICAgICAgICAgIGxr
      IGluIGludGVyZXN0aW5nX2hlYWRlcnMua2V5cygpIG9yIGxrLnN0YXJ0c3dpdGgoIngtYW16LSIp
      CiAgICAgICAgICAgICk6CiAgICAgICAgICAgICAgICBpbnRlcmVzdGluZ19oZWFkZXJzW2xrXSA9
      IGhlYWRlcnNba2V5XS5zdHJpcCgpCgogICAgICAgICMgSWYgeC1hbXotZGF0ZSBpcyB1c2VkIGl0
      IHN1cGVyc2VkZXMgdGhlIGRhdGUgaGVhZGVyLgogICAgICAgIGlmIG5vdCBweTNrOgogICAgICAg
      ICAgICBpZiAieC1hbXotZGF0ZSIgaW4gaW50ZXJlc3RpbmdfaGVhZGVyczoKICAgICAgICAgICAg
      ICAgIGludGVyZXN0aW5nX2hlYWRlcnNbImRhdGUiXSA9ICIiCiAgICAgICAgZWxzZToKICAgICAg
      ICAgICAgaWYgIngtYW16LWRhdGUiIGluIGludGVyZXN0aW5nX2hlYWRlcnM6CiAgICAgICAgICAg
      ICAgICBpbnRlcmVzdGluZ19oZWFkZXJzWyJkYXRlIl0gPSAiIgoKICAgICAgICBidWYgPSBmIntt
      ZXRob2R9XG4iCiAgICAgICAgZm9yIGtleSBpbiBzb3J0ZWQoaW50ZXJlc3RpbmdfaGVhZGVycy5r
      ZXlzKCkpOgogICAgICAgICAgICB2YWwgPSBpbnRlcmVzdGluZ19oZWFkZXJzW2tleV0KICAgICAg
      ICAgICAgaWYga2V5LnN0YXJ0c3dpdGgoIngtYW16LSIpOgogICAgICAgICAgICAgICAgYnVmICs9
      IGYie2tleX06e3ZhbH1cbiIKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGJ1ZiAr
      PSBmInt2YWx9XG4iCgogICAgICAgICMgYXBwZW5kIHRoZSBidWNrZXQgaWYgaXQgZXhpc3RzCiAg
      ICAgICAgaWYgYnVja2V0ICE9ICIiOgogICAgICAgICAgICBidWYgKz0gZiIve2J1Y2tldH0iCgog
      ICAgICAgICMgYWRkIHRoZSBvYmplY3RrZXkuIGV2ZW4gaWYgaXQgZG9lc24ndCBleGlzdCwgYWRk
      IHRoZSBzbGFzaAogICAgICAgIGJ1ZiArPSBmIi97b2JqZWN0a2V5fSIKCiAgICAgICAgcmV0dXJu
      IGJ1ZgoKCmNsYXNzIFJhZG9zSlNPTjoKICAgIEVYVEVSTkFMX1VTRVJfTkFNRSA9ICJjbGllbnQu
      aGVhbHRoY2hlY2tlciIKICAgIEVYVEVSTkFMX1JHV19BRE1JTl9PUFNfVVNFUl9OQU1FID0gInJn
      dy1hZG1pbi1vcHMtdXNlciIKICAgIEVNUFRZX09VVFBVVF9MSVNUID0gIkVtcHR5IG91dHB1dCBs
      aXN0IgogICAgREVGQVVMVF9SR1dfUE9PTF9QUkVGSVggPSAiZGVmYXVsdCIKICAgIERFRkFVTFRf
      TU9OSVRPUklOR19FTkRQT0lOVF9QT1JUID0gIjkyODMiCgogICAgQGNsYXNzbWV0aG9kCiAgICBk
      ZWYgZ2VuX2FyZ19wYXJzZXIoY2xzLCBhcmdzX3RvX3BhcnNlPU5vbmUpOgogICAgICAgIGFyZ1Ag
      PSBhcmdwYXJzZS5Bcmd1bWVudFBhcnNlcigpCgogICAgICAgIGNvbW1vbl9ncm91cCA9IGFyZ1Au
      YWRkX2FyZ3VtZW50X2dyb3VwKCJjb21tb24iKQogICAgICAgIGNvbW1vbl9ncm91cC5hZGRfYXJn
      dW1lbnQoIi0tdmVyYm9zZSIsICItdiIsIGFjdGlvbj0ic3RvcmVfdHJ1ZSIsIGRlZmF1bHQ9RmFs
      c2UpCiAgICAgICAgY29tbW9uX2dyb3VwLmFkZF9hcmd1bWVudCgKICAgICAgICAgICAgIi0tY2Vw
      aC1jb25mIiwgIi1jIiwgaGVscD0iUHJvdmlkZSBhIGNlcGggY29uZiBmaWxlLiIsIHR5cGU9c3Ry
      CiAgICAgICAgKQogICAgICAgIGNvbW1vbl9ncm91cC5hZGRfYXJndW1lbnQoCiAgICAgICAgICAg
      ICItLXJ1bi1hcy11c2VyIiwKICAgICAgICAgICAgIi11IiwKICAgICAgICAgICAgZGVmYXVsdD0i
      IiwKICAgICAgICAgICAgdHlwZT1zdHIsCiAgICAgICAgICAgIGhlbHA9IlByb3ZpZGVzIGEgdXNl
      ciBuYW1lIHRvIGNoZWNrIHRoZSBjbHVzdGVyJ3MgaGVhbHRoIHN0YXR1cywgbXVzdCBiZSBwcmVm
      aXhlZCBieSAnY2xpZW50LiciLAogICAgICAgICkKICAgICAgICBjb21tb25fZ3JvdXAuYWRkX2Fy
      Z3VtZW50KAogICAgICAgICAgICAiLS1jbHVzdGVyLW5hbWUiLCBkZWZhdWx0PSIiLCBoZWxwPSJD
      ZXBoIGNsdXN0ZXIgbmFtZSIKICAgICAgICApCiAgICAgICAgY29tbW9uX2dyb3VwLmFkZF9hcmd1
      bWVudCgKICAgICAgICAgICAgIi0tbmFtZXNwYWNlIiwgZGVmYXVsdD0iIiwgaGVscD0iTmFtZXNw
      YWNlIHdoZXJlIENlcGhDbHVzdGVyIGlzIHJ1bm5pbmciCiAgICAgICAgKQogICAgICAgIGNvbW1v
      bl9ncm91cC5hZGRfYXJndW1lbnQoCiAgICAgICAgICAgICItLXJndy1wb29sLXByZWZpeCIsIGRl
      ZmF1bHQ9IiIsIGhlbHA9IlJHVyBQb29sIHByZWZpeCIKICAgICAgICApCiAgICAgICAgY29tbW9u
      X2dyb3VwLmFkZF9hcmd1bWVudCgKICAgICAgICAgICAgIi0tcmVzdHJpY3RlZC1hdXRoLXBlcm1p
      c3Npb24iLAogICAgICAgICAgICBkZWZhdWx0PUZhbHNlLAogICAgICAgICAgICBoZWxwPSJSZXN0
      cmljdCBjZXBoQ1NJS2V5cmluZ3MgYXV0aCBwZXJtaXNzaW9ucyB0byBzcGVjaWZpYyBwb29scywg
      Y2x1c3Rlci4iCiAgICAgICAgICAgICsgIk1hbmRhdG9yeSBmbGFncyB0aGF0IG5lZWQgdG8gYmUg
      c2V0IGFyZSAtLXJiZC1kYXRhLXBvb2wtbmFtZSwgYW5kIC0tY2x1c3Rlci1uYW1lLiIKICAgICAg
      ICAgICAgKyAiLS1jZXBoZnMtZmlsZXN5c3RlbS1uYW1lIGZsYWcgY2FuIGFsc28gYmUgcGFzc2Vk
      IGluIGNhc2Ugb2YgY2VwaGZzIHVzZXIgcmVzdHJpY3Rpb24sIHNvIGl0IGNhbiByZXN0cmljdCB1
      c2VyIHRvIHBhcnRpY3VsYXIgY2VwaGZzIGZpbGVzeXN0ZW0iCiAgICAgICAgICAgICsgInNhbXBs
      ZSBydW46IGBweXRob24zIC9ldGMvY2VwaC9jcmVhdGUtZXh0ZXJuYWwtY2x1c3Rlci1yZXNvdXJj
      ZXMucHkgLS1jZXBoZnMtZmlsZXN5c3RlbS1uYW1lIG15ZnMgLS1yYmQtZGF0YS1wb29sLW5hbWUg
      cmVwbGljYXBvb2wgLS1jbHVzdGVyLW5hbWUgcm9va3N0b3JhZ2UgLS1yZXN0cmljdGVkLWF1dGgt
      cGVybWlzc2lvbiB0cnVlYCIKICAgICAgICAgICAgKyAiTm90ZTogUmVzdHJpY3RpbmcgdGhlIGNz
      aS11c2VycyBwZXIgcG9vbCwgYW5kIHBlciBjbHVzdGVyIHdpbGwgcmVxdWlyZSBjcmVhdGluZyBu
      ZXcgY3NpLXVzZXJzIGFuZCBuZXcgc2VjcmV0cyBmb3IgdGhhdCBjc2ktdXNlcnMuIgogICAgICAg
      ICAgICArICJTbyBhcHBseSB0aGVzZSBzZWNyZXRzIG9ubHkgdG8gbmV3IGBDb25zdW1lciBjbHVz
      dGVyYCBkZXBsb3ltZW50IHdoaWxlIHVzaW5nIHRoZSBzYW1lIGBTb3VyY2UgY2x1c3RlcmAuIiwK
      ICAgICAgICApCgogICAgICAgIG91dHB1dF9ncm91cCA9IGFyZ1AuYWRkX2FyZ3VtZW50X2dyb3Vw
      KCJvdXRwdXQiKQogICAgICAgIG91dHB1dF9ncm91cC5hZGRfYXJndW1lbnQoCiAgICAgICAgICAg
      ICItLWZvcm1hdCIsCiAgICAgICAgICAgICItdCIsCiAgICAgICAgICAgIGNob2ljZXM9WyJqc29u
      IiwgImJhc2giXSwKICAgICAgICAgICAgZGVmYXVsdD0ianNvbiIsCiAgICAgICAgICAgIGhlbHA9
      IlByb3ZpZGVzIHRoZSBvdXRwdXQgZm9ybWF0IChqc29uIHwgYmFzaCkiLAogICAgICAgICkKICAg
      ICAgICBvdXRwdXRfZ3JvdXAuYWRkX2FyZ3VtZW50KAogICAgICAgICAgICAiLS1vdXRwdXQiLAog
      ICAgICAgICAgICAiLW8iLAogICAgICAgICAgICBkZWZhdWx0PSIiLAogICAgICAgICAgICBoZWxw
      PSJPdXRwdXQgd2lsbCBiZSBzdG9yZWQgaW50byB0aGUgcHJvdmlkZWQgZmlsZSIsCiAgICAgICAg
      KQogICAgICAgIG91dHB1dF9ncm91cC5hZGRfYXJndW1lbnQoCiAgICAgICAgICAgICItLWNlcGhm
      cy1maWxlc3lzdGVtLW5hbWUiLAogICAgICAgICAgICBkZWZhdWx0PSIiLAogICAgICAgICAgICBo
      ZWxwPSJQcm92aWRlcyB0aGUgbmFtZSBvZiB0aGUgQ2VwaCBmaWxlc3lzdGVtIiwKICAgICAgICAp
      CiAgICAgICAgb3V0cHV0X2dyb3VwLmFkZF9hcmd1bWVudCgKICAgICAgICAgICAgIi0tY2VwaGZz
      LW1ldGFkYXRhLXBvb2wtbmFtZSIsCiAgICAgICAgICAgIGRlZmF1bHQ9IiIsCiAgICAgICAgICAg
      IGhlbHA9IlByb3ZpZGVzIHRoZSBuYW1lIG9mIHRoZSBjZXBoZnMgbWV0YWRhdGEgcG9vbCIsCiAg
      ICAgICAgKQogICAgICAgIG91dHB1dF9ncm91cC5hZGRfYXJndW1lbnQoCiAgICAgICAgICAgICIt
      LWNlcGhmcy1kYXRhLXBvb2wtbmFtZSIsCiAgICAgICAgICAgIGRlZmF1bHQ9IiIsCiAgICAgICAg
      ICAgIGhlbHA9IlByb3ZpZGVzIHRoZSBuYW1lIG9mIHRoZSBjZXBoZnMgZGF0YSBwb29sIiwKICAg
      ICAgICApCiAgICAgICAgb3V0cHV0X2dyb3VwLmFkZF9hcmd1bWVudCgKICAgICAgICAgICAgIi0t
      cmJkLWRhdGEtcG9vbC1uYW1lIiwKICAgICAgICAgICAgZGVmYXVsdD0iIiwKICAgICAgICAgICAg
      cmVxdWlyZWQ9RmFsc2UsCiAgICAgICAgICAgIGhlbHA9IlByb3ZpZGVzIHRoZSBuYW1lIG9mIHRo
      ZSBSQkQgZGF0YXBvb2wiLAogICAgICAgICkKICAgICAgICBvdXRwdXRfZ3JvdXAuYWRkX2FyZ3Vt
      ZW50KAogICAgICAgICAgICAiLS1yZ3ctZW5kcG9pbnQiLAogICAgICAgICAgICBkZWZhdWx0PSIi
      LAogICAgICAgICAgICByZXF1aXJlZD1GYWxzZSwKICAgICAgICAgICAgaGVscD0iUkFET1MgR2F0
      ZXdheSBlbmRwb2ludCAoaW4gPElQPjo8UE9SVD4gZm9ybWF0KS4gTm90ZTogRlFETiBpcyBhbHNv
      IHN1cHBvcnRlZChpbiA8RlFETj46PFBPUlQ+IGZvcm1hdCkiLAogICAgICAgICkKICAgICAgICBv
      dXRwdXRfZ3JvdXAuYWRkX2FyZ3VtZW50KAogICAgICAgICAgICAiLS1yZ3ctdGxzLWNlcnQtcGF0
      aCIsCiAgICAgICAgICAgIGRlZmF1bHQ9IiIsCiAgICAgICAgICAgIHJlcXVpcmVkPUZhbHNlLAog
      ICAgICAgICAgICBoZWxwPSJSQURPUyBHYXRld2F5IGVuZHBvaW50IFRMUyBjZXJ0aWZpY2F0ZSIs
      CiAgICAgICAgKQogICAgICAgIG91dHB1dF9ncm91cC5hZGRfYXJndW1lbnQoCiAgICAgICAgICAg
      ICItLXJndy1za2lwLXRscyIsCiAgICAgICAgICAgIHJlcXVpcmVkPUZhbHNlLAogICAgICAgICAg
      ICBkZWZhdWx0PUZhbHNlLAogICAgICAgICAgICBoZWxwPSJJZ25vcmUgVExTIGNlcnRpZmljYXRp
      b24gdmFsaWRhdGlvbiB3aGVuIGEgc2VsZi1zaWduZWQgY2VydGlmaWNhdGUgaXMgcHJvdmlkZWQg
      KE5PVCBSRUNPTU1FTkRFRCIsCiAgICAgICAgKQogICAgICAgIG91dHB1dF9ncm91cC5hZGRfYXJn
      dW1lbnQoCiAgICAgICAgICAgICItLW1vbml0b3JpbmctZW5kcG9pbnQiLAogICAgICAgICAgICBk
      ZWZhdWx0PSIiLAogICAgICAgICAgICByZXF1aXJlZD1GYWxzZSwKICAgICAgICAgICAgaGVscD0i
      Q2VwaCBNYW5hZ2VyIHByb21ldGhldXMgZXhwb3J0ZXIgZW5kcG9pbnRzIChjb21tYSBzZXBhcmF0
      ZWQgbGlzdCBvZiA8SVA+IGVudHJpZXMgb2YgYWN0aXZlIGFuZCBzdGFuZGJ5IG1ncnMpIiwKICAg
      ICAgICApCiAgICAgICAgb3V0cHV0X2dyb3VwLmFkZF9hcmd1bWVudCgKICAgICAgICAgICAgIi0t
      bW9uaXRvcmluZy1lbmRwb2ludC1wb3J0IiwKICAgICAgICAgICAgZGVmYXVsdD0iIiwKICAgICAg
      ICAgICAgcmVxdWlyZWQ9RmFsc2UsCiAgICAgICAgICAgIGhlbHA9IkNlcGggTWFuYWdlciBwcm9t
      ZXRoZXVzIGV4cG9ydGVyIHBvcnQiLAogICAgICAgICkKICAgICAgICBvdXRwdXRfZ3JvdXAuYWRk
      X2FyZ3VtZW50KAogICAgICAgICAgICAiLS1yYmQtbWV0YWRhdGEtZWMtcG9vbC1uYW1lIiwKICAg
      ICAgICAgICAgZGVmYXVsdD0iIiwKICAgICAgICAgICAgcmVxdWlyZWQ9RmFsc2UsCiAgICAgICAg
      ICAgIGhlbHA9IlByb3ZpZGVzIHRoZSBuYW1lIG9mIGVyYXN1cmUgY29kZWQgUkJEIG1ldGFkYXRh
      IHBvb2wiLAogICAgICAgICkKICAgICAgICBvdXRwdXRfZ3JvdXAuYWRkX2FyZ3VtZW50KAogICAg
      ICAgICAgICAiLS1kcnktcnVuIiwKICAgICAgICAgICAgZGVmYXVsdD1GYWxzZSwKICAgICAgICAg
      ICAgYWN0aW9uPSJzdG9yZV90cnVlIiwKICAgICAgICAgICAgaGVscD0iRHJ5IHJ1biBwcmludHMg
      dGhlIGV4ZWN1dGVkIGNvbW1hbmRzIHdpdGhvdXQgcnVubmluZyB0aGVtIiwKICAgICAgICApCiAg
      ICAgICAgb3V0cHV0X2dyb3VwLmFkZF9hcmd1bWVudCgKICAgICAgICAgICAgIi0tcmFkb3MtbmFt
      ZXNwYWNlIiwKICAgICAgICAgICAgZGVmYXVsdD0iIiwKICAgICAgICAgICAgcmVxdWlyZWQ9RmFs
      c2UsCiAgICAgICAgICAgIGhlbHA9ImRpdmlkZXMgYSBwb29sIGludG8gc2VwYXJhdGUgbG9naWNh
      bCBuYW1lc3BhY2VzIiwKICAgICAgICApCiAgICAgICAgb3V0cHV0X2dyb3VwLmFkZF9hcmd1bWVu
      dCgKICAgICAgICAgICAgIi0tc3Vidm9sdW1lLWdyb3VwIiwKICAgICAgICAgICAgZGVmYXVsdD0i
      IiwKICAgICAgICAgICAgcmVxdWlyZWQ9RmFsc2UsCiAgICAgICAgICAgIGhlbHA9InByb3ZpZGVz
      IHRoZSBuYW1lIG9mIHRoZSBzdWJ2b2x1bWUgZ3JvdXAiLAogICAgICAgICkKICAgICAgICBvdXRw
      dXRfZ3JvdXAuYWRkX2FyZ3VtZW50KAogICAgICAgICAgICAiLS1yZ3ctcmVhbG0tbmFtZSIsCiAg
      ICAgICAgICAgIGRlZmF1bHQ9IiIsCiAgICAgICAgICAgIHJlcXVpcmVkPUZhbHNlLAogICAgICAg
      ICAgICBoZWxwPSJwcm92aWRlcyB0aGUgbmFtZSBvZiB0aGUgcmd3LXJlYWxtIiwKICAgICAgICAp
      CgogICAgICAgIHVwZ3JhZGVfZ3JvdXAgPSBhcmdQLmFkZF9hcmd1bWVudF9ncm91cCgidXBncmFk
      ZSIpCiAgICAgICAgdXBncmFkZV9ncm91cC5hZGRfYXJndW1lbnQoCiAgICAgICAgICAgICItLXVw
      Z3JhZGUiLAogICAgICAgICAgICBhY3Rpb249InN0b3JlX3RydWUiLAogICAgICAgICAgICBkZWZh
      dWx0PUZhbHNlLAogICAgICAgICAgICBoZWxwPSJVcGdyYWRlcyB0aGUgY2VwaENTSUtleXJpbmdz
      KEZvciBleGFtcGxlOiBjbGllbnQuY3NpLWNlcGhmcy1wcm92aXNpb25lcikgd2l0aCBuZXcgcGVy
      bWlzc2lvbnMgbmVlZGVkIGZvciB0aGUgbmV3IGNsdXN0ZXIgdmVyc2lvbiBhbmQgb2xkZXIgcGVy
      bWlzc2lvbiB3aWxsIHN0aWxsIGJlIGFwcGxpZWQuIgogICAgICAgICAgICArICJTYW1wbGUgcnVu
      OiBgcHl0aG9uMyAvZXRjL2NlcGgvY3JlYXRlLWV4dGVybmFsLWNsdXN0ZXItcmVzb3VyY2VzLnB5
      IC0tdXBncmFkZWAsIHRoaXMgd2lsbCB1cGdyYWRlIGFsbCB0aGUgZGVmYXVsdCBjc2kgdXNlcnMo
      bm9uLXJlc3RyaWN0ZWQpIgogICAgICAgICAgICArICJGb3IgcmVzdHJpY3RlZCB1c2VycyhGb3Ig
      ZXhhbXBsZTogY2xpZW50LmNzaS1jZXBoZnMtcHJvdmlzaW9uZXItb3BlbnNoaWZ0LXN0b3JhZ2Ut
      bXlmcyksIHVzZXJzIGNyZWF0ZWQgdXNpbmcgLS1yZXN0cmljdGVkLWF1dGgtcGVybWlzc2lvbiBm
      bGFnIG5lZWQgdG8gcGFzcyBtYW5kYXRvcnkgZmxhZ3MiCiAgICAgICAgICAgICsgIm1hbmRhdG9y
      eSBmbGFnczogJy0tcmJkLWRhdGEtcG9vbC1uYW1lLCAtLWNsdXN0ZXItbmFtZSBhbmQgLS1ydW4t
      YXMtdXNlcicgZmxhZ3Mgd2hpbGUgdXBncmFkaW5nIgogICAgICAgICAgICArICJpbiBjYXNlIG9m
      IGNlcGhmcyB1c2VycyBpZiB5b3UgaGF2ZSBwYXNzZWQgLS1jZXBoZnMtZmlsZXN5c3RlbS1uYW1l
      IGZsYWcgd2hpbGUgY3JlYXRpbmcgdXNlciB0aGVuIHdoaWxlIHVwZ3JhZGluZyBpdCB3aWxsIGJl
      IG1hbmRhdG9yeSB0b28iCiAgICAgICAgICAgICsgIlNhbXBsZSBydW46IGBweXRob24zIC9ldGMv
      Y2VwaC9jcmVhdGUtZXh0ZXJuYWwtY2x1c3Rlci1yZXNvdXJjZXMucHkgLS11cGdyYWRlIC0tcmJk
      LWRhdGEtcG9vbC1uYW1lIHJlcGxpY2Fwb29sIC0tY2x1c3Rlci1uYW1lIHJvb2tzdG9yYWdlICAt
      LXJ1bi1hcy11c2VyIGNsaWVudC5jc2ktcmJkLW5vZGUtcm9va3N0b3JhZ2UtcmVwbGljYXBvb2xg
      IgogICAgICAgICAgICArICJQUzogQW4gZXhpc3Rpbmcgbm9uLXJlc3RyaWN0ZWQgdXNlciBjYW5u
      b3QgYmUgY29udmVydGVkIHRvIGEgcmVzdHJpY3RlZCB1c2VyIGJ5IHVwZ3JhZGluZy4iCiAgICAg
      ICAgICAgICsgIlVwZ3JhZGUgZmxhZyBzaG91bGQgb25seSBiZSB1c2VkIHRvIGFwcGVuZCBuZXcg
      cGVybWlzc2lvbnMgdG8gdXNlcnMsIGl0IHNob3VsZG4ndCBiZSB1c2VkIGZvciBjaGFuZ2luZyB1
      c2VyIGFscmVhZHkgYXBwbGllZCBwZXJtaXNzaW9uLCBmb3IgZXhhbXBsZSB5b3Ugc2hvdWxkbid0
      IGNoYW5nZSBpbiB3aGljaCBwb29sIHVzZXIgaGFzIGFjY2VzcyIsCiAgICAgICAgKQoKICAgICAg
      ICBpZiBhcmdzX3RvX3BhcnNlOgogICAgICAgICAgICBhc3NlcnQgKAogICAgICAgICAgICAgICAg
      dHlwZShhcmdzX3RvX3BhcnNlKSA9PSBsaXN0CiAgICAgICAgICAgICksICJBcmd1bWVudCB0byAn
      Z2VuX2FyZ19wYXJzZXInIHNob3VsZCBiZSBhIGxpc3QiCiAgICAgICAgZWxzZToKICAgICAgICAg
      ICAgYXJnc190b19wYXJzZSA9IHN5cy5hcmd2WzE6XQogICAgICAgIHJldHVybiBhcmdQLnBhcnNl
      X2FyZ3MoYXJnc190b19wYXJzZSkKCiAgICBkZWYgdmFsaWRhdGVfcmJkX21ldGFkYXRhX2VjX3Bv
      b2xfbmFtZShzZWxmKToKICAgICAgICBpZiBzZWxmLl9hcmdfcGFyc2VyLnJiZF9tZXRhZGF0YV9l
      Y19wb29sX25hbWU6CiAgICAgICAgICAgIHJiZF9tZXRhZGF0YV9lY19wb29sX25hbWUgPSBzZWxm
      Ll9hcmdfcGFyc2VyLnJiZF9tZXRhZGF0YV9lY19wb29sX25hbWUKICAgICAgICAgICAgcmJkX3Bv
      b2xfbmFtZSA9IHNlbGYuX2FyZ19wYXJzZXIucmJkX2RhdGFfcG9vbF9uYW1lCgogICAgICAgICAg
      ICBpZiByYmRfcG9vbF9uYW1lID09ICIiOgogICAgICAgICAgICAgICAgcmFpc2UgRXhlY3V0aW9u
      RmFpbHVyZUV4Y2VwdGlvbigKICAgICAgICAgICAgICAgICAgICAiRmxhZyAnLS1yYmQtZGF0YS1w
      b29sLW5hbWUnIHNob3VsZCBub3QgYmUgZW1wdHkiCiAgICAgICAgICAgICAgICApCgogICAgICAg
      ICAgICBpZiByYmRfbWV0YWRhdGFfZWNfcG9vbF9uYW1lID09ICIiOgogICAgICAgICAgICAgICAg
      cmFpc2UgRXhlY3V0aW9uRmFpbHVyZUV4Y2VwdGlvbigKICAgICAgICAgICAgICAgICAgICAiRmxh
      ZyAnLS1yYmQtbWV0YWRhdGEtZWMtcG9vbC1uYW1lJyBzaG91bGQgbm90IGJlIGVtcHR5IgogICAg
      ICAgICAgICAgICAgKQoKICAgICAgICAgICAgY21kX2pzb24gPSB7InByZWZpeCI6ICJvc2QgZHVt
      cCIsICJmb3JtYXQiOiAianNvbiJ9CiAgICAgICAgICAgIHJldF92YWwsIGpzb25fb3V0LCBlcnJf
      bXNnID0gc2VsZi5fY29tbW9uX2NtZF9qc29uX2dlbihjbWRfanNvbikKICAgICAgICAgICAgaWYg
      cmV0X3ZhbCAhPSAwIG9yIGxlbihqc29uX291dCkgPT0gMDoKICAgICAgICAgICAgICAgIHJhaXNl
      IEV4ZWN1dGlvbkZhaWx1cmVFeGNlcHRpb24oCiAgICAgICAgICAgICAgICAgICAgZiJ7Y21kX2pz
      b25bJ3ByZWZpeCddfSBjb21tYW5kIGZhaWxlZC5cbiIKICAgICAgICAgICAgICAgICAgICBmIkVy
      cm9yOiB7ZXJyX21zZyBpZiByZXRfdmFsICE9IDAgZWxzZSBzZWxmLkVNUFRZX09VVFBVVF9MSVNU
      fSIKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgbWV0YWRhdGFfcG9vbF9leGlzdCwgcG9v
      bF9leGlzdCA9IEZhbHNlLCBGYWxzZQoKICAgICAgICAgICAgZm9yIGtleSBpbiBqc29uX291dFsi
      cG9vbHMiXToKICAgICAgICAgICAgICAgICMgaWYgZXJhc3VyZV9jb2RlX3Byb2ZpbGUgaXMgZW1w
      dHkgYW5kIHBvb2wgbmFtZSBleGlzdHMgdGhlbiBpdCByZXBsaWNhIHBvb2wKICAgICAgICAgICAg
      ICAgIGlmICgKICAgICAgICAgICAgICAgICAgICBrZXlbImVyYXN1cmVfY29kZV9wcm9maWxlIl0g
      PT0gIiIKICAgICAgICAgICAgICAgICAgICBhbmQga2V5WyJwb29sX25hbWUiXSA9PSByYmRfbWV0
      YWRhdGFfZWNfcG9vbF9uYW1lCiAgICAgICAgICAgICAgICApOgogICAgICAgICAgICAgICAgICAg
      IG1ldGFkYXRhX3Bvb2xfZXhpc3QgPSBUcnVlCiAgICAgICAgICAgICAgICAjIGlmIGVyYXN1cmVf
      Y29kZV9wcm9maWxlIGlzIG5vdCBlbXB0eSBhbmQgcG9vbCBuYW1lIGV4aXN0cyB0aGVuIGl0IGlz
      IGVjIHBvb2wKICAgICAgICAgICAgICAgIGlmIGtleVsiZXJhc3VyZV9jb2RlX3Byb2ZpbGUiXSBh
      bmQga2V5WyJwb29sX25hbWUiXSA9PSByYmRfcG9vbF9uYW1lOgogICAgICAgICAgICAgICAgICAg
      IHBvb2xfZXhpc3QgPSBUcnVlCgogICAgICAgICAgICBpZiBub3QgbWV0YWRhdGFfcG9vbF9leGlz
      dDoKICAgICAgICAgICAgICAgIHJhaXNlIEV4ZWN1dGlvbkZhaWx1cmVFeGNlcHRpb24oCiAgICAg
      ICAgICAgICAgICAgICAgIlByb3ZpZGVkIHJiZF9lY19tZXRhZGF0YV9wb29sIG5hbWUsIgogICAg
      ICAgICAgICAgICAgICAgIGYiIHtyYmRfbWV0YWRhdGFfZWNfcG9vbF9uYW1lfSwgZG9lcyBub3Qg
      ZXhpc3QiCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgIGlmIG5vdCBwb29sX2V4aXN0Ogog
      ICAgICAgICAgICAgICAgcmFpc2UgRXhlY3V0aW9uRmFpbHVyZUV4Y2VwdGlvbigKICAgICAgICAg
      ICAgICAgICAgICBmIlByb3ZpZGVkIHJiZF9kYXRhX3Bvb2wgbmFtZSwge3JiZF9wb29sX25hbWV9
      LCBkb2VzIG5vdCBleGlzdCIKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgcmV0dXJuIHJi
      ZF9tZXRhZGF0YV9lY19wb29sX25hbWUKCiAgICBkZWYgZHJ5X3J1bihzZWxmLCBtc2cpOgogICAg
      ICAgIGlmIHNlbGYuX2FyZ19wYXJzZXIuZHJ5X3J1bjoKICAgICAgICAgICAgcHJpbnQoIkV4ZWN1
      dGU6ICIgKyAiJyIgKyBtc2cgKyAiJyIpCgogICAgZGVmIHZhbGlkYXRlX3Jnd19lbmRwb2ludF90
      bHNfY2VydChzZWxmKToKICAgICAgICBpZiBzZWxmLl9hcmdfcGFyc2VyLnJnd190bHNfY2VydF9w
      YXRoOgogICAgICAgICAgICB3aXRoIG9wZW4oc2VsZi5fYXJnX3BhcnNlci5yZ3dfdGxzX2NlcnRf
      cGF0aCwgZW5jb2Rpbmc9InV0ZjgiKSBhcyBmOgogICAgICAgICAgICAgICAgY29udGVudHMgPSBm
      LnJlYWQoKQogICAgICAgICAgICAgICAgcmV0dXJuIGNvbnRlbnRzLnJzdHJpcCgpCgogICAgZGVm
      IF9jaGVja19jb25mbGljdGluZ19vcHRpb25zKHNlbGYpOgogICAgICAgIGlmIG5vdCBzZWxmLl9h
      cmdfcGFyc2VyLnVwZ3JhZGUgYW5kIG5vdCBzZWxmLl9hcmdfcGFyc2VyLnJiZF9kYXRhX3Bvb2xf
      bmFtZToKICAgICAgICAgICAgcmFpc2UgRXhlY3V0aW9uRmFpbHVyZUV4Y2VwdGlvbigKICAgICAg
      ICAgICAgICAgICJFaXRoZXIgJy0tdXBncmFkZScgb3IgJy0tcmJkLWRhdGEtcG9vbC1uYW1lIDxw
      b29sX25hbWU+JyBzaG91bGQgYmUgc3BlY2lmaWVkIgogICAgICAgICAgICApCgogICAgZGVmIF9p
      bnZhbGlkX2VuZHBvaW50KHNlbGYsIGVuZHBvaW50X3N0cik6CiAgICAgICAgdHJ5OgogICAgICAg
      ICAgICBpcHY0LCBwb3J0ID0gZW5kcG9pbnRfc3RyLnNwbGl0KCI6IikKICAgICAgICBleGNlcHQg
      VmFsdWVFcnJvcjoKICAgICAgICAgICAgcmFpc2UgRXhlY3V0aW9uRmFpbHVyZUV4Y2VwdGlvbigK
      ICAgICAgICAgICAgICAgIGYiTm90IGEgcHJvcGVyIGVuZHBvaW50OiB7ZW5kcG9pbnRfc3RyfSwg
      PElQdjQ+OjxQT1JUPiwgZm9ybWF0IGlzIGV4cGVjdGVkIgogICAgICAgICAgICApCiAgICAgICAg
      aXBQYXJ0cyA9IGlwdjQuc3BsaXQoIi4iKQogICAgICAgIGlmIGxlbihpcFBhcnRzKSAhPSA0Ogog
      ICAgICAgICAgICByYWlzZSBFeGVjdXRpb25GYWlsdXJlRXhjZXB0aW9uKGYiTm90IGEgdmFsaWQg
      SVAgYWRkcmVzczoge2lwdjR9IikKICAgICAgICBmb3IgZWFjaFBhcnQgaW4gaXBQYXJ0czoKICAg
      ICAgICAgICAgaWYgbm90IGVhY2hQYXJ0LmlzZGlnaXQoKToKICAgICAgICAgICAgICAgIHJhaXNl
      IEV4ZWN1dGlvbkZhaWx1cmVFeGNlcHRpb24oCiAgICAgICAgICAgICAgICAgICAgZiJJUCBhZGRy
      ZXNzIHBhcnRzIHNob3VsZCBiZSBudW1iZXJzOiB7aXB2NH0iCiAgICAgICAgICAgICAgICApCiAg
      ICAgICAgICAgIGludFBhcnQgPSBpbnQoZWFjaFBhcnQpCiAgICAgICAgICAgIGlmIGludFBhcnQg
      PCAwIG9yIGludFBhcnQgPiAyNTQ6CiAgICAgICAgICAgICAgICByYWlzZSBFeGVjdXRpb25GYWls
      dXJlRXhjZXB0aW9uKGYiT3V0IG9mIHJhbmdlIElQIGFkZHJlc3Nlczoge2lwdjR9IikKICAgICAg
      ICBpZiBub3QgcG9ydC5pc2RpZ2l0KCk6CiAgICAgICAgICAgIHJhaXNlIEV4ZWN1dGlvbkZhaWx1
      cmVFeGNlcHRpb24oZiJQb3J0IG5vdCB2YWxpZDoge3BvcnR9IikKICAgICAgICBpbnRQb3J0ID0g
      aW50KHBvcnQpCiAgICAgICAgaWYgaW50UG9ydCA8IDEgb3IgaW50UG9ydCA+IDIqKjE2IC0gMToK
      ICAgICAgICAgICAgcmFpc2UgRXhlY3V0aW9uRmFpbHVyZUV4Y2VwdGlvbihmIk91dCBvZiByYW5n
      ZSBwb3J0IG51bWJlcjoge3BvcnR9IikKICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBkZWYgZW5k
      cG9pbnRfZGlhbChzZWxmLCBlbmRwb2ludF9zdHIsIHRpbWVvdXQ9MywgY2VydD1Ob25lKToKICAg
      ICAgICAjIGlmIHRoZSAnY2x1c3RlcicgaW5zdGFuY2UgaXMgYSBkdW1teSBvbmUsCiAgICAgICAg
      IyBkb24ndCB0cnkgdG8gcmVhY2ggb3V0IHRvIHRoZSBlbmRwb2ludAogICAgICAgIGlmIGlzaW5z
      dGFuY2Uoc2VsZi5jbHVzdGVyLCBEdW1teVJhZG9zKToKICAgICAgICAgICAgcmV0dXJuICIiLCAi
      IiwgIiIKICAgICAgICBwcm90b2NvbHMgPSBbImh0dHAiLCAiaHR0cHMiXQogICAgICAgIHJlc3Bv
      bnNlX2Vycm9yID0gTm9uZQogICAgICAgIGZvciBwcmVmaXggaW4gcHJvdG9jb2xzOgogICAgICAg
      ICAgICB0cnk6CiAgICAgICAgICAgICAgICBlcCA9IGYie3ByZWZpeH06Ly97ZW5kcG9pbnRfc3Ry
      fSIKICAgICAgICAgICAgICAgIHZlcmlmeSA9IE5vbmUKICAgICAgICAgICAgICAgICMgSWYgdmVy
      aWZ5IGlzIHNldCB0byBhIHBhdGggdG8gYSBkaXJlY3RvcnksCiAgICAgICAgICAgICAgICAjIHRo
      ZSBkaXJlY3RvcnkgbXVzdCBoYXZlIGJlZW4gcHJvY2Vzc2VkIHVzaW5nIHRoZSBjX3JlaGFzaCB1
      dGlsaXR5IHN1cHBsaWVkIHdpdGggT3BlblNTTC4KICAgICAgICAgICAgICAgIGlmIHByZWZpeCA9
      PSAiaHR0cHMiIGFuZCBzZWxmLl9hcmdfcGFyc2VyLnJnd19za2lwX3RsczoKICAgICAgICAgICAg
      ICAgICAgICB2ZXJpZnkgPSBGYWxzZQogICAgICAgICAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5o
      ZWFkKGVwLCB0aW1lb3V0PXRpbWVvdXQsIHZlcmlmeT1GYWxzZSkKICAgICAgICAgICAgICAgIGVs
      aWYgcHJlZml4ID09ICJodHRwcyIgYW5kIGNlcnQ6CiAgICAgICAgICAgICAgICAgICAgdmVyaWZ5
      ID0gY2VydAogICAgICAgICAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5oZWFkKGVwLCB0aW1lb3V0
      PXRpbWVvdXQsIHZlcmlmeT1jZXJ0KQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAg
      ICAgICAgICByID0gcmVxdWVzdHMuaGVhZChlcCwgdGltZW91dD10aW1lb3V0KQogICAgICAgICAg
      ICAgICAgaWYgci5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJu
      IHByZWZpeCwgdmVyaWZ5LCAiIgogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGVycjoK
      ICAgICAgICAgICAgICAgIHJlc3BvbnNlX2Vycm9yID0gZXJyCiAgICAgICAgICAgICAgICBjb250
      aW51ZQogICAgICAgIHN5cy5zdGRlcnIud3JpdGUoCiAgICAgICAgICAgIGYidW5hYmxlIHRvIGNv
      bm5lY3QgdG8gZW5kcG9pbnQ6IHtlbmRwb2ludF9zdHJ9LCBmYWlsZWQgZXJyb3I6IHtyZXNwb25z
      ZV9lcnJvcn0iCiAgICAgICAgKQogICAgICAgIHJldHVybiAoCiAgICAgICAgICAgICIiLAogICAg
      ICAgICAgICAiIiwKICAgICAgICAgICAgKCItMSIpLAogICAgICAgICkKCiAgICBkZWYgX19pbml0
      X18oc2VsZiwgYXJnX2xpc3Q9Tm9uZSk6CiAgICAgICAgc2VsZi5vdXRfbWFwID0ge30KICAgICAg
      ICBzZWxmLl9leGNsdWRlZF9rZXlzID0gc2V0KCkKICAgICAgICBzZWxmLl9hcmdfcGFyc2VyID0g
      c2VsZi5nZW5fYXJnX3BhcnNlcihhcmdzX3RvX3BhcnNlPWFyZ19saXN0KQogICAgICAgIHNlbGYu
      X2NoZWNrX2NvbmZsaWN0aW5nX29wdGlvbnMoKQogICAgICAgIHNlbGYucnVuX2FzX3VzZXIgPSBz
      ZWxmLl9hcmdfcGFyc2VyLnJ1bl9hc191c2VyCiAgICAgICAgc2VsZi5vdXRwdXRfZmlsZSA9IHNl
      bGYuX2FyZ19wYXJzZXIub3V0cHV0CiAgICAgICAgc2VsZi5jZXBoX2NvbmYgPSBzZWxmLl9hcmdf
      cGFyc2VyLmNlcGhfY29uZgogICAgICAgIHNlbGYuTUlOX1VTRVJfQ0FQX1BFUk1JU1NJT05TID0g
      ewogICAgICAgICAgICAibWdyIjogImFsbG93IGNvbW1hbmQgY29uZmlnIiwKICAgICAgICAgICAg
      Im1vbiI6ICJhbGxvdyByLCBhbGxvdyBjb21tYW5kIHF1b3J1bV9zdGF0dXMsIGFsbG93IGNvbW1h
      bmQgdmVyc2lvbiIsCiAgICAgICAgICAgICJvc2QiOiAiYWxsb3cgcnd4IHBvb2w9ezB9LnJndy5t
      ZXRhLCAiCiAgICAgICAgICAgICsgImFsbG93IHIgcG9vbD0ucmd3LnJvb3QsICIKICAgICAgICAg
      ICAgKyAiYWxsb3cgcncgcG9vbD17MH0ucmd3LmNvbnRyb2wsICIKICAgICAgICAgICAgKyAiYWxs
      b3cgcnggcG9vbD17MH0ucmd3LmxvZywgIgogICAgICAgICAgICArICJhbGxvdyB4IHBvb2w9ezB9
      LnJndy5idWNrZXRzLmluZGV4IiwKICAgICAgICB9CiAgICAgICAgIyBpZiB1c2VyIG5vdCBwcm92
      aWRlZCwgZ2l2ZSBhIGRlZmF1bHQgdXNlcgogICAgICAgIGlmIG5vdCBzZWxmLnJ1bl9hc191c2Vy
      IGFuZCBub3Qgc2VsZi5fYXJnX3BhcnNlci51cGdyYWRlOgogICAgICAgICAgICBzZWxmLnJ1bl9h
      c191c2VyID0gc2VsZi5FWFRFUk5BTF9VU0VSX05BTUUKICAgICAgICBpZiBub3Qgc2VsZi5fYXJn
      X3BhcnNlci5yZ3dfcG9vbF9wcmVmaXggYW5kIG5vdCBzZWxmLl9hcmdfcGFyc2VyLnVwZ3JhZGU6
      CiAgICAgICAgICAgIHNlbGYuX2FyZ19wYXJzZXIucmd3X3Bvb2xfcHJlZml4ID0gc2VsZi5ERUZB
      VUxUX1JHV19QT09MX1BSRUZJWAogICAgICAgIGlmIHNlbGYuY2VwaF9jb25mOgogICAgICAgICAg
      ICBzZWxmLmNsdXN0ZXIgPSByYWRvcy5SYWRvcyhjb25mZmlsZT1zZWxmLmNlcGhfY29uZikKICAg
      ICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmNsdXN0ZXIgPSByYWRvcy5SYWRvcygpCiAgICAg
      ICAgICAgIHNlbGYuY2x1c3Rlci5jb25mX3JlYWRfZmlsZSgpCiAgICAgICAgc2VsZi5jbHVzdGVy
      LmNvbm5lY3QoKQoKICAgIGRlZiBzaHV0ZG93bihzZWxmKToKICAgICAgICBpZiBzZWxmLmNsdXN0
      ZXIuc3RhdGUgPT0gImNvbm5lY3RlZCI6CiAgICAgICAgICAgIHNlbGYuY2x1c3Rlci5zaHV0ZG93
      bigpCgogICAgZGVmIGdldF9mc2lkKHNlbGYpOgogICAgICAgIGlmIHNlbGYuX2FyZ19wYXJzZXIu
      ZHJ5X3J1bjoKICAgICAgICAgICAgcmV0dXJuIHNlbGYuZHJ5X3J1bigiY2VwaCBmc2lkIikKICAg
      ICAgICByZXR1cm4gc3RyKHNlbGYuY2x1c3Rlci5nZXRfZnNpZCgpKQoKICAgIGRlZiBfY29tbW9u
      X2NtZF9qc29uX2dlbihzZWxmLCBjbWRfanNvbik6CiAgICAgICAgY21kID0ganNvbi5kdW1wcyhj
      bWRfanNvbiwgc29ydF9rZXlzPVRydWUpCiAgICAgICAgcmV0X3ZhbCwgY21kX291dCwgZXJyX21z
      ZyA9IHNlbGYuY2x1c3Rlci5tb25fY29tbWFuZChjbWQsIGIiIikKICAgICAgICBpZiBzZWxmLl9h
      cmdfcGFyc2VyLnZlcmJvc2U6CiAgICAgICAgICAgIHByaW50KGYiQ29tbWFuZCBJbnB1dDoge2Nt
      ZH0iKQogICAgICAgICAgICBwcmludCgKICAgICAgICAgICAgICAgIGYiUmV0dXJuIFZhbDoge3Jl
      dF92YWx9XG5Db21tYW5kIE91dHB1dDoge2NtZF9vdXR9XG4iCiAgICAgICAgICAgICAgICBmIkVy
      cm9yIE1lc3NhZ2U6IHtlcnJfbXNnfVxuLS0tLS0tLS0tLVxuIgogICAgICAgICAgICApCiAgICAg
      ICAganNvbl9vdXQgPSB7fQogICAgICAgICMgaWYgdGhlcmUgaXMgbm8gZXJyb3IgKGkuZTsgcmV0
      X3ZhbCBpcyBaRVJPKSBhbmQgJ2NtZF9vdXQnIGlzIG5vdCBlbXB0eQogICAgICAgICMgdGhlbiBj
      b252ZXJ0ICdjbWRfb3V0JyB0byBhIGpzb24gb3V0cHV0CiAgICAgICAgaWYgcmV0X3ZhbCA9PSAw
      IGFuZCBjbWRfb3V0OgogICAgICAgICAgICBqc29uX291dCA9IGpzb24ubG9hZHMoY21kX291dCkK
      ICAgICAgICByZXR1cm4gcmV0X3ZhbCwganNvbl9vdXQsIGVycl9tc2cKCiAgICBkZWYgZ2V0X2Nl
      cGhfZXh0ZXJuYWxfbW9uX2RhdGEoc2VsZik6CiAgICAgICAgY21kX2pzb24gPSB7InByZWZpeCI6
      ICJxdW9ydW1fc3RhdHVzIiwgImZvcm1hdCI6ICJqc29uIn0KICAgICAgICBpZiBzZWxmLl9hcmdf
      cGFyc2VyLmRyeV9ydW46CiAgICAgICAgICAgIHJldHVybiBzZWxmLmRyeV9ydW4oImNlcGggIiAr
      IGNtZF9qc29uWyJwcmVmaXgiXSkKICAgICAgICByZXRfdmFsLCBqc29uX291dCwgZXJyX21zZyA9
      IHNlbGYuX2NvbW1vbl9jbWRfanNvbl9nZW4oY21kX2pzb24pCiAgICAgICAgIyBpZiB0aGVyZSBp
      cyBhbiB1bnN1Y2Nlc3NmdWwgYXR0ZW1wdCwKICAgICAgICBpZiByZXRfdmFsICE9IDAgb3IgbGVu
      KGpzb25fb3V0KSA9PSAwOgogICAgICAgICAgICByYWlzZSBFeGVjdXRpb25GYWlsdXJlRXhjZXB0
      aW9uKAogICAgICAgICAgICAgICAgIidxdW9ydW1fc3RhdHVzJyBjb21tYW5kIGZhaWxlZC5cbiIK
      ICAgICAgICAgICAgICAgIGYiRXJyb3I6IHtlcnJfbXNnIGlmIHJldF92YWwgIT0gMCBlbHNlIHNl
      bGYuRU1QVFlfT1VUUFVUX0xJU1R9IgogICAgICAgICAgICApCiAgICAgICAgcV9sZWFkZXJfbmFt
      ZSA9IGpzb25fb3V0WyJxdW9ydW1fbGVhZGVyX25hbWUiXQogICAgICAgIHFfbGVhZGVyX2RldGFp
      bHMgPSB7fQogICAgICAgIHFfbGVhZGVyX21hdGNoaW5nX2xpc3QgPSBbCiAgICAgICAgICAgIGwg
      Zm9yIGwgaW4ganNvbl9vdXRbIm1vbm1hcCJdWyJtb25zIl0gaWYgbFsibmFtZSJdID09IHFfbGVh
      ZGVyX25hbWUKICAgICAgICBdCiAgICAgICAgaWYgbGVuKHFfbGVhZGVyX21hdGNoaW5nX2xpc3Qp
      ID09IDA6CiAgICAgICAgICAgIHJhaXNlIEV4ZWN1dGlvbkZhaWx1cmVFeGNlcHRpb24oIk5vIG1h
      dGNoaW5nICdtb24nIGRldGFpbHMgZm91bmQiKQogICAgICAgIHFfbGVhZGVyX2RldGFpbHMgPSBx
      X2xlYWRlcl9tYXRjaGluZ19saXN0WzBdCiAgICAgICAgIyBnZXQgdGhlIGFkZHJlc3MgdmVjdG9y
      IG9mIHRoZSBxdW9ydW0tbGVhZGVyCiAgICAgICAgcV9sZWFkZXJfYWRkcnZlYyA9IHFfbGVhZGVy
      X2RldGFpbHMuZ2V0KCJwdWJsaWNfYWRkcnMiLCB7fSkuZ2V0KCJhZGRydmVjIiwgW10pCiAgICAg
      ICAgIyBpZiB0aGUgcXVvcnVtLWxlYWRlciBoYXMgb25seSBvbmUgYWRkcmVzcyBpbiB0aGUgYWRk
      cmVzcy12ZWN0b3IKICAgICAgICAjIGFuZCBpdCBpcyBvZiB0eXBlICd2MicgKGllOyB3aXRoIDxJ
      UD46MzMwMCksCiAgICAgICAgIyByYWlzZSBhbiBleGNlcHRpb24gdG8gbWFrZSB1c2VyIGF3YXJl
      IHRoYXQKICAgICAgICAjIHRoZXkgaGF2ZSB0byBlbmFibGUgJ3YxJyAoaWU7IHdpdGggPElQPjo2
      Nzg5KSB0eXBlIGFzIHdlbGwKICAgICAgICBpZiBsZW4ocV9sZWFkZXJfYWRkcnZlYykgPT0gMSBh
      bmQgcV9sZWFkZXJfYWRkcnZlY1swXVsidHlwZSJdID09ICJ2MiI6CiAgICAgICAgICAgIHJhaXNl
      IEV4ZWN1dGlvbkZhaWx1cmVFeGNlcHRpb24oCiAgICAgICAgICAgICAgICAiT25seSAndjInIGFk
      ZHJlc3MgdHlwZSBpcyBlbmFibGVkLCB1c2VyIHNob3VsZCBhbHNvIGVuYWJsZSAndjEnIHR5cGUg
      YXMgd2VsbCIKICAgICAgICAgICAgKQogICAgICAgIGlwX3BvcnQgPSBzdHIocV9sZWFkZXJfZGV0
      YWlsc1sicHVibGljX2FkZHIiXS5zcGxpdCgiLyIpWzBdKQogICAgICAgIHJldHVybiBmIntzdHIo
      cV9sZWFkZXJfbmFtZSl9PXtpcF9wb3J0fSIKCiAgICBkZWYgX2pvaW5faG9zdF9wb3J0KHNlbGYs
      IGVuZHBvaW50LCBwb3J0KToKICAgICAgICBwb3J0ID0gc3RyKHBvcnQpCiAgICAgICAgIyByZWdl
      eCB0byBjaGVjayB0aGUgZ2l2ZW4gZW5kcG9pbnQgaXMgZW5jbG9zZWQgaW4gc3F1YXJlIGJyYWNr
      ZXRzCiAgICAgICAgaXB2Nl9yZWdleCA9IHJlLmNvbXBpbGUociJeXFtbXl1dKlxdJCIpCiAgICAg
      ICAgIyBlbmRwb2ludCBoYXMgJzonIGluIGl0IGFuZCBpZiBub3QgKGFscmVhZHkpIGVuY2xvc2Vk
      IGluIHNxdWFyZSBicmFja2V0cwogICAgICAgIGlmIGVuZHBvaW50LmNvdW50KCI6IikgYW5kIG5v
      dCBpcHY2X3JlZ2V4Lm1hdGNoKGVuZHBvaW50KToKICAgICAgICAgICAgZW5kcG9pbnQgPSBmIlt7
      ZW5kcG9pbnR9XSIKICAgICAgICBpZiBub3QgcG9ydDoKICAgICAgICAgICAgcmV0dXJuIGVuZHBv
      aW50CiAgICAgICAgcmV0dXJuICI6Ii5qb2luKFtlbmRwb2ludCwgcG9ydF0pCgogICAgZGVmIF9j
      b252ZXJ0X2hvc3RuYW1lX3RvX2lwKHNlbGYsIGhvc3RfbmFtZSk6CiAgICAgICAgIyBpZiAnY2x1
      c3RlcicgaW5zdGFuY2UgaXMgYSBkdW1teSB0eXBlLAogICAgICAgICMgY2FsbCB0aGUgZHVtbXkg
      aW5zdGFuY2UncyAiY29udmVydCIgbWV0aG9kCiAgICAgICAgaWYgbm90IGhvc3RfbmFtZToKICAg
      ICAgICAgICAgcmFpc2UgRXhlY3V0aW9uRmFpbHVyZUV4Y2VwdGlvbigiRW1wdHkgaG9zdG5hbWUg
      cHJvdmlkZWQiKQogICAgICAgIGlmIGlzaW5zdGFuY2Uoc2VsZi5jbHVzdGVyLCBEdW1teVJhZG9z
      KToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuY2x1c3Rlci5fY29udmVydF9ob3N0bmFtZV90b19p
      cChob3N0X25hbWUpCiAgICAgICAgaW1wb3J0IHNvY2tldAoKICAgICAgICBpcCA9IHNvY2tldC5n
      ZXRob3N0YnluYW1lKGhvc3RfbmFtZSkKICAgICAgICBkZWwgc29ja2V0CiAgICAgICAgcmV0dXJu
      IGlwCgogICAgZGVmIGdldF9hY3RpdmVfYW5kX3N0YW5kYnlfbWdycyhzZWxmKToKICAgICAgICBp
      ZiBzZWxmLl9hcmdfcGFyc2VyLmRyeV9ydW46CiAgICAgICAgICAgIHJldHVybiAiIiwgc2VsZi5k
      cnlfcnVuKCJjZXBoIHN0YXR1cyIpCiAgICAgICAgbW9uaXRvcmluZ19lbmRwb2ludF9wb3J0ID0g
      c2VsZi5fYXJnX3BhcnNlci5tb25pdG9yaW5nX2VuZHBvaW50X3BvcnQKICAgICAgICBtb25pdG9y
      aW5nX2VuZHBvaW50X2lwX2xpc3QgPSBzZWxmLl9hcmdfcGFyc2VyLm1vbml0b3JpbmdfZW5kcG9p
      bnQKICAgICAgICBzdGFuZGJ5X21ncnMgPSBbXQogICAgICAgIGlmIG5vdCBtb25pdG9yaW5nX2Vu
      ZHBvaW50X2lwX2xpc3Q6CiAgICAgICAgICAgIGNtZF9qc29uID0geyJwcmVmaXgiOiAic3RhdHVz
      IiwgImZvcm1hdCI6ICJqc29uIn0KICAgICAgICAgICAgcmV0X3ZhbCwganNvbl9vdXQsIGVycl9t
      c2cgPSBzZWxmLl9jb21tb25fY21kX2pzb25fZ2VuKGNtZF9qc29uKQogICAgICAgICAgICAjIGlm
      IHRoZXJlIGlzIGFuIHVuc3VjY2Vzc2Z1bCBhdHRlbXB0LAogICAgICAgICAgICBpZiByZXRfdmFs
      ICE9IDAgb3IgbGVuKGpzb25fb3V0KSA9PSAwOgogICAgICAgICAgICAgICAgcmFpc2UgRXhlY3V0
      aW9uRmFpbHVyZUV4Y2VwdGlvbigKICAgICAgICAgICAgICAgICAgICAiJ21nciBzZXJ2aWNlcycg
      Y29tbWFuZCBmYWlsZWQuXG4iCiAgICAgICAgICAgICAgICAgICAgZiJFcnJvcjoge2Vycl9tc2cg
      aWYgcmV0X3ZhbCAhPSAwIGVsc2Ugc2VsZi5FTVBUWV9PVVRQVVRfTElTVH0iCiAgICAgICAgICAg
      ICAgICApCiAgICAgICAgICAgIG1vbml0b3JpbmdfZW5kcG9pbnQgPSAoCiAgICAgICAgICAgICAg
      ICBqc29uX291dC5nZXQoIm1ncm1hcCIsIHt9KS5nZXQoInNlcnZpY2VzIiwge30pLmdldCgicHJv
      bWV0aGV1cyIsICIiKQogICAgICAgICAgICApCiAgICAgICAgICAgIGlmIG5vdCBtb25pdG9yaW5n
      X2VuZHBvaW50OgogICAgICAgICAgICAgICAgcmFpc2UgRXhlY3V0aW9uRmFpbHVyZUV4Y2VwdGlv
      bigKICAgICAgICAgICAgICAgICAgICAiJ3Byb21ldGhldXMnIHNlcnZpY2Ugbm90IGZvdW5kLCBp
      cyB0aGUgZXhwb3J0ZXIgZW5hYmxlZD8uXG4iCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAg
      ICMgbm93IGNoZWNrIHRoZSBzdGFuZC1ieSBtZ3ItcwogICAgICAgICAgICBzdGFuZGJ5X2FyciA9
      IGpzb25fb3V0LmdldCgibWdybWFwIiwge30pLmdldCgic3RhbmRieXMiLCBbXSkKICAgICAgICAg
      ICAgZm9yIGVhY2hfc3RhbmRieSBpbiBzdGFuZGJ5X2FycjoKICAgICAgICAgICAgICAgIGlmICJu
      YW1lIiBpbiBlYWNoX3N0YW5kYnkua2V5cygpOgogICAgICAgICAgICAgICAgICAgIHN0YW5kYnlf
      bWdycy5hcHBlbmQoZWFjaF9zdGFuZGJ5WyJuYW1lIl0pCiAgICAgICAgICAgIHRyeToKICAgICAg
      ICAgICAgICAgIHBhcnNlZF9lbmRwb2ludCA9IHVybHBhcnNlKG1vbml0b3JpbmdfZW5kcG9pbnQp
      CiAgICAgICAgICAgIGV4Y2VwdCBWYWx1ZUVycm9yOgogICAgICAgICAgICAgICAgcmFpc2UgRXhl
      Y3V0aW9uRmFpbHVyZUV4Y2VwdGlvbigKICAgICAgICAgICAgICAgICAgICBmImludmFsaWQgZW5k
      cG9pbnQ6IHttb25pdG9yaW5nX2VuZHBvaW50fSIKICAgICAgICAgICAgICAgICkKICAgICAgICAg
      ICAgbW9uaXRvcmluZ19lbmRwb2ludF9pcF9saXN0ID0gcGFyc2VkX2VuZHBvaW50Lmhvc3RuYW1l
      CiAgICAgICAgICAgIGlmIG5vdCBtb25pdG9yaW5nX2VuZHBvaW50X3BvcnQ6CiAgICAgICAgICAg
      ICAgICBtb25pdG9yaW5nX2VuZHBvaW50X3BvcnQgPSBzdHIocGFyc2VkX2VuZHBvaW50LnBvcnQp
      CgogICAgICAgICMgaWYgbW9uaXRvcmluZyBlbmRwb2ludCBwb3J0IGlzIG5vdCBzZXQsIHB1dCBh
      IGRlZmF1bHQgbW9uIHBvcnQKICAgICAgICBpZiBub3QgbW9uaXRvcmluZ19lbmRwb2ludF9wb3J0
      OgogICAgICAgICAgICBtb25pdG9yaW5nX2VuZHBvaW50X3BvcnQgPSBzZWxmLkRFRkFVTFRfTU9O
      SVRPUklOR19FTkRQT0lOVF9QT1JUCgogICAgICAgICMgdXNlciBjb3VsZCBnaXZlIGNvbW1hIGFu
      ZCBzcGFjZSBzZXBhcmF0ZWQgaW5wdXRzIChsaWtlIC0tbW9uaXRvcmluZy1lbmRwb2ludD0iPGlw
      MT4sIDxpcDI+IikKICAgICAgICBtb25pdG9yaW5nX2VuZHBvaW50X2lwX2xpc3QgPSBtb25pdG9y
      aW5nX2VuZHBvaW50X2lwX2xpc3QucmVwbGFjZSgiLCIsICIgIikKICAgICAgICBtb25pdG9yaW5n
      X2VuZHBvaW50X2lwX2xpc3Rfc3BsaXQgPSBtb25pdG9yaW5nX2VuZHBvaW50X2lwX2xpc3Quc3Bs
      aXQoKQogICAgICAgICMgaWYgbW9uaXRvcmluZy1lbmRwb2ludCBjb3VsZCBub3QgYmUgZm91bmQs
      IHJhaXNlIGFuIGVycm9yCiAgICAgICAgaWYgbGVuKG1vbml0b3JpbmdfZW5kcG9pbnRfaXBfbGlz
      dF9zcGxpdCkgPT0gMDoKICAgICAgICAgICAgcmFpc2UgRXhlY3V0aW9uRmFpbHVyZUV4Y2VwdGlv
      bigiTm8gJ21vbml0b3JpbmctZW5kcG9pbnQnIGZvdW5kIikKICAgICAgICAjIGZpcnN0IGlwIGlz
      IHRyZWF0ZWQgYXMgdGhlIG1haW4gbW9uaXRvcmluZy1lbmRwb2ludAogICAgICAgIG1vbml0b3Jp
      bmdfZW5kcG9pbnRfaXAgPSBtb25pdG9yaW5nX2VuZHBvaW50X2lwX2xpc3Rfc3BsaXRbMF0KICAg
      ICAgICAjIHJlc3Qgb2YgdGhlIGlwLXMgYXJlIGFkZGVkIHRvIHRoZSAnc3RhbmRieV9tZ3JzJyBs
      aXN0CiAgICAgICAgc3RhbmRieV9tZ3JzLmV4dGVuZChtb25pdG9yaW5nX2VuZHBvaW50X2lwX2xp
      c3Rfc3BsaXRbMTpdKQogICAgICAgIGZhaWxlZF9pcCA9IG1vbml0b3JpbmdfZW5kcG9pbnRfaXAK
      CiAgICAgICAgdHJ5OgogICAgICAgICAgICBtb25pdG9yaW5nX2VuZHBvaW50X2lwID0gc2VsZi5f
      Y29udmVydF9ob3N0bmFtZV90b19pcCgKICAgICAgICAgICAgICAgIG1vbml0b3JpbmdfZW5kcG9p
      bnRfaXAKICAgICAgICAgICAgKQogICAgICAgICAgICAjIGNvbGxlY3QgYWxsIHRoZSAnc3RhbmQt
      YnknIG1nciBpcHMKICAgICAgICAgICAgbWdyX2lwcyA9IFtdCiAgICAgICAgICAgIGZvciBlYWNo
      X3N0YW5kYnlfbWdyIGluIHN0YW5kYnlfbWdyczoKICAgICAgICAgICAgICAgIGZhaWxlZF9pcCA9
      IGVhY2hfc3RhbmRieV9tZ3IKICAgICAgICAgICAgICAgIG1ncl9pcHMuYXBwZW5kKHNlbGYuX2Nv
      bnZlcnRfaG9zdG5hbWVfdG9faXAoZWFjaF9zdGFuZGJ5X21ncikpCiAgICAgICAgZXhjZXB0Ogog
      ICAgICAgICAgICByYWlzZSBFeGVjdXRpb25GYWlsdXJlRXhjZXB0aW9uKAogICAgICAgICAgICAg
      ICAgZiJDb252ZXJzaW9uIG9mIGhvc3Q6IHtmYWlsZWRfaXB9IHRvIElQIGZhaWxlZC4gIgogICAg
      ICAgICAgICAgICAgIlBsZWFzZSBlbnRlciB0aGUgSVAgYWRkcmVzc2VzIG9mIGFsbCB0aGUgY2Vw
      aC1tZ3JzIHdpdGggdGhlICctLW1vbml0b3JpbmctZW5kcG9pbnQnIGZsYWciCiAgICAgICAgICAg
      ICkKICAgICAgICBtb25pdG9yaW5nX2VuZHBvaW50ID0gc2VsZi5fam9pbl9ob3N0X3BvcnQoCiAg
      ICAgICAgICAgIG1vbml0b3JpbmdfZW5kcG9pbnRfaXAsIG1vbml0b3JpbmdfZW5kcG9pbnRfcG9y
      dAogICAgICAgICkKICAgICAgICBzZWxmLl9pbnZhbGlkX2VuZHBvaW50KG1vbml0b3JpbmdfZW5k
      cG9pbnQpCiAgICAgICAgXywgXywgZXJyID0gc2VsZi5lbmRwb2ludF9kaWFsKG1vbml0b3Jpbmdf
      ZW5kcG9pbnQpCiAgICAgICAgaWYgZXJyID09ICItMSI6CiAgICAgICAgICAgIHJhaXNlIEV4ZWN1
      dGlvbkZhaWx1cmVFeGNlcHRpb24oZXJyKQogICAgICAgICMgYWRkIHRoZSB2YWxpZGF0ZWQgYWN0
      aXZlIG1nciBJUCBpbnRvIHRoZSBmaXJzdCBpbmRleAogICAgICAgIG1ncl9pcHMuaW5zZXJ0KDAs
      IG1vbml0b3JpbmdfZW5kcG9pbnRfaXApCiAgICAgICAgYWxsX21ncl9pcHNfc3RyID0gIiwiLmpv
      aW4obWdyX2lwcykKICAgICAgICByZXR1cm4gYWxsX21ncl9pcHNfc3RyLCBtb25pdG9yaW5nX2Vu
      ZHBvaW50X3BvcnQKCiAgICBkZWYgY2hlY2tfdXNlcl9leGlzdChzZWxmLCB1c2VyKToKICAgICAg
      ICBjbWRfanNvbiA9IHsicHJlZml4IjogImF1dGggZ2V0IiwgImVudGl0eSI6IGYie3VzZXJ9Iiwg
      ImZvcm1hdCI6ICJqc29uIn0KICAgICAgICByZXRfdmFsLCBqc29uX291dCwgXyA9IHNlbGYuX2Nv
      bW1vbl9jbWRfanNvbl9nZW4oY21kX2pzb24pCiAgICAgICAgaWYgcmV0X3ZhbCAhPSAwIG9yIGxl
      bihqc29uX291dCkgPT0gMDoKICAgICAgICAgICAgcmV0dXJuICIiCiAgICAgICAgcmV0dXJuIHN0
      cihqc29uX291dFswXVsia2V5Il0pCgogICAgZGVmIGdldF9jZXBoZnNfcHJvdmlzaW9uZXJfY2Fw
      c19hbmRfZW50aXR5KHNlbGYpOgogICAgICAgIGVudGl0eSA9ICJjbGllbnQuY3NpLWNlcGhmcy1w
      cm92aXNpb25lciIKICAgICAgICBjYXBzID0gewogICAgICAgICAgICAibW9uIjogImFsbG93IHIs
      IGFsbG93IGNvbW1hbmQgJ29zZCBibG9ja2xpc3QnIiwKICAgICAgICAgICAgIm1nciI6ICJhbGxv
      dyBydyIsCiAgICAgICAgICAgICJvc2QiOiAiYWxsb3cgcncgdGFnIGNlcGhmcyBtZXRhZGF0YT0q
      IiwKICAgICAgICB9CiAgICAgICAgaWYgc2VsZi5fYXJnX3BhcnNlci5yZXN0cmljdGVkX2F1dGhf
      cGVybWlzc2lvbjoKICAgICAgICAgICAgY2x1c3Rlcl9uYW1lID0gc2VsZi5fYXJnX3BhcnNlci5j
      bHVzdGVyX25hbWUKICAgICAgICAgICAgaWYgY2x1c3Rlcl9uYW1lID09ICIiOgogICAgICAgICAg
      ICAgICAgcmFpc2UgRXhlY3V0aW9uRmFpbHVyZUV4Y2VwdGlvbigKICAgICAgICAgICAgICAgICAg
      ICAiY2x1c3Rlcl9uYW1lIG5vdCBmb3VuZCwgcGxlYXNlIHNldCB0aGUgJy0tY2x1c3Rlci1uYW1l
      JyBmbGFnIgogICAgICAgICAgICAgICAgKQogICAgICAgICAgICBjZXBoZnNfZmlsZXN5c3RlbSA9
      IHNlbGYuX2FyZ19wYXJzZXIuY2VwaGZzX2ZpbGVzeXN0ZW1fbmFtZQogICAgICAgICAgICBpZiBj
      ZXBoZnNfZmlsZXN5c3RlbSA9PSAiIjoKICAgICAgICAgICAgICAgIGVudGl0eSA9IGYie2VudGl0
      eX0te2NsdXN0ZXJfbmFtZX0iCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBlbnRp
      dHkgPSBmIntlbnRpdHl9LXtjbHVzdGVyX25hbWV9LXtjZXBoZnNfZmlsZXN5c3RlbX0iCiAgICAg
      ICAgICAgICAgICBjYXBzWyJvc2QiXSA9IGYiYWxsb3cgcncgdGFnIGNlcGhmcyBtZXRhZGF0YT17
      Y2VwaGZzX2ZpbGVzeXN0ZW19IgoKICAgICAgICByZXR1cm4gY2FwcywgZW50aXR5CgogICAgZGVm
      IGdldF9jZXBoZnNfbm9kZV9jYXBzX2FuZF9lbnRpdHkoc2VsZik6CiAgICAgICAgZW50aXR5ID0g
      ImNsaWVudC5jc2ktY2VwaGZzLW5vZGUiCiAgICAgICAgY2FwcyA9IHsKICAgICAgICAgICAgIm1v
      biI6ICJhbGxvdyByLCBhbGxvdyBjb21tYW5kICdvc2QgYmxvY2tsaXN0JyIsCiAgICAgICAgICAg
      ICJtZ3IiOiAiYWxsb3cgcnciLAogICAgICAgICAgICAib3NkIjogImFsbG93IHJ3IHRhZyBjZXBo
      ZnMgKj0qIiwKICAgICAgICAgICAgIm1kcyI6ICJhbGxvdyBydyIsCiAgICAgICAgfQogICAgICAg
      IGlmIHNlbGYuX2FyZ19wYXJzZXIucmVzdHJpY3RlZF9hdXRoX3Blcm1pc3Npb246CiAgICAgICAg
      ICAgIGNsdXN0ZXJfbmFtZSA9IHNlbGYuX2FyZ19wYXJzZXIuY2x1c3Rlcl9uYW1lCiAgICAgICAg
      ICAgIGlmIGNsdXN0ZXJfbmFtZSA9PSAiIjoKICAgICAgICAgICAgICAgIHJhaXNlIEV4ZWN1dGlv
      bkZhaWx1cmVFeGNlcHRpb24oCiAgICAgICAgICAgICAgICAgICAgImNsdXN0ZXJfbmFtZSBub3Qg
      Zm91bmQsIHBsZWFzZSBzZXQgdGhlICctLWNsdXN0ZXItbmFtZScgZmxhZyIKICAgICAgICAgICAg
      ICAgICkKICAgICAgICAgICAgY2VwaGZzX2ZpbGVzeXN0ZW0gPSBzZWxmLl9hcmdfcGFyc2VyLmNl
      cGhmc19maWxlc3lzdGVtX25hbWUKICAgICAgICAgICAgaWYgY2VwaGZzX2ZpbGVzeXN0ZW0gPT0g
      IiI6CiAgICAgICAgICAgICAgICBlbnRpdHkgPSBmIntlbnRpdHl9LXtjbHVzdGVyX25hbWV9Igog
      ICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgZW50aXR5ID0gZiJ7ZW50aXR5fS17Y2x1
      c3Rlcl9uYW1lfS17Y2VwaGZzX2ZpbGVzeXN0ZW19IgogICAgICAgICAgICAgICAgY2Fwc1sib3Nk
      Il0gPSBmImFsbG93IHJ3IHRhZyBjZXBoZnMgKj17Y2VwaGZzX2ZpbGVzeXN0ZW19IgoKICAgICAg
      ICByZXR1cm4gY2FwcywgZW50aXR5CgogICAgZGVmIGdldF9yYmRfcHJvdmlzaW9uZXJfY2Fwc19h
      bmRfZW50aXR5KHNlbGYpOgogICAgICAgIGVudGl0eSA9ICJjbGllbnQuY3NpLXJiZC1wcm92aXNp
      b25lciIKICAgICAgICBjYXBzID0gewogICAgICAgICAgICAibW9uIjogInByb2ZpbGUgcmJkLCBh
      bGxvdyBjb21tYW5kICdvc2QgYmxvY2tsaXN0JyIsCiAgICAgICAgICAgICJtZ3IiOiAiYWxsb3cg
      cnciLAogICAgICAgICAgICAib3NkIjogInByb2ZpbGUgcmJkIiwKICAgICAgICB9CiAgICAgICAg
      aWYgc2VsZi5fYXJnX3BhcnNlci5yZXN0cmljdGVkX2F1dGhfcGVybWlzc2lvbjoKICAgICAgICAg
      ICAgcmJkX3Bvb2xfbmFtZSA9IHNlbGYuX2FyZ19wYXJzZXIucmJkX2RhdGFfcG9vbF9uYW1lCiAg
      ICAgICAgICAgIGNsdXN0ZXJfbmFtZSA9IHNlbGYuX2FyZ19wYXJzZXIuY2x1c3Rlcl9uYW1lCiAg
      ICAgICAgICAgIGlmIHJiZF9wb29sX25hbWUgPT0gIiIgb3IgY2x1c3Rlcl9uYW1lID09ICIiOgog
      ICAgICAgICAgICAgICAgcmFpc2UgRXhlY3V0aW9uRmFpbHVyZUV4Y2VwdGlvbigKICAgICAgICAg
      ICAgICAgICAgICAibWFuZGF0b3J5IGZsYWdzIG5vdCBmb3VuZCwgcGxlYXNlIHNldCB0aGUgJy0t
      cmJkLWRhdGEtcG9vbC1uYW1lJywgJy0tY2x1c3Rlci1uYW1lJyBmbGFncyIKICAgICAgICAgICAg
      ICAgICkKICAgICAgICAgICAgZW50aXR5ID0gZiJ7ZW50aXR5fS17Y2x1c3Rlcl9uYW1lfS17cmJk
      X3Bvb2xfbmFtZX0iCiAgICAgICAgICAgIGNhcHNbIm9zZCJdID0gZiJwcm9maWxlIHJiZCBwb29s
      PXtyYmRfcG9vbF9uYW1lfSIKCiAgICAgICAgcmV0dXJuIGNhcHMsIGVudGl0eQoKICAgIGRlZiBn
      ZXRfcmJkX25vZGVfY2Fwc19hbmRfZW50aXR5KHNlbGYpOgogICAgICAgIGVudGl0eSA9ICJjbGll
      bnQuY3NpLXJiZC1ub2RlIgogICAgICAgIGNhcHMgPSB7CiAgICAgICAgICAgICJtb24iOiAicHJv
      ZmlsZSByYmQsIGFsbG93IGNvbW1hbmQgJ29zZCBibG9ja2xpc3QnIiwKICAgICAgICAgICAgIm9z
      ZCI6ICJwcm9maWxlIHJiZCIsCiAgICAgICAgfQogICAgICAgIGlmIHNlbGYuX2FyZ19wYXJzZXIu
      cmVzdHJpY3RlZF9hdXRoX3Blcm1pc3Npb246CiAgICAgICAgICAgIHJiZF9wb29sX25hbWUgPSBz
      ZWxmLl9hcmdfcGFyc2VyLnJiZF9kYXRhX3Bvb2xfbmFtZQogICAgICAgICAgICBjbHVzdGVyX25h
      bWUgPSBzZWxmLl9hcmdfcGFyc2VyLmNsdXN0ZXJfbmFtZQogICAgICAgICAgICBpZiByYmRfcG9v
      bF9uYW1lID09ICIiIG9yIGNsdXN0ZXJfbmFtZSA9PSAiIjoKICAgICAgICAgICAgICAgIHJhaXNl
      IEV4ZWN1dGlvbkZhaWx1cmVFeGNlcHRpb24oCiAgICAgICAgICAgICAgICAgICAgIm1hbmRhdG9y
      eSBmbGFncyBub3QgZm91bmQsIHBsZWFzZSBzZXQgdGhlICctLXJiZC1kYXRhLXBvb2wtbmFtZScs
      ICctLWNsdXN0ZXItbmFtZScgZmxhZ3MiCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgIGVu
      dGl0eSA9IGYie2VudGl0eX0te2NsdXN0ZXJfbmFtZX0te3JiZF9wb29sX25hbWV9IgogICAgICAg
      ICAgICBjYXBzWyJvc2QiXSA9IGYicHJvZmlsZSByYmQgcG9vbD17cmJkX3Bvb2xfbmFtZX0iCgog
      ICAgICAgIHJldHVybiBjYXBzLCBlbnRpdHkKCiAgICBkZWYgZ2V0X2NhcHNfYW5kX2VudGl0eShz
      ZWxmLCB1c2VyX25hbWUpOgogICAgICAgIGlmICJjbGllbnQuY3NpLWNlcGhmcy1wcm92aXNpb25l
      ciIgaW4gdXNlcl9uYW1lOgogICAgICAgICAgICBpZiAiY2xpZW50LmNzaS1jZXBoZnMtcHJvdmlz
      aW9uZXIiICE9IHVzZXJfbmFtZToKICAgICAgICAgICAgICAgIHNlbGYuX2FyZ19wYXJzZXIucmVz
      dHJpY3RlZF9hdXRoX3Blcm1pc3Npb24gPSBUcnVlCiAgICAgICAgICAgIHJldHVybiBzZWxmLmdl
      dF9jZXBoZnNfcHJvdmlzaW9uZXJfY2Fwc19hbmRfZW50aXR5KCkKICAgICAgICBpZiAiY2xpZW50
      LmNzaS1jZXBoZnMtbm9kZSIgaW4gdXNlcl9uYW1lOgogICAgICAgICAgICBpZiAiY2xpZW50LmNz
      aS1jZXBoZnMtbm9kZSIgIT0gdXNlcl9uYW1lOgogICAgICAgICAgICAgICAgc2VsZi5fYXJnX3Bh
      cnNlci5yZXN0cmljdGVkX2F1dGhfcGVybWlzc2lvbiA9IFRydWUKICAgICAgICAgICAgcmV0dXJu
      IHNlbGYuZ2V0X2NlcGhmc19ub2RlX2NhcHNfYW5kX2VudGl0eSgpCiAgICAgICAgaWYgImNsaWVu
      dC5jc2ktcmJkLXByb3Zpc2lvbmVyIiBpbiB1c2VyX25hbWU6CiAgICAgICAgICAgIGlmICJjbGll
      bnQuY3NpLXJiZC1wcm92aXNpb25lciIgIT0gdXNlcl9uYW1lOgogICAgICAgICAgICAgICAgc2Vs
      Zi5fYXJnX3BhcnNlci5yZXN0cmljdGVkX2F1dGhfcGVybWlzc2lvbiA9IFRydWUKICAgICAgICAg
      ICAgcmV0dXJuIHNlbGYuZ2V0X3JiZF9wcm92aXNpb25lcl9jYXBzX2FuZF9lbnRpdHkoKQogICAg
      ICAgIGlmICJjbGllbnQuY3NpLXJiZC1ub2RlIiBpbiB1c2VyX25hbWU6CiAgICAgICAgICAgIGlm
      ICJjbGllbnQuY3NpLXJiZC1ub2RlIiAhPSB1c2VyX25hbWU6CiAgICAgICAgICAgICAgICBzZWxm
      Ll9hcmdfcGFyc2VyLnJlc3RyaWN0ZWRfYXV0aF9wZXJtaXNzaW9uID0gVHJ1ZQogICAgICAgICAg
      ICByZXR1cm4gc2VsZi5nZXRfcmJkX25vZGVfY2Fwc19hbmRfZW50aXR5KCkKCiAgICAgICAgcmFp
      c2UgRXhlY3V0aW9uRmFpbHVyZUV4Y2VwdGlvbigKICAgICAgICAgICAgZiJubyB1c2VyIGZvdW5k
      IHdpdGggdXNlcl9uYW1lOiB7dXNlcl9uYW1lfSwgIgogICAgICAgICAgICAiZ2V0X2NhcHNfYW5k
      X2VudGl0eSBjb21tYW5kIGZhaWxlZC5cbiIKICAgICAgICApCgogICAgZGVmIGNyZWF0ZV9jZXBo
      Q1NJS2V5cmluZ191c2VyKHNlbGYsIHVzZXIpOgogICAgICAgICIiIgogICAgICAgIGNvbW1hbmQ6
      IGNlcGggYXV0aCBnZXQtb3ItY3JlYXRlIGNsaWVudC5jc2ktY2VwaGZzLXByb3Zpc2lvbmVyIG1v
      biAnYWxsb3cgcicgbWdyICdhbGxvdyBydycgb3NkICdhbGxvdyBydyB0YWcgY2VwaGZzIG1ldGFk
      YXRhPSonCiAgICAgICAgIiIiCiAgICAgICAgY2FwcywgZW50aXR5ID0gc2VsZi5nZXRfY2Fwc19h
      bmRfZW50aXR5KHVzZXIpCiAgICAgICAgY21kX2pzb24gPSB7CiAgICAgICAgICAgICJwcmVmaXgi
      OiAiYXV0aCBnZXQtb3ItY3JlYXRlIiwKICAgICAgICAgICAgImVudGl0eSI6IGVudGl0eSwKICAg
      ICAgICAgICAgImNhcHMiOiBbY2FwIGZvciBjYXBfbGlzdCBpbiBsaXN0KGNhcHMuaXRlbXMoKSkg
      Zm9yIGNhcCBpbiBjYXBfbGlzdF0sCiAgICAgICAgICAgICJmb3JtYXQiOiAianNvbiIsCiAgICAg
      ICAgfQoKICAgICAgICBpZiBzZWxmLl9hcmdfcGFyc2VyLmRyeV9ydW46CiAgICAgICAgICAgIHJl
      dHVybiAoCiAgICAgICAgICAgICAgICBzZWxmLmRyeV9ydW4oCiAgICAgICAgICAgICAgICAgICAg
      ImNlcGggIgogICAgICAgICAgICAgICAgICAgICsgY21kX2pzb25bInByZWZpeCJdCiAgICAgICAg
      ICAgICAgICAgICAgKyAiICIKICAgICAgICAgICAgICAgICAgICArIGNtZF9qc29uWyJlbnRpdHki
      XQogICAgICAgICAgICAgICAgICAgICsgIiAiCiAgICAgICAgICAgICAgICAgICAgKyAiICIuam9p
      bihjbWRfanNvblsiY2FwcyJdKQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICIi
      LAogICAgICAgICAgICApCiAgICAgICAgIyBjaGVjayBpZiB1c2VyIGFscmVhZHkgZXhpc3QKICAg
      ICAgICB1c2VyX2tleSA9IHNlbGYuY2hlY2tfdXNlcl9leGlzdChlbnRpdHkpCiAgICAgICAgaWYg
      dXNlcl9rZXkgIT0gIiI6CiAgICAgICAgICAgIHJldHVybiB1c2VyX2tleSwgZiJ7ZW50aXR5LnNw
      bGl0KCcuJywgMSlbMV19IgogICAgICAgICAgICAjIGVudGl0eS5zcGxpdCgnLicsMSlbMV0gdG8g
      cmVuYW1lIGVudGl0eShjbGllbnQuY3NpLXJiZC1ub2RlKSBhcyBjc2ktcmJkLW5vZGUKCiAgICAg
      ICAgcmV0X3ZhbCwganNvbl9vdXQsIGVycl9tc2cgPSBzZWxmLl9jb21tb25fY21kX2pzb25fZ2Vu
      KGNtZF9qc29uKQogICAgICAgICMgaWYgdGhlcmUgaXMgYW4gdW5zdWNjZXNzZnVsIGF0dGVtcHQs
      CiAgICAgICAgaWYgcmV0X3ZhbCAhPSAwIG9yIGxlbihqc29uX291dCkgPT0gMDoKICAgICAgICAg
      ICAgcmFpc2UgRXhlY3V0aW9uRmFpbHVyZUV4Y2VwdGlvbigKICAgICAgICAgICAgICAgIGYiJ2F1
      dGggZ2V0LW9yLWNyZWF0ZSB7dXNlcn0nIGNvbW1hbmQgZmFpbGVkLlxuIgogICAgICAgICAgICAg
      ICAgZiJFcnJvcjoge2Vycl9tc2cgaWYgcmV0X3ZhbCAhPSAwIGVsc2Ugc2VsZi5FTVBUWV9PVVRQ
      VVRfTElTVH0iCiAgICAgICAgICAgICkKICAgICAgICByZXR1cm4gc3RyKGpzb25fb3V0WzBdWyJr
      ZXkiXSksIGYie2VudGl0eS5zcGxpdCgnLicsIDEpWzFdfSIKICAgICAgICAjIGVudGl0eS5zcGxp
      dCgnLicsMSlbMV0gdG8gcmVuYW1lIGVudGl0eShjbGllbnQuY3NpLXJiZC1ub2RlKSBhcyBjc2kt
      cmJkLW5vZGUKCiAgICBkZWYgZ2V0X2NlcGhmc19kYXRhX3Bvb2xfZGV0YWlscyhzZWxmKToKICAg
      ICAgICBjbWRfanNvbiA9IHsicHJlZml4IjogImZzIGxzIiwgImZvcm1hdCI6ICJqc29uIn0KICAg
      ICAgICBpZiBzZWxmLl9hcmdfcGFyc2VyLmRyeV9ydW46CiAgICAgICAgICAgIHJldHVybiBzZWxm
      LmRyeV9ydW4oImNlcGggIiArIGNtZF9qc29uWyJwcmVmaXgiXSkKICAgICAgICByZXRfdmFsLCBq
      c29uX291dCwgZXJyX21zZyA9IHNlbGYuX2NvbW1vbl9jbWRfanNvbl9nZW4oY21kX2pzb24pCiAg
      ICAgICAgIyBpZiB0aGVyZSBpcyBhbiB1bnN1Y2Nlc3NmdWwgYXR0ZW1wdCwgcmVwb3J0IGFuIGVy
      cm9yCiAgICAgICAgaWYgcmV0X3ZhbCAhPSAwOgogICAgICAgICAgICAjIGlmIGZzIGFuZCBkYXRh
      X3Bvb2wgYXJndW1lbnRzIGFyZSBub3Qgc2V0LCBzaWxlbnRseSByZXR1cm4KICAgICAgICAgICAg
      aWYgKAogICAgICAgICAgICAgICAgc2VsZi5fYXJnX3BhcnNlci5jZXBoZnNfZmlsZXN5c3RlbV9u
      YW1lID09ICIiCiAgICAgICAgICAgICAgICBhbmQgc2VsZi5fYXJnX3BhcnNlci5jZXBoZnNfZGF0
      YV9wb29sX25hbWUgPT0gIiIKICAgICAgICAgICAgKToKICAgICAgICAgICAgICAgIHJldHVybgog
      ICAgICAgICAgICAjIGlmIHVzZXIgaGFzIHByb3ZpZGVkIGFueSBvZiB0aGUKICAgICAgICAgICAg
      IyAnLS1jZXBoZnMtZmlsZXN5c3RlbS1uYW1lJyBvciAnLS1jZXBoZnMtZGF0YS1wb29sLW5hbWUn
      IGFyZ3VtZW50cywKICAgICAgICAgICAgIyByYWlzZSBhbiBleGNlcHRpb24gYXMgd2UgYXJlIHVu
      YWJsZSB0byB2ZXJpZnkgdGhlIGFyZ3MKICAgICAgICAgICAgcmFpc2UgRXhlY3V0aW9uRmFpbHVy
      ZUV4Y2VwdGlvbigKICAgICAgICAgICAgICAgIGYiJ2ZzIGxzJyBjZXBoIGNhbGwgZmFpbGVkIHdp
      dGggZXJyb3I6IHtlcnJfbXNnfSIKICAgICAgICAgICAgKQoKICAgICAgICBtYXRjaGluZ19qc29u
      X291dCA9IHt9CiAgICAgICAgIyBpZiAnLS1jZXBoZnMtZmlsZXN5c3RlbS1uYW1lJyBhcmd1bWVu
      dCBpcyBwcm92aWRlZCwKICAgICAgICAjIGNoZWNrIHdoZXRoZXIgdGhlIHByb3ZpZGVkIGZpbGVz
      eXN0ZW0tbmFtZSBleGlzdHMgb3Igbm90CiAgICAgICAgaWYgc2VsZi5fYXJnX3BhcnNlci5jZXBo
      ZnNfZmlsZXN5c3RlbV9uYW1lOgogICAgICAgICAgICAjIGdldCB0aGUgbWF0Y2hpbmcgbGlzdAog
      ICAgICAgICAgICBtYXRjaGluZ19qc29uX291dF9saXN0ID0gWwogICAgICAgICAgICAgICAgbWF0
      Y2hlZAogICAgICAgICAgICAgICAgZm9yIG1hdGNoZWQgaW4ganNvbl9vdXQKICAgICAgICAgICAg
      ICAgIGlmIHN0cihtYXRjaGVkWyJuYW1lIl0pID09IHNlbGYuX2FyZ19wYXJzZXIuY2VwaGZzX2Zp
      bGVzeXN0ZW1fbmFtZQogICAgICAgICAgICBdCiAgICAgICAgICAgICMgdW5hYmxlIHRvIGZpbmQg
      YSBtYXRjaGluZyBmcy1uYW1lLCByYWlzZSBhbiBlcnJvcgogICAgICAgICAgICBpZiBsZW4obWF0
      Y2hpbmdfanNvbl9vdXRfbGlzdCkgPT0gMDoKICAgICAgICAgICAgICAgIHJhaXNlIEV4ZWN1dGlv
      bkZhaWx1cmVFeGNlcHRpb24oCiAgICAgICAgICAgICAgICAgICAgZiJGaWxlc3lzdGVtIHByb3Zp
      ZGVkLCAne3NlbGYuX2FyZ19wYXJzZXIuY2VwaGZzX2ZpbGVzeXN0ZW1fbmFtZX0nLCAiCiAgICAg
      ICAgICAgICAgICAgICAgZiJpcyBub3QgZm91bmQgaW4gdGhlIGZzLWxpc3Q6IHtbc3RyKHhbJ25h
      bWUnXSkgZm9yIHggaW4ganNvbl9vdXRdfSIKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAg
      bWF0Y2hpbmdfanNvbl9vdXQgPSBtYXRjaGluZ19qc29uX291dF9saXN0WzBdCiAgICAgICAgIyBp
      ZiBjZXBoZnMgZmlsZXN5c3RlbSBuYW1lIGlzIG5vdCBwcm92aWRlZCwKICAgICAgICAjIHRyeSB0
      byBnZXQgYSBkZWZhdWx0IGZzIG5hbWUgYnkgZG9pbmcgdGhlIGZvbGxvd2luZwogICAgICAgIGVs
      c2U6CiAgICAgICAgICAgICMgYS4gY2hlY2sgaWYgdGhlcmUgaXMgb25seSBvbmUgZmlsZXN5c3Rl
      bSBpcyBwcmVzZW50CiAgICAgICAgICAgIGlmIGxlbihqc29uX291dCkgPT0gMToKICAgICAgICAg
      ICAgICAgIG1hdGNoaW5nX2pzb25fb3V0ID0ganNvbl9vdXRbMF0KICAgICAgICAgICAgIyBiLiBv
      ciBlbHNlLCBjaGVjayBpZiBkYXRhX3Bvb2wgbmFtZSBpcyBwcm92aWRlZAogICAgICAgICAgICBl
      bGlmIHNlbGYuX2FyZ19wYXJzZXIuY2VwaGZzX2RhdGFfcG9vbF9uYW1lOgogICAgICAgICAgICAg
      ICAgIyBhbmQgaWYgcHJlc2VudCwgY2hlY2sgd2hldGhlciB0aGVyZSBleGlzdHMgYSBmcyB3aGlj
      aCBoYXMgdGhlIGRhdGFfcG9vbAogICAgICAgICAgICAgICAgZm9yIGVhY2hKIGluIGpzb25fb3V0
      OgogICAgICAgICAgICAgICAgICAgIGlmIHNlbGYuX2FyZ19wYXJzZXIuY2VwaGZzX2RhdGFfcG9v
      bF9uYW1lIGluIGVhY2hKWyJkYXRhX3Bvb2xzIl06CiAgICAgICAgICAgICAgICAgICAgICAgIG1h
      dGNoaW5nX2pzb25fb3V0ID0gZWFjaEoKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAg
      ICAgICAgICAgICAgICMgaWYgdGhlcmUgaXMgbm8gbWF0Y2hpbmcgZnMgZXhpc3RzLCB0aGF0IG1l
      YW5zIHByb3ZpZGVkIGRhdGFfcG9vbCBuYW1lIGlzIGludmFsaWQKICAgICAgICAgICAgICAgIGlm
      IG5vdCBtYXRjaGluZ19qc29uX291dDoKICAgICAgICAgICAgICAgICAgICByYWlzZSBFeGVjdXRp
      b25GYWlsdXJlRXhjZXB0aW9uKAogICAgICAgICAgICAgICAgICAgICAgICBmIlByb3ZpZGVkIGRh
      dGFfcG9vbCBuYW1lLCB7c2VsZi5fYXJnX3BhcnNlci5jZXBoZnNfZGF0YV9wb29sX25hbWV9LCIK
      ICAgICAgICAgICAgICAgICAgICAgICAgIiBkb2VzIG5vdCBleGlzdHMiCiAgICAgICAgICAgICAg
      ICAgICAgKQogICAgICAgICAgICAjIGMuIGlmIG5vdGhpbmcgaXMgc2V0IGFuZCBjb3VsZG4ndCBm
      aW5kIGEgZGVmYXVsdCwKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICMganVzdCBy
      ZXR1cm4gc2lsZW50bHkKICAgICAgICAgICAgICAgIHJldHVybgoKICAgICAgICBpZiBtYXRjaGlu
      Z19qc29uX291dDoKICAgICAgICAgICAgc2VsZi5fYXJnX3BhcnNlci5jZXBoZnNfZmlsZXN5c3Rl
      bV9uYW1lID0gc3RyKG1hdGNoaW5nX2pzb25fb3V0WyJuYW1lIl0pCiAgICAgICAgICAgIHNlbGYu
      X2FyZ19wYXJzZXIuY2VwaGZzX21ldGFkYXRhX3Bvb2xfbmFtZSA9IHN0cigKICAgICAgICAgICAg
      ICAgIG1hdGNoaW5nX2pzb25fb3V0WyJtZXRhZGF0YV9wb29sIl0KICAgICAgICAgICAgKQoKICAg
      ICAgICBpZiBpc2luc3RhbmNlKG1hdGNoaW5nX2pzb25fb3V0WyJkYXRhX3Bvb2xzIl0sIGxpc3Qp
      OgogICAgICAgICAgICAjIGlmIHRoZSB1c2VyIGhhcyBhbHJlYWR5IHByb3ZpZGVkIGRhdGEtcG9v
      bC1uYW1lLAogICAgICAgICAgICAjIHRocm91Z2ggLS1jZXBoZnMtZGF0YS1wb29sLW5hbWUKICAg
      ICAgICAgICAgaWYgc2VsZi5fYXJnX3BhcnNlci5jZXBoZnNfZGF0YV9wb29sX25hbWU6CiAgICAg
      ICAgICAgICAgICAjIGlmIHRoZSBwcm92aWRlZCBuYW1lIGlzIG5vdCBtYXRjaGluZyB3aXRoIHRo
      ZSBvbmUgaW4gdGhlIGxpc3QKICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAg
      ICBzZWxmLl9hcmdfcGFyc2VyLmNlcGhmc19kYXRhX3Bvb2xfbmFtZQogICAgICAgICAgICAgICAg
      ICAgIG5vdCBpbiBtYXRjaGluZ19qc29uX291dFsiZGF0YV9wb29scyJdCiAgICAgICAgICAgICAg
      ICApOgogICAgICAgICAgICAgICAgICAgIHJhaXNlIEV4ZWN1dGlvbkZhaWx1cmVFeGNlcHRpb24o
      CiAgICAgICAgICAgICAgICAgICAgICAgIGYiUHJvdmlkZWQgZGF0YS1wb29sLW5hbWU6ICd7c2Vs
      Zi5fYXJnX3BhcnNlci5jZXBoZnNfZGF0YV9wb29sX25hbWV9JywgIgogICAgICAgICAgICAgICAg
      ICAgICAgICAiZG9lc24ndCBtYXRjaCBmcm9tIHRoZSBkYXRhLXBvb2xzIGxpc3Q6ICIKICAgICAg
      ICAgICAgICAgICAgICAgICAgZiJ7W3N0cih4KSBmb3IgeCBpbiBtYXRjaGluZ19qc29uX291dFsn
      ZGF0YV9wb29scyddXX0iCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAjIGlmIGRh
      dGFfcG9vbCBuYW1lIGlzIG5vdCBwcm92aWRlZCwKICAgICAgICAgICAgIyB0aGVuIHRyeSB0byBm
      aW5kIGEgZGVmYXVsdCBkYXRhIHBvb2wgbmFtZQogICAgICAgICAgICBlbHNlOgogICAgICAgICAg
      ICAgICAgIyBpZiBubyBkYXRhX3Bvb2xzIGV4aXN0LCBzaWxlbnRseSByZXR1cm4KICAgICAgICAg
      ICAgICAgIGlmIGxlbihtYXRjaGluZ19qc29uX291dFsiZGF0YV9wb29scyJdKSA9PSAwOgogICAg
      ICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAgICAgc2VsZi5fYXJnX3BhcnNlci5j
      ZXBoZnNfZGF0YV9wb29sX25hbWUgPSBzdHIoCiAgICAgICAgICAgICAgICAgICAgbWF0Y2hpbmdf
      anNvbl9vdXRbImRhdGFfcG9vbHMiXVswXQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAj
      IGlmIHRoZXJlIGFyZSBtb3JlIHRoYW4gb25lICdkYXRhX3Bvb2xzJyBleGlzdCwKICAgICAgICAg
      ICAgIyB0aGVuIHdhcm4gdGhlIHVzZXIgdGhhdCB3ZSBhcmUgdXNpbmcgdGhlIHNlbGVjdGVkIG5h
      bWUKICAgICAgICAgICAgaWYgbGVuKG1hdGNoaW5nX2pzb25fb3V0WyJkYXRhX3Bvb2xzIl0pID4g
      MToKICAgICAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgICAgICJXQVJOSU5HOiBN
      dWx0aXBsZSBkYXRhIHBvb2xzIGRldGVjdGVkOiAiCiAgICAgICAgICAgICAgICAgICAgZiJ7W3N0
      cih4KSBmb3IgeCBpbiBtYXRjaGluZ19qc29uX291dFsnZGF0YV9wb29scyddXX1cbiIKICAgICAg
      ICAgICAgICAgICAgICBmIlVzaW5nIHRoZSBkYXRhLXBvb2w6ICd7c2VsZi5fYXJnX3BhcnNlci5j
      ZXBoZnNfZGF0YV9wb29sX25hbWV9J1xuIgogICAgICAgICAgICAgICAgKQoKICAgIGRlZiBjcmVh
      dGVfY2hlY2tlcktleShzZWxmKToKICAgICAgICBjbWRfanNvbiA9IHsKICAgICAgICAgICAgInBy
      ZWZpeCI6ICJhdXRoIGdldC1vci1jcmVhdGUiLAogICAgICAgICAgICAiZW50aXR5Ijogc2VsZi5y
      dW5fYXNfdXNlciwKICAgICAgICAgICAgImNhcHMiOiBbCiAgICAgICAgICAgICAgICAibW9uIiwK
      ICAgICAgICAgICAgICAgIHNlbGYuTUlOX1VTRVJfQ0FQX1BFUk1JU1NJT05TWyJtb24iXSwKICAg
      ICAgICAgICAgICAgICJtZ3IiLAogICAgICAgICAgICAgICAgc2VsZi5NSU5fVVNFUl9DQVBfUEVS
      TUlTU0lPTlNbIm1nciJdLAogICAgICAgICAgICAgICAgIm9zZCIsCiAgICAgICAgICAgICAgICBz
      ZWxmLk1JTl9VU0VSX0NBUF9QRVJNSVNTSU9OU1sib3NkIl0uZm9ybWF0KAogICAgICAgICAgICAg
      ICAgICAgIHNlbGYuX2FyZ19wYXJzZXIucmd3X3Bvb2xfcHJlZml4CiAgICAgICAgICAgICAgICAp
      LAogICAgICAgICAgICBdLAogICAgICAgICAgICAiZm9ybWF0IjogImpzb24iLAogICAgICAgIH0K
      ICAgICAgICBpZiBzZWxmLl9hcmdfcGFyc2VyLmRyeV9ydW46CiAgICAgICAgICAgIHJldHVybiBz
      ZWxmLmRyeV9ydW4oCiAgICAgICAgICAgICAgICAiY2VwaCAiCiAgICAgICAgICAgICAgICArIGNt
      ZF9qc29uWyJwcmVmaXgiXQogICAgICAgICAgICAgICAgKyAiICIKICAgICAgICAgICAgICAgICsg
      Y21kX2pzb25bImVudGl0eSJdCiAgICAgICAgICAgICAgICArICIgIgogICAgICAgICAgICAgICAg
      KyAiICIuam9pbihjbWRfanNvblsiY2FwcyJdKQogICAgICAgICAgICApCiAgICAgICAgcmV0X3Zh
      bCwganNvbl9vdXQsIGVycl9tc2cgPSBzZWxmLl9jb21tb25fY21kX2pzb25fZ2VuKGNtZF9qc29u
      KQogICAgICAgICMgaWYgdGhlcmUgaXMgYW4gdW5zdWNjZXNzZnVsIGF0dGVtcHQsCiAgICAgICAg
      aWYgcmV0X3ZhbCAhPSAwIG9yIGxlbihqc29uX291dCkgPT0gMDoKICAgICAgICAgICAgcmFpc2Ug
      RXhlY3V0aW9uRmFpbHVyZUV4Y2VwdGlvbigKICAgICAgICAgICAgICAgIGYiJ2F1dGggZ2V0LW9y
      LWNyZWF0ZSB7c2VsZi5ydW5fYXNfdXNlcn0nIGNvbW1hbmQgZmFpbGVkXG4iCiAgICAgICAgICAg
      ICAgICBmIkVycm9yOiB7ZXJyX21zZyBpZiByZXRfdmFsICE9IDAgZWxzZSBzZWxmLkVNUFRZX09V
      VFBVVF9MSVNUfSIKICAgICAgICAgICAgKQogICAgICAgIHJldHVybiBzdHIoanNvbl9vdXRbMF1b
      ImtleSJdKQoKICAgIGRlZiBnZXRfY2VwaF9kYXNoYm9hcmRfbGluayhzZWxmKToKICAgICAgICBj
      bWRfanNvbiA9IHsicHJlZml4IjogIm1nciBzZXJ2aWNlcyIsICJmb3JtYXQiOiAianNvbiJ9CiAg
      ICAgICAgaWYgc2VsZi5fYXJnX3BhcnNlci5kcnlfcnVuOgogICAgICAgICAgICByZXR1cm4gc2Vs
      Zi5kcnlfcnVuKCJjZXBoICIgKyBjbWRfanNvblsicHJlZml4Il0pCiAgICAgICAgcmV0X3ZhbCwg
      anNvbl9vdXQsIF8gPSBzZWxmLl9jb21tb25fY21kX2pzb25fZ2VuKGNtZF9qc29uKQogICAgICAg
      ICMgaWYgdGhlcmUgaXMgYW4gdW5zdWNjZXNzZnVsIGF0dGVtcHQsCiAgICAgICAgaWYgcmV0X3Zh
      bCAhPSAwIG9yIGxlbihqc29uX291dCkgPT0gMDoKICAgICAgICAgICAgcmV0dXJuIE5vbmUKICAg
      ICAgICBpZiAiZGFzaGJvYXJkIiBub3QgaW4ganNvbl9vdXQ6CiAgICAgICAgICAgIHJldHVybiBO
      b25lCiAgICAgICAgcmV0dXJuIGpzb25fb3V0WyJkYXNoYm9hcmQiXQoKICAgIGRlZiBjcmVhdGVf
      cmd3X2FkbWluX29wc191c2VyKHNlbGYpOgogICAgICAgIGNtZCA9IFsKICAgICAgICAgICAgInJh
      ZG9zZ3ctYWRtaW4iLAogICAgICAgICAgICAidXNlciIsCiAgICAgICAgICAgICJjcmVhdGUiLAog
      ICAgICAgICAgICAiLS11aWQiLAogICAgICAgICAgICBzZWxmLkVYVEVSTkFMX1JHV19BRE1JTl9P
      UFNfVVNFUl9OQU1FLAogICAgICAgICAgICAiLS1kaXNwbGF5LW5hbWUiLAogICAgICAgICAgICAi
      Um9vayBSR1cgQWRtaW4gT3BzIHVzZXIiLAogICAgICAgICAgICAiLS1jYXBzIiwKICAgICAgICAg
      ICAgImJ1Y2tldHM9Kjt1c2Vycz0qO3VzYWdlPXJlYWQ7bWV0YWRhdGE9cmVhZDt6b25lPXJlYWQi
      LAogICAgICAgICAgICAiLS1yZ3ctcmVhbG0iLAogICAgICAgICAgICBzZWxmLl9hcmdfcGFyc2Vy
      LnJnd19yZWFsbV9uYW1lLAogICAgICAgIF0KICAgICAgICBpZiBzZWxmLl9hcmdfcGFyc2VyLmRy
      eV9ydW46CiAgICAgICAgICAgIHJldHVybiBzZWxmLmRyeV9ydW4oImNlcGggIiArICIgIi5qb2lu
      KGNtZCkpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBvdXRwdXQgPSBzdWJwcm9jZXNzLmNoZWNr
      X291dHB1dChjbWQsIHN0ZGVycj1zdWJwcm9jZXNzLlBJUEUpCiAgICAgICAgZXhjZXB0IHN1YnBy
      b2Nlc3MuQ2FsbGVkUHJvY2Vzc0Vycm9yIGFzIGV4ZWNFcnI6CiAgICAgICAgICAgICMgaWYgdGhl
      IHVzZXIgYWxyZWFkeSBleGlzdHMsIHdlIGp1c3QgcXVlcnkgaXQKICAgICAgICAgICAgaWYgZXhl
      Y0Vyci5yZXR1cm5jb2RlID09IGVycm5vLkVFWElTVDoKICAgICAgICAgICAgICAgIGNtZCA9IFsK
      ICAgICAgICAgICAgICAgICAgICAicmFkb3Nndy1hZG1pbiIsCiAgICAgICAgICAgICAgICAgICAg
      InVzZXIiLAogICAgICAgICAgICAgICAgICAgICJpbmZvIiwKICAgICAgICAgICAgICAgICAgICAi
      LS11aWQiLAogICAgICAgICAgICAgICAgICAgIHNlbGYuRVhURVJOQUxfUkdXX0FETUlOX09QU19V
      U0VSX05BTUUsCiAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAg
      ICAgICAgICAgICAgb3V0cHV0ID0gc3VicHJvY2Vzcy5jaGVja19vdXRwdXQoY21kLCBzdGRlcnI9
      c3VicHJvY2Vzcy5QSVBFKQogICAgICAgICAgICAgICAgZXhjZXB0IHN1YnByb2Nlc3MuQ2FsbGVk
      UHJvY2Vzc0Vycm9yIGFzIGV4ZWNFcnI6CiAgICAgICAgICAgICAgICAgICAgZXJyX21zZyA9ICgK
      ICAgICAgICAgICAgICAgICAgICAgICAgZiJmYWlsZWQgdG8gZXhlY3V0ZSBjb21tYW5kIHtjbWR9
      LiBPdXRwdXQ6IHtleGVjRXJyLm91dHB1dH0uICIKICAgICAgICAgICAgICAgICAgICAgICAgZiJD
      b2RlOiB7ZXhlY0Vyci5yZXR1cm5jb2RlfS4gRXJyb3I6IHtleGVjRXJyLnN0ZGVycn0iCiAgICAg
      ICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgIHN5cy5zdGRlcnIud3JpdGUoZXJy
      X21zZykKICAgICAgICAgICAgICAgICAgICByZXR1cm4gTm9uZSwgTm9uZSwgRmFsc2UsICItMSIK
      ICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGVycl9tc2cgPSAoCiAgICAgICAgICAg
      ICAgICAgICAgZiJmYWlsZWQgdG8gZXhlY3V0ZSBjb21tYW5kIHtjbWR9LiBPdXRwdXQ6IHtleGVj
      RXJyLm91dHB1dH0uICIKICAgICAgICAgICAgICAgICAgICBmIkNvZGU6IHtleGVjRXJyLnJldHVy
      bmNvZGV9LiBFcnJvcjoge2V4ZWNFcnIuc3RkZXJyfSIKICAgICAgICAgICAgICAgICkKICAgICAg
      ICAgICAgICAgIHN5cy5zdGRlcnIud3JpdGUoZXJyX21zZykKICAgICAgICAgICAgICAgIHJldHVy
      biBOb25lLCBOb25lLCBGYWxzZSwgIi0xIgoKICAgICAgICAjIGlmIGl0IGlzIHB5dGhvbjIsIGRv
      bid0IGNoZWNrIGZvciBjZXBoIHZlcnNpb24gZm9yIGFkZGluZyBgaW5mbz1yZWFkYCBjYXAocmd3
      X3ZhbGlkYXRpb24pCiAgICAgICAgaWYgc3lzLnZlcnNpb25faW5mby5tYWpvciA8IDM6CiAgICAg
      ICAgICAgIGpzb25vdXRwdXQgPSBqc29uLmxvYWRzKG91dHB1dCkKICAgICAgICAgICAgcmV0dXJu
      ICgKICAgICAgICAgICAgICAgIGpzb25vdXRwdXRbImtleXMiXVswXVsiYWNjZXNzX2tleSJdLAog
      ICAgICAgICAgICAgICAganNvbm91dHB1dFsia2V5cyJdWzBdWyJzZWNyZXRfa2V5Il0sCiAgICAg
      ICAgICAgICAgICBGYWxzZSwKICAgICAgICAgICAgICAgICIiLAogICAgICAgICAgICApCgogICAg
      ICAgICMgc2VwYXJhdGVseSBhZGQgaW5mbz1yZWFkIGNhcHMgZm9yIHJndy1lbmRwb2ludCBpcCB2
      YWxpZGF0aW9uCiAgICAgICAgaW5mb19jYXBfc3VwcG9ydGVkID0gVHJ1ZQogICAgICAgIGNtZCA9
      IFsKICAgICAgICAgICAgInJhZG9zZ3ctYWRtaW4iLAogICAgICAgICAgICAiY2FwcyIsCiAgICAg
      ICAgICAgICJhZGQiLAogICAgICAgICAgICAiLS11aWQiLAogICAgICAgICAgICBzZWxmLkVYVEVS
      TkFMX1JHV19BRE1JTl9PUFNfVVNFUl9OQU1FLAogICAgICAgICAgICAiLS1jYXBzIiwKICAgICAg
      ICAgICAgImluZm89cmVhZCIsCiAgICAgICAgXQogICAgICAgIHRyeToKICAgICAgICAgICAgb3V0
      cHV0ID0gc3VicHJvY2Vzcy5jaGVja19vdXRwdXQoY21kLCBzdGRlcnI9c3VicHJvY2Vzcy5QSVBF
      KQogICAgICAgIGV4Y2VwdCBzdWJwcm9jZXNzLkNhbGxlZFByb2Nlc3NFcnJvciBhcyBleGVjRXJy
      OgogICAgICAgICAgICAjIGlmIHRoZSBjZXBoIHZlcnNpb24gbm90IHN1cHBvcnRlZCBmb3IgYWRk
      aW5nIGBpbmZvPXJlYWRgIGNhcChyZ3dfdmFsaWRhdGlvbikKICAgICAgICAgICAgaWYgKAogICAg
      ICAgICAgICAgICAgImNvdWxkIG5vdCBhZGQgY2FwczogdW5hYmxlIHRvIGFkZCBjYXBzOiBpbmZv
      PXJlYWRcbiIKICAgICAgICAgICAgICAgIGluIGV4ZWNFcnIuc3RkZXJyLmRlY29kZSgidXRmLTgi
      KQogICAgICAgICAgICAgICAgYW5kIGV4ZWNFcnIucmV0dXJuY29kZSA9PSAyNDQKICAgICAgICAg
      ICAgKToKICAgICAgICAgICAgICAgIGluZm9fY2FwX3N1cHBvcnRlZCA9IEZhbHNlCiAgICAgICAg
      ICAgIGVsc2U6CiAgICAgICAgICAgICAgICBlcnJfbXNnID0gKAogICAgICAgICAgICAgICAgICAg
      IGYiZmFpbGVkIHRvIGV4ZWN1dGUgY29tbWFuZCB7Y21kfS4gT3V0cHV0OiB7ZXhlY0Vyci5vdXRw
      dXR9LiAiCiAgICAgICAgICAgICAgICAgICAgZiJDb2RlOiB7ZXhlY0Vyci5yZXR1cm5jb2RlfS4g
      RXJyb3I6IHtleGVjRXJyLnN0ZGVycn0iCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAg
      ICBzeXMuc3RkZXJyLndyaXRlKGVycl9tc2cpCiAgICAgICAgICAgICAgICByZXR1cm4gTm9uZSwg
      Tm9uZSwgRmFsc2UsICItMSIKCiAgICAgICAganNvbm91dHB1dCA9IGpzb24ubG9hZHMob3V0cHV0
      KQogICAgICAgIHJldHVybiAoCiAgICAgICAgICAgIGpzb25vdXRwdXRbImtleXMiXVswXVsiYWNj
      ZXNzX2tleSJdLAogICAgICAgICAgICBqc29ub3V0cHV0WyJrZXlzIl1bMF1bInNlY3JldF9rZXki
      XSwKICAgICAgICAgICAgaW5mb19jYXBfc3VwcG9ydGVkLAogICAgICAgICAgICAiIiwKICAgICAg
      ICApCgogICAgZGVmIGNvbnZlcnRfZnFkbl9yZ3dfZW5kcG9pbnRfdG9faXAoc2VsZiwgZnFkbl9y
      Z3dfZW5kcG9pbnQpOgogICAgICAgIHRyeToKICAgICAgICAgICAgZnFkbiwgcG9ydCA9IGZxZG5f
      cmd3X2VuZHBvaW50LnNwbGl0KCI6IikKICAgICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAg
      ICAgICAgcmFpc2UgRXhlY3V0aW9uRmFpbHVyZUV4Y2VwdGlvbigKICAgICAgICAgICAgICAgIGYi
      Tm90IGEgcHJvcGVyIGVuZHBvaW50OiB7ZnFkbl9yZ3dfZW5kcG9pbnR9LCAiCiAgICAgICAgICAg
      ICAgICAiPEZRRE4+OjxQT1JUPiwgZm9ybWF0IGlzIGV4cGVjdGVkIgogICAgICAgICAgICApCiAg
      ICAgICAgcmd3X2VuZHBvaW50X2lwID0gc2VsZi5fY29udmVydF9ob3N0bmFtZV90b19pcChmcWRu
      KQogICAgICAgIHJnd19lbmRwb2ludF9wb3J0ID0gcG9ydAogICAgICAgIHJnd19lbmRwb2ludCA9
      IHNlbGYuX2pvaW5faG9zdF9wb3J0KHJnd19lbmRwb2ludF9pcCwgcmd3X2VuZHBvaW50X3BvcnQp
      CiAgICAgICAgcmV0dXJuIHJnd19lbmRwb2ludAoKICAgIGRlZiB2YWxpZGF0ZV9yYmRfcG9vbChz
      ZWxmKToKICAgICAgICBpZiBub3Qgc2VsZi5jbHVzdGVyLnBvb2xfZXhpc3RzKHNlbGYuX2FyZ19w
      YXJzZXIucmJkX2RhdGFfcG9vbF9uYW1lKToKICAgICAgICAgICAgcmFpc2UgRXhlY3V0aW9uRmFp
      bHVyZUV4Y2VwdGlvbigKICAgICAgICAgICAgICAgIGYiVGhlIHByb3ZpZGVkIHBvb2wsICd7c2Vs
      Zi5fYXJnX3BhcnNlci5yYmRfZGF0YV9wb29sX25hbWV9JywgZG9lcyBub3QgZXhpc3QiCiAgICAg
      ICAgICAgICkKCiAgICBkZWYgdmFsaWRhdGVfcmFkb3NfbmFtZXNwYWNlKHNlbGYpOgogICAgICAg
      IHJiZF9wb29sX25hbWUgPSBzZWxmLl9hcmdfcGFyc2VyLnJiZF9kYXRhX3Bvb2xfbmFtZQogICAg
      ICAgIHJhZG9zX25hbWVzcGFjZSA9IHNlbGYuX2FyZ19wYXJzZXIucmFkb3NfbmFtZXNwYWNlCiAg
      ICAgICAgaWYgcmFkb3NfbmFtZXNwYWNlID09ICIiOgogICAgICAgICAgICByZXR1cm4KICAgICAg
      ICByYmRfaW5zdCA9IHJiZC5SQkQoKQogICAgICAgIGlvY3R4ID0gc2VsZi5jbHVzdGVyLm9wZW5f
      aW9jdHgocmJkX3Bvb2xfbmFtZSkKICAgICAgICBpZiByYmRfaW5zdC5uYW1lc3BhY2VfZXhpc3Rz
      KGlvY3R4LCByYWRvc19uYW1lc3BhY2UpIGlzIEZhbHNlOgogICAgICAgICAgICByYWlzZSBFeGVj
      dXRpb25GYWlsdXJlRXhjZXB0aW9uKAogICAgICAgICAgICAgICAgZiJUaGUgcHJvdmlkZWQgcmFk
      b3MgTmFtZXNwYWNlLCAne3JhZG9zX25hbWVzcGFjZX0nLCAiCiAgICAgICAgICAgICAgICBmImlz
      IG5vdCBmb3VuZCBpbiB0aGUgcG9vbCAne3JiZF9wb29sX25hbWV9JyIKICAgICAgICAgICAgKQoK
      ICAgIGRlZiB2YWxpZGF0ZV9zdWJ2b2x1bWVfZ3JvdXAoc2VsZik6CiAgICAgICAgY2VwaGZzX2Zp
      bGVzeXN0ZW1fbmFtZSA9IHNlbGYuX2FyZ19wYXJzZXIuY2VwaGZzX2ZpbGVzeXN0ZW1fbmFtZQog
      ICAgICAgIHN1YnZvbHVtZV9ncm91cCA9IHNlbGYuX2FyZ19wYXJzZXIuc3Vidm9sdW1lX2dyb3Vw
      CiAgICAgICAgaWYgc3Vidm9sdW1lX2dyb3VwID09ICIiOgogICAgICAgICAgICByZXR1cm4KICAg
      ICAgICBpZiBjZXBoZnNfZmlsZXN5c3RlbV9uYW1lID09ICIiOgogICAgICAgICAgICByYWlzZSBF
      eGVjdXRpb25GYWlsdXJlRXhjZXB0aW9uKAogICAgICAgICAgICAgICAgImlmIHN1YnZvbHVtZSBn
      cm91cCBpcyBwYXNzZWQgY2VwaGZzIGZpbGVzeXN0ZW0gbmFtZSBpcyBtYW5kYXRvcnkgdG8gcGFz
      cyIKICAgICAgICAgICAgKQoKICAgICAgICBjbWQgPSBbCiAgICAgICAgICAgICJjZXBoIiwKICAg
      ICAgICAgICAgImZzIiwKICAgICAgICAgICAgInN1YnZvbHVtZWdyb3VwIiwKICAgICAgICAgICAg
      ImdldHBhdGgiLAogICAgICAgICAgICBjZXBoZnNfZmlsZXN5c3RlbV9uYW1lLAogICAgICAgICAg
      ICBzdWJ2b2x1bWVfZ3JvdXAsCiAgICAgICAgXQogICAgICAgIHRyeToKICAgICAgICAgICAgXyA9
      IHN1YnByb2Nlc3MuY2hlY2tfb3V0cHV0KGNtZCwgc3RkZXJyPXN1YnByb2Nlc3MuUElQRSkKICAg
      ICAgICBleGNlcHQgc3VicHJvY2Vzcy5DYWxsZWRQcm9jZXNzRXJyb3IgYXMgZXhlY0VycjoKICAg
      ICAgICAgICAgcmFpc2UgRXhlY3V0aW9uRmFpbHVyZUV4Y2VwdGlvbigKICAgICAgICAgICAgICAg
      IGYic3Vidm9sdW1lIGdyb3VwIHtzdWJ2b2x1bWVfZ3JvdXB9IHBhc3NlZCBkb2Vzbid0IGV4aXN0
      IgogICAgICAgICAgICApCgogICAgZGVmIGdldF9yZ3dfZnNpZChzZWxmLCBiYXNlX3VybCwgdmVy
      aWZ5KToKICAgICAgICBhY2Nlc3Nfa2V5ID0gc2VsZi5vdXRfbWFwWyJSR1dfQURNSU5fT1BTX1VT
      RVJfQUNDRVNTX0tFWSJdCiAgICAgICAgc2VjcmV0X2tleSA9IHNlbGYub3V0X21hcFsiUkdXX0FE
      TUlOX09QU19VU0VSX1NFQ1JFVF9LRVkiXQogICAgICAgIHJnd19lbmRwb2ludCA9IHNlbGYuX2Fy
      Z19wYXJzZXIucmd3X2VuZHBvaW50CiAgICAgICAgYmFzZV91cmwgPSBiYXNlX3VybCArICI6Ly8i
      ICsgcmd3X2VuZHBvaW50ICsgIi9hZG1pbi9pbmZvPyIKICAgICAgICBwYXJhbXMgPSB7ImZvcm1h
      dCI6ICJqc29uIn0KICAgICAgICByZXF1ZXN0X3VybCA9IGJhc2VfdXJsICsgdXJsbGliLnBhcnNl
      LnVybGVuY29kZShwYXJhbXMpCgogICAgICAgIHRyeToKICAgICAgICAgICAgciA9IHJlcXVlc3Rz
      LmdldCgKICAgICAgICAgICAgICAgIHJlcXVlc3RfdXJsLAogICAgICAgICAgICAgICAgYXV0aD1T
      M0F1dGgoYWNjZXNzX2tleSwgc2VjcmV0X2tleSwgcmd3X2VuZHBvaW50KSwKICAgICAgICAgICAg
      ICAgIHZlcmlmeT12ZXJpZnksCiAgICAgICAgICAgICkKICAgICAgICBleGNlcHQgcmVxdWVzdHMu
      ZXhjZXB0aW9ucy5UaW1lb3V0OgogICAgICAgICAgICBzeXMuc3RkZXJyLndyaXRlKAogICAgICAg
      ICAgICAgICAgZiJpbnZhbGlkIGVuZHBvaW50Oiwgbm90IGFibGUgdG8gY2FsbCBhZG1pbi1vcHMg
      YXBpe3Jnd19lbmRwb2ludH0iCiAgICAgICAgICAgICkKICAgICAgICAgICAgcmV0dXJuICIiLCAi
      LTEiCiAgICAgICAgcjEgPSByLmpzb24oKQogICAgICAgIGlmIHIxIGlzIE5vbmUgb3IgcjEuZ2V0
      KCJpbmZvIikgaXMgTm9uZToKICAgICAgICAgICAgc3lzLnN0ZGVyci53cml0ZSgKICAgICAgICAg
      ICAgICAgIGYiVGhlIHByb3ZpZGVkIHJndyBFbmRwb2ludCwgJ3tzZWxmLl9hcmdfcGFyc2VyLnJn
      d19lbmRwb2ludH0nLCBpcyBpbnZhbGlkLiIKICAgICAgICAgICAgKQogICAgICAgICAgICByZXR1
      cm4gKAogICAgICAgICAgICAgICAgIiIsCiAgICAgICAgICAgICAgICAiLTEiLAogICAgICAgICAg
      ICApCgogICAgICAgIHJldHVybiByMVsiaW5mbyJdWyJzdG9yYWdlX2JhY2tlbmRzIl1bMF1bImNs
      dXN0ZXJfaWQiXSwgIiIKCiAgICBkZWYgdmFsaWRhdGVfcmd3X2VuZHBvaW50KHNlbGYpOgogICAg
      ICAgICMgaWYgdGhlICdjbHVzdGVyJyBpbnN0YW5jZSBpcyBhIGR1bW15IG9uZSwKICAgICAgICAj
      IGRvbid0IHRyeSB0byByZWFjaCBvdXQgdG8gdGhlIGVuZHBvaW50CiAgICAgICAgaWYgaXNpbnN0
      YW5jZShzZWxmLmNsdXN0ZXIsIER1bW15UmFkb3MpOgogICAgICAgICAgICByZXR1cm4KCiAgICAg
      ICAgIyBjaGVjayBpZiB0aGUgcmd3IGVuZHBvaW50IGlzIHJlYWNoYWJsZQogICAgICAgIHJnd19l
      bmRwb2ludCA9IHNlbGYuX2FyZ19wYXJzZXIucmd3X2VuZHBvaW50CiAgICAgICAgY2VydCA9IE5v
      bmUKICAgICAgICBpZiBub3Qgc2VsZi5fYXJnX3BhcnNlci5yZ3dfc2tpcF90bHMgYW5kIHNlbGYu
      dmFsaWRhdGVfcmd3X2VuZHBvaW50X3Rsc19jZXJ0KCk6CiAgICAgICAgICAgIGNlcnQgPSBzZWxm
      Ll9hcmdfcGFyc2VyLnJnd190bHNfY2VydF9wYXRoCiAgICAgICAgYmFzZV91cmwsIHZlcmlmeSwg
      ZXJyID0gc2VsZi5lbmRwb2ludF9kaWFsKHJnd19lbmRwb2ludCwgY2VydD1jZXJ0KQogICAgICAg
      IGlmIGVyciAhPSAiIjoKICAgICAgICAgICAgcmV0dXJuICItMSIKCiAgICAgICAgIyBjaGVjayBp
      ZiB0aGUgcmd3IGVuZHBvaW50IGlzIHZhbGlkIGFuZCBiZWxvbmdzIHRvIHRoZSBzYW1lIGNsdXN0
      ZXIKICAgICAgICBmc2lkID0gc2VsZi5nZXRfZnNpZCgpCiAgICAgICAgcmd3X2ZzaWQsIGVyciA9
      IHNlbGYuZ2V0X3Jnd19mc2lkKGJhc2VfdXJsLCB2ZXJpZnkpCiAgICAgICAgaWYgZXJyID09ICIt
      MSI6CiAgICAgICAgICAgIHJldHVybiAiLTEiCiAgICAgICAgaWYgZnNpZCAhPSByZ3dfZnNpZDoK
      ICAgICAgICAgICAgc3lzLnN0ZGVyci53cml0ZSgKICAgICAgICAgICAgICAgIGYiVGhlIHByb3Zp
      ZGVkIHJndyBFbmRwb2ludCwgJ3tzZWxmLl9hcmdfcGFyc2VyLnJnd19lbmRwb2ludH0nLCBpcyBp
      bnZhbGlkLiBXZSBhcmUgdmFsaWRhdGluZyBieSBjYWxsaW5nIHRoZSBhZG1pbm9wcyBhcGkgdGhy
      b3VnaCByZ3ctZW5kcG9pbnQgYW5kIHZhbGlkYXRpbmcgdGhlIGNsdXN0ZXJfaWQgJ3tyZ3dfZnNp
      ZH0nIGlzIGVxdWFsIHRvIHRoZSBjZXBoIGNsdXN0ZXIgZnNpZCAne2ZzaWR9JyIKICAgICAgICAg
      ICAgKQogICAgICAgICAgICByZXR1cm4gIi0xIgoKICAgICAgICAjIGNoZWNrIGlmIHRoZSByZ3cg
      ZW5kcG9pbnQgZXhpc3QKICAgICAgICAjIG9ubHkgdmFsaWRhdGUgaWYgcmd3X3Bvb2xfcHJlZml4
      IGlzIHBhc3NlZCBlbHNlIGl0IHdpbGwgdGFrZSBkZWZhdWx0IHZhbHVlIGFuZCB3ZSBkb24ndCBj
      cmVhdGUgdGhlc2UgZGVmYXVsdCBwb29scwogICAgICAgIGlmIHNlbGYuX2FyZ19wYXJzZXIucmd3
      X3Bvb2xfcHJlZml4ICE9ICJkZWZhdWx0IjoKICAgICAgICAgICAgcmd3X3Bvb2xfdG9fdmFsaWRh
      dGUgPSBbCiAgICAgICAgICAgICAgICBmIntzZWxmLl9hcmdfcGFyc2VyLnJnd19wb29sX3ByZWZp
      eH0ucmd3Lm1ldGEiLAogICAgICAgICAgICAgICAgIi5yZ3cucm9vdCIsCiAgICAgICAgICAgICAg
      ICBmIntzZWxmLl9hcmdfcGFyc2VyLnJnd19wb29sX3ByZWZpeH0ucmd3LmNvbnRyb2wiLAogICAg
      ICAgICAgICAgICAgZiJ7c2VsZi5fYXJnX3BhcnNlci5yZ3dfcG9vbF9wcmVmaXh9LnJndy5sb2ci
      LAogICAgICAgICAgICBdCiAgICAgICAgICAgIGlmIG5vdCBzZWxmLmNsdXN0ZXIucG9vbF9leGlz
      dHMoc2VsZi5fYXJnX3BhcnNlci5yZ3dfcG9vbF90b192YWxpZGF0ZSk6CiAgICAgICAgICAgICAg
      ICBzeXMuc3RkZXJyLndyaXRlKAogICAgICAgICAgICAgICAgICAgIGYiVGhlIHByb3ZpZGVkIHBv
      b2wsICd7c2VsZi5fYXJnX3BhcnNlci5yZ3dfcG9vbF90b192YWxpZGF0ZX0nLCBkb2VzIG5vdCBl
      eGlzdCIKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIHJldHVybiAiLTEiCgogICAg
      ICAgIHJldHVybiAiIgoKICAgIGRlZiB2YWxpZGF0ZV9yZ3dfcmVhbG1fbmFtZShzZWxmKToKICAg
      ICAgICBpZiBzZWxmLl9hcmdfcGFyc2VyLnJnd19yZWFsbV9uYW1lICE9ICIiOgogICAgICAgICAg
      ICBjbWQgPSBbCiAgICAgICAgICAgICAgICAicmFkb3Nndy1hZG1pbiIsCiAgICAgICAgICAgICAg
      ICAicmVhbG0iLAogICAgICAgICAgICAgICAgImdldCIsCiAgICAgICAgICAgICAgICAiLS1yZ3ct
      cmVhbG0iLAogICAgICAgICAgICAgICAgc2VsZi5fYXJnX3BhcnNlci5yZ3dfcmVhbG1fbmFtZSwK
      ICAgICAgICAgICAgXQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBfID0gc3VicHJv
      Y2Vzcy5jaGVja19vdXRwdXQoY21kLCBzdGRlcnI9c3VicHJvY2Vzcy5QSVBFKQogICAgICAgICAg
      ICBleGNlcHQgc3VicHJvY2Vzcy5DYWxsZWRQcm9jZXNzRXJyb3IgYXMgZXhlY0VycjoKICAgICAg
      ICAgICAgICAgIGVycl9tc2cgPSAoCiAgICAgICAgICAgICAgICAgICAgZiJmYWlsZWQgdG8gZXhl
      Y3V0ZSBjb21tYW5kIHtjbWR9LiBPdXRwdXQ6IHtleGVjRXJyLm91dHB1dH0uICIKICAgICAgICAg
      ICAgICAgICAgICBmIkNvZGU6IHtleGVjRXJyLnJldHVybmNvZGV9LiBFcnJvcjoge2V4ZWNFcnIu
      c3RkZXJyfSIKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIHJhaXNlIEV4Y2VwdGlv
      bihlcnJfbXNnKQoKICAgIGRlZiBfZ2VuX291dHB1dF9tYXAoc2VsZik6CiAgICAgICAgaWYgc2Vs
      Zi5vdXRfbWFwOgogICAgICAgICAgICByZXR1cm4KICAgICAgICBzZWxmLl9hcmdfcGFyc2VyLmNs
      dXN0ZXJfbmFtZSA9ICgKICAgICAgICAgICAgc2VsZi5fYXJnX3BhcnNlci5jbHVzdGVyX25hbWUu
      bG93ZXIoKQogICAgICAgICkgICMgYWx3YXlzIGNvbnZlcnQgY2x1c3RlciBuYW1lIHRvIGxvd2Vy
      Y2FzZSBjaGFyYWN0ZXJzCiAgICAgICAgaWYgc2VsZi5fYXJnX3BhcnNlci5yZ3dfZW5kcG9pbnQ6
      CiAgICAgICAgICAgIHNlbGYuX2FyZ19wYXJzZXIucmd3X2VuZHBvaW50ID0gc2VsZi5jb252ZXJ0
      X2ZxZG5fcmd3X2VuZHBvaW50X3RvX2lwKAogICAgICAgICAgICAgICAgc2VsZi5fYXJnX3BhcnNl
      ci5yZ3dfZW5kcG9pbnQKICAgICAgICAgICAgKQogICAgICAgIHNlbGYudmFsaWRhdGVfcmJkX3Bv
      b2woKQogICAgICAgIHNlbGYudmFsaWRhdGVfcmFkb3NfbmFtZXNwYWNlKCkKICAgICAgICBzZWxm
      LnZhbGlkYXRlX3N1YnZvbHVtZV9ncm91cCgpCiAgICAgICAgc2VsZi52YWxpZGF0ZV9yZ3dfcmVh
      bG1fbmFtZSgpCiAgICAgICAgc2VsZi5fZXhjbHVkZWRfa2V5cy5hZGQoIkNMVVNURVJfTkFNRSIp
      CiAgICAgICAgc2VsZi5nZXRfY2VwaGZzX2RhdGFfcG9vbF9kZXRhaWxzKCkKICAgICAgICBzZWxm
      Lm91dF9tYXBbIk5BTUVTUEFDRSJdID0gc2VsZi5fYXJnX3BhcnNlci5uYW1lc3BhY2UKICAgICAg
      ICBzZWxmLm91dF9tYXBbIkNMVVNURVJfTkFNRSJdID0gc2VsZi5fYXJnX3BhcnNlci5jbHVzdGVy
      X25hbWUKICAgICAgICBzZWxmLm91dF9tYXBbIlJPT0tfRVhURVJOQUxfRlNJRCJdID0gc2VsZi5n
      ZXRfZnNpZCgpCiAgICAgICAgc2VsZi5vdXRfbWFwWyJST09LX0VYVEVSTkFMX1VTRVJOQU1FIl0g
      PSBzZWxmLnJ1bl9hc191c2VyCiAgICAgICAgc2VsZi5vdXRfbWFwWyJST09LX0VYVEVSTkFMX0NF
      UEhfTU9OX0RBVEEiXSA9IHNlbGYuZ2V0X2NlcGhfZXh0ZXJuYWxfbW9uX2RhdGEoKQogICAgICAg
      IHNlbGYub3V0X21hcFsiUk9PS19FWFRFUk5BTF9VU0VSX1NFQ1JFVCJdID0gc2VsZi5jcmVhdGVf
      Y2hlY2tlcktleSgpCiAgICAgICAgc2VsZi5vdXRfbWFwWyJST09LX0VYVEVSTkFMX0RBU0hCT0FS
      RF9MSU5LIl0gPSBzZWxmLmdldF9jZXBoX2Rhc2hib2FyZF9saW5rKCkKICAgICAgICAoCiAgICAg
      ICAgICAgIHNlbGYub3V0X21hcFsiQ1NJX1JCRF9OT0RFX1NFQ1JFVCJdLAogICAgICAgICAgICBz
      ZWxmLm91dF9tYXBbIkNTSV9SQkRfTk9ERV9TRUNSRVRfTkFNRSJdLAogICAgICAgICkgPSBzZWxm
      LmNyZWF0ZV9jZXBoQ1NJS2V5cmluZ191c2VyKCJjbGllbnQuY3NpLXJiZC1ub2RlIikKICAgICAg
      ICAoCiAgICAgICAgICAgIHNlbGYub3V0X21hcFsiQ1NJX1JCRF9QUk9WSVNJT05FUl9TRUNSRVQi
      XSwKICAgICAgICAgICAgc2VsZi5vdXRfbWFwWyJDU0lfUkJEX1BST1ZJU0lPTkVSX1NFQ1JFVF9O
      QU1FIl0sCiAgICAgICAgKSA9IHNlbGYuY3JlYXRlX2NlcGhDU0lLZXlyaW5nX3VzZXIoImNsaWVu
      dC5jc2ktcmJkLXByb3Zpc2lvbmVyIikKICAgICAgICBzZWxmLm91dF9tYXBbIkNFUEhGU19QT09M
      X05BTUUiXSA9IHNlbGYuX2FyZ19wYXJzZXIuY2VwaGZzX2RhdGFfcG9vbF9uYW1lCiAgICAgICAg
      c2VsZi5vdXRfbWFwWwogICAgICAgICAgICAiQ0VQSEZTX01FVEFEQVRBX1BPT0xfTkFNRSIKICAg
      ICAgICBdID0gc2VsZi5fYXJnX3BhcnNlci5jZXBoZnNfbWV0YWRhdGFfcG9vbF9uYW1lCiAgICAg
      ICAgc2VsZi5vdXRfbWFwWyJDRVBIRlNfRlNfTkFNRSJdID0gc2VsZi5fYXJnX3BhcnNlci5jZXBo
      ZnNfZmlsZXN5c3RlbV9uYW1lCiAgICAgICAgc2VsZi5vdXRfbWFwWwogICAgICAgICAgICAiUkVT
      VFJJQ1RFRF9BVVRIX1BFUk1JU1NJT04iCiAgICAgICAgXSA9IHNlbGYuX2FyZ19wYXJzZXIucmVz
      dHJpY3RlZF9hdXRoX3Blcm1pc3Npb24KICAgICAgICBzZWxmLm91dF9tYXBbIlJBRE9TX05BTUVT
      UEFDRSJdID0gc2VsZi5fYXJnX3BhcnNlci5yYWRvc19uYW1lc3BhY2UKICAgICAgICBzZWxmLm91
      dF9tYXBbIlNVQlZPTFVNRV9HUk9VUCJdID0gc2VsZi5fYXJnX3BhcnNlci5zdWJ2b2x1bWVfZ3Jv
      dXAKICAgICAgICBzZWxmLm91dF9tYXBbIkNTSV9DRVBIRlNfTk9ERV9TRUNSRVQiXSA9ICIiCiAg
      ICAgICAgc2VsZi5vdXRfbWFwWyJDU0lfQ0VQSEZTX1BST1ZJU0lPTkVSX1NFQ1JFVCJdID0gIiIK
      ICAgICAgICAjIGNyZWF0ZSBDZXBoRlMgbm9kZSBhbmQgcHJvdmlzaW9uZXIga2V5cmluZyBvbmx5
      IHdoZW4gTURTIGV4aXN0cwogICAgICAgIGlmIHNlbGYub3V0X21hcFsiQ0VQSEZTX0ZTX05BTUUi
      XSBhbmQgc2VsZi5vdXRfbWFwWyJDRVBIRlNfUE9PTF9OQU1FIl06CiAgICAgICAgICAgICgKICAg
      ICAgICAgICAgICAgIHNlbGYub3V0X21hcFsiQ1NJX0NFUEhGU19OT0RFX1NFQ1JFVCJdLAogICAg
      ICAgICAgICAgICAgc2VsZi5vdXRfbWFwWyJDU0lfQ0VQSEZTX05PREVfU0VDUkVUX05BTUUiXSwK
      ICAgICAgICAgICAgKSA9IHNlbGYuY3JlYXRlX2NlcGhDU0lLZXlyaW5nX3VzZXIoImNsaWVudC5j
      c2ktY2VwaGZzLW5vZGUiKQogICAgICAgICAgICAoCiAgICAgICAgICAgICAgICBzZWxmLm91dF9t
      YXBbIkNTSV9DRVBIRlNfUFJPVklTSU9ORVJfU0VDUkVUIl0sCiAgICAgICAgICAgICAgICBzZWxm
      Lm91dF9tYXBbIkNTSV9DRVBIRlNfUFJPVklTSU9ORVJfU0VDUkVUX05BTUUiXSwKICAgICAgICAg
      ICAgKSA9IHNlbGYuY3JlYXRlX2NlcGhDU0lLZXlyaW5nX3VzZXIoImNsaWVudC5jc2ktY2VwaGZz
      LXByb3Zpc2lvbmVyIikKICAgICAgICBzZWxmLm91dF9tYXBbIlJHV19UTFNfQ0VSVCJdID0gIiIK
      ICAgICAgICAoCiAgICAgICAgICAgIHNlbGYub3V0X21hcFsiTU9OSVRPUklOR19FTkRQT0lOVCJd
      LAogICAgICAgICAgICBzZWxmLm91dF9tYXBbIk1PTklUT1JJTkdfRU5EUE9JTlRfUE9SVCJdLAog
      ICAgICAgICkgPSBzZWxmLmdldF9hY3RpdmVfYW5kX3N0YW5kYnlfbWdycygpCiAgICAgICAgc2Vs
      Zi5vdXRfbWFwWyJSQkRfUE9PTF9OQU1FIl0gPSBzZWxmLl9hcmdfcGFyc2VyLnJiZF9kYXRhX3Bv
      b2xfbmFtZQogICAgICAgIHNlbGYub3V0X21hcFsKICAgICAgICAgICAgIlJCRF9NRVRBREFUQV9F
      Q19QT09MX05BTUUiCiAgICAgICAgXSA9IHNlbGYudmFsaWRhdGVfcmJkX21ldGFkYXRhX2VjX3Bv
      b2xfbmFtZSgpCiAgICAgICAgc2VsZi5vdXRfbWFwWyJSR1dfUkVBTE1fTkFNRSJdID0gc2VsZi5f
      YXJnX3BhcnNlci5yZ3dfcmVhbG1fbmFtZQogICAgICAgIHNlbGYub3V0X21hcFsiUkdXX1BPT0xf
      UFJFRklYIl0gPSBzZWxmLl9hcmdfcGFyc2VyLnJnd19wb29sX3ByZWZpeAogICAgICAgIHNlbGYu
      b3V0X21hcFsiUkdXX0VORFBPSU5UIl0gPSAiIgogICAgICAgIGlmIHNlbGYuX2FyZ19wYXJzZXIu
      cmd3X2VuZHBvaW50OgogICAgICAgICAgICBpZiBzZWxmLl9hcmdfcGFyc2VyLmRyeV9ydW46CiAg
      ICAgICAgICAgICAgICBzZWxmLmNyZWF0ZV9yZ3dfYWRtaW5fb3BzX3VzZXIoKQogICAgICAgICAg
      ICBlbHNlOgogICAgICAgICAgICAgICAgKAogICAgICAgICAgICAgICAgICAgIHNlbGYub3V0X21h
      cFsiUkdXX0FETUlOX09QU19VU0VSX0FDQ0VTU19LRVkiXSwKICAgICAgICAgICAgICAgICAgICBz
      ZWxmLm91dF9tYXBbIlJHV19BRE1JTl9PUFNfVVNFUl9TRUNSRVRfS0VZIl0sCiAgICAgICAgICAg
      ICAgICAgICAgaW5mb19jYXBfc3VwcG9ydGVkLAogICAgICAgICAgICAgICAgICAgIGVyciwKICAg
      ICAgICAgICAgICAgICkgPSBzZWxmLmNyZWF0ZV9yZ3dfYWRtaW5fb3BzX3VzZXIoKQogICAgICAg
      ICAgICAgICAgaWYgaW5mb19jYXBfc3VwcG9ydGVkOgogICAgICAgICAgICAgICAgICAgIGVyciA9
      IHNlbGYudmFsaWRhdGVfcmd3X2VuZHBvaW50KCkKICAgICAgICAgICAgICAgIGlmIHNlbGYuX2Fy
      Z19wYXJzZXIucmd3X3Rsc19jZXJ0X3BhdGg6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5vdXRf
      bWFwWyJSR1dfVExTX0NFUlQiXSA9IHNlbGYudmFsaWRhdGVfcmd3X2VuZHBvaW50X3Rsc19jZXJ0
      KCkKICAgICAgICAgICAgICAgICMgaWYgdGhlcmUgaXMgbm8gZXJyb3IsIHNldCB0aGUgUkdXX0VO
      RFBPSU5UCiAgICAgICAgICAgICAgICBpZiBlcnIgIT0gIi0xIjoKICAgICAgICAgICAgICAgICAg
      ICBzZWxmLm91dF9tYXBbIlJHV19FTkRQT0lOVCJdID0gc2VsZi5fYXJnX3BhcnNlci5yZ3dfZW5k
      cG9pbnQKCiAgICBkZWYgZ2VuX3NoZWxsX291dChzZWxmKToKICAgICAgICBzZWxmLl9nZW5fb3V0
      cHV0X21hcCgpCiAgICAgICAgc2hPdXRJTyA9IFN0cmluZ0lPKCkKICAgICAgICBmb3IgaywgdiBp
      biBzZWxmLm91dF9tYXAuaXRlbXMoKToKICAgICAgICAgICAgaWYgdiBhbmQgayBub3QgaW4gc2Vs
      Zi5fZXhjbHVkZWRfa2V5czoKICAgICAgICAgICAgICAgIHNoT3V0SU8ud3JpdGUoZiJleHBvcnQg
      e2t9PXt2fXtMSU5FU0VQfSIpCiAgICAgICAgc2hPdXQgPSBzaE91dElPLmdldHZhbHVlKCkKICAg
      ICAgICBzaE91dElPLmNsb3NlKCkKICAgICAgICByZXR1cm4gc2hPdXQKCiAgICBkZWYgZ2VuX2pz
      b25fb3V0KHNlbGYpOgogICAgICAgIHNlbGYuX2dlbl9vdXRwdXRfbWFwKCkKICAgICAgICBpZiBz
      ZWxmLl9hcmdfcGFyc2VyLmRyeV9ydW46CiAgICAgICAgICAgIHJldHVybiAiIgogICAgICAgIGpz
      b25fb3V0ID0gWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAibmFtZSI6ICJyb29rLWNl
      cGgtbW9uLWVuZHBvaW50cyIsCiAgICAgICAgICAgICAgICAia2luZCI6ICJDb25maWdNYXAiLAog
      ICAgICAgICAgICAgICAgImRhdGEiOiB7CiAgICAgICAgICAgICAgICAgICAgImRhdGEiOiBzZWxm
      Lm91dF9tYXBbIlJPT0tfRVhURVJOQUxfQ0VQSF9NT05fREFUQSJdLAogICAgICAgICAgICAgICAg
      ICAgICJtYXhNb25JZCI6ICIwIiwKICAgICAgICAgICAgICAgICAgICAibWFwcGluZyI6ICJ7fSIs
      CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAg
      ICAgICAgICAibmFtZSI6ICJyb29rLWNlcGgtbW9uIiwKICAgICAgICAgICAgICAgICJraW5kIjog
      IlNlY3JldCIsCiAgICAgICAgICAgICAgICAiZGF0YSI6IHsKICAgICAgICAgICAgICAgICAgICAi
      YWRtaW4tc2VjcmV0IjogImFkbWluLXNlY3JldCIsCiAgICAgICAgICAgICAgICAgICAgImZzaWQi
      OiBzZWxmLm91dF9tYXBbIlJPT0tfRVhURVJOQUxfRlNJRCJdLAogICAgICAgICAgICAgICAgICAg
      ICJtb24tc2VjcmV0IjogIm1vbi1zZWNyZXQiLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAg
      ICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIm5hbWUiOiAicm9vay1jZXBoLW9w
      ZXJhdG9yLWNyZWRzIiwKICAgICAgICAgICAgICAgICJraW5kIjogIlNlY3JldCIsCiAgICAgICAg
      ICAgICAgICAiZGF0YSI6IHsKICAgICAgICAgICAgICAgICAgICAidXNlcklEIjogc2VsZi5vdXRf
      bWFwWyJST09LX0VYVEVSTkFMX1VTRVJOQU1FIl0sCiAgICAgICAgICAgICAgICAgICAgInVzZXJL
      ZXkiOiBzZWxmLm91dF9tYXBbIlJPT0tfRVhURVJOQUxfVVNFUl9TRUNSRVQiXSwKICAgICAgICAg
      ICAgICAgIH0sCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICJu
      YW1lIjogIm1vbml0b3JpbmctZW5kcG9pbnQiLAogICAgICAgICAgICAgICAgImtpbmQiOiAiQ2Vw
      aENsdXN0ZXIiLAogICAgICAgICAgICAgICAgImRhdGEiOiB7CiAgICAgICAgICAgICAgICAgICAg
      Ik1vbml0b3JpbmdFbmRwb2ludCI6IHNlbGYub3V0X21hcFsiTU9OSVRPUklOR19FTkRQT0lOVCJd
      LAogICAgICAgICAgICAgICAgICAgICJNb25pdG9yaW5nUG9ydCI6IHNlbGYub3V0X21hcFsiTU9O
      SVRPUklOR19FTkRQT0lOVF9QT1JUIl0sCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICB9
      LAogICAgICAgIF0KCiAgICAgICAgIyBpZiAnQ1NJX1JCRF9OT0RFX1NFQ1JFVCcgZXhpc3RzLCB0
      aGVuIG9ubHkgYWRkICdyb29rLWNzaS1yYmQtcHJvdmlzaW9uZXInIFNlY3JldAogICAgICAgIGlm
      ICgKICAgICAgICAgICAgc2VsZi5vdXRfbWFwWyJDU0lfUkJEX05PREVfU0VDUkVUIl0KICAgICAg
      ICAgICAgYW5kIHNlbGYub3V0X21hcFsiQ1NJX1JCRF9OT0RFX1NFQ1JFVF9OQU1FIl0KICAgICAg
      ICApOgogICAgICAgICAgICBqc29uX291dC5hcHBlbmQoCiAgICAgICAgICAgICAgICB7CiAgICAg
      ICAgICAgICAgICAgICAgIm5hbWUiOiBmInJvb2ste3NlbGYub3V0X21hcFsnQ1NJX1JCRF9OT0RF
      X1NFQ1JFVF9OQU1FJ119IiwKICAgICAgICAgICAgICAgICAgICAia2luZCI6ICJTZWNyZXQiLAog
      ICAgICAgICAgICAgICAgICAgICJkYXRhIjogewogICAgICAgICAgICAgICAgICAgICAgICAidXNl
      cklEIjogc2VsZi5vdXRfbWFwWyJDU0lfUkJEX05PREVfU0VDUkVUX05BTUUiXSwKICAgICAgICAg
      ICAgICAgICAgICAgICAgInVzZXJLZXkiOiBzZWxmLm91dF9tYXBbIkNTSV9SQkRfTk9ERV9TRUNS
      RVQiXSwKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgfQogICAgICAgICAg
      ICApCiAgICAgICAgIyBpZiAnQ1NJX1JCRF9QUk9WSVNJT05FUl9TRUNSRVQnIGV4aXN0cywgdGhl
      biBvbmx5IGFkZCAncm9vay1jc2ktcmJkLXByb3Zpc2lvbmVyJyBTZWNyZXQKICAgICAgICBpZiAo
      CiAgICAgICAgICAgIHNlbGYub3V0X21hcFsiQ1NJX1JCRF9QUk9WSVNJT05FUl9TRUNSRVQiXQog
      ICAgICAgICAgICBhbmQgc2VsZi5vdXRfbWFwWyJDU0lfUkJEX1BST1ZJU0lPTkVSX1NFQ1JFVF9O
      QU1FIl0KICAgICAgICApOgogICAgICAgICAgICBqc29uX291dC5hcHBlbmQoCiAgICAgICAgICAg
      ICAgICB7CiAgICAgICAgICAgICAgICAgICAgIm5hbWUiOiBmInJvb2ste3NlbGYub3V0X21hcFsn
      Q1NJX1JCRF9QUk9WSVNJT05FUl9TRUNSRVRfTkFNRSddfSIsCiAgICAgICAgICAgICAgICAgICAg
      ImtpbmQiOiAiU2VjcmV0IiwKICAgICAgICAgICAgICAgICAgICAiZGF0YSI6IHsKICAgICAgICAg
      ICAgICAgICAgICAgICAgInVzZXJJRCI6IHNlbGYub3V0X21hcFsiQ1NJX1JCRF9QUk9WSVNJT05F
      Ul9TRUNSRVRfTkFNRSJdLAogICAgICAgICAgICAgICAgICAgICAgICAidXNlcktleSI6IHNlbGYu
      b3V0X21hcFsiQ1NJX1JCRF9QUk9WSVNJT05FUl9TRUNSRVQiXSwKICAgICAgICAgICAgICAgICAg
      ICB9LAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICApCiAgICAgICAgIyBpZiAnQ1NJX0NF
      UEhGU19QUk9WSVNJT05FUl9TRUNSRVQnIGV4aXN0cywgdGhlbiBvbmx5IGFkZCAncm9vay1jc2kt
      Y2VwaGZzLXByb3Zpc2lvbmVyJyBTZWNyZXQKICAgICAgICBpZiAoCiAgICAgICAgICAgIHNlbGYu
      b3V0X21hcFsiQ1NJX0NFUEhGU19QUk9WSVNJT05FUl9TRUNSRVQiXQogICAgICAgICAgICBhbmQg
      c2VsZi5vdXRfbWFwWyJDU0lfQ0VQSEZTX1BST1ZJU0lPTkVSX1NFQ1JFVF9OQU1FIl0KICAgICAg
      ICApOgogICAgICAgICAgICBqc29uX291dC5hcHBlbmQoCiAgICAgICAgICAgICAgICB7CiAgICAg
      ICAgICAgICAgICAgICAgIm5hbWUiOiBmInJvb2ste3NlbGYub3V0X21hcFsnQ1NJX0NFUEhGU19Q
      Uk9WSVNJT05FUl9TRUNSRVRfTkFNRSddfSIsCiAgICAgICAgICAgICAgICAgICAgImtpbmQiOiAi
      U2VjcmV0IiwKICAgICAgICAgICAgICAgICAgICAiZGF0YSI6IHsKICAgICAgICAgICAgICAgICAg
      ICAgICAgImFkbWluSUQiOiBzZWxmLm91dF9tYXBbIkNTSV9DRVBIRlNfUFJPVklTSU9ORVJfU0VD
      UkVUX05BTUUiXSwKICAgICAgICAgICAgICAgICAgICAgICAgImFkbWluS2V5Ijogc2VsZi5vdXRf
      bWFwWyJDU0lfQ0VQSEZTX1BST1ZJU0lPTkVSX1NFQ1JFVCJdLAogICAgICAgICAgICAgICAgICAg
      IH0sCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICkKICAgICAgICAjIGlmICdDU0lfQ0VQ
      SEZTX05PREVfU0VDUkVUJyBleGlzdHMsIHRoZW4gb25seSBhZGQgJ3Jvb2stY3NpLWNlcGhmcy1u
      b2RlJyBTZWNyZXQKICAgICAgICBpZiAoCiAgICAgICAgICAgIHNlbGYub3V0X21hcFsiQ1NJX0NF
      UEhGU19OT0RFX1NFQ1JFVCJdCiAgICAgICAgICAgIGFuZCBzZWxmLm91dF9tYXBbIkNTSV9DRVBI
      RlNfTk9ERV9TRUNSRVRfTkFNRSJdCiAgICAgICAgKToKICAgICAgICAgICAganNvbl9vdXQuYXBw
      ZW5kKAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJuYW1lIjogZiJyb29r
      LXtzZWxmLm91dF9tYXBbJ0NTSV9DRVBIRlNfTk9ERV9TRUNSRVRfTkFNRSddfSIsCiAgICAgICAg
      ICAgICAgICAgICAgImtpbmQiOiAiU2VjcmV0IiwKICAgICAgICAgICAgICAgICAgICAiZGF0YSI6
      IHsKICAgICAgICAgICAgICAgICAgICAgICAgImFkbWluSUQiOiBzZWxmLm91dF9tYXBbIkNTSV9D
      RVBIRlNfTk9ERV9TRUNSRVRfTkFNRSJdLAogICAgICAgICAgICAgICAgICAgICAgICAiYWRtaW5L
      ZXkiOiBzZWxmLm91dF9tYXBbIkNTSV9DRVBIRlNfTk9ERV9TRUNSRVQiXSwKICAgICAgICAgICAg
      ICAgICAgICB9LAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICApCiAgICAgICAgIyBpZiAn
      Uk9PS19FWFRFUk5BTF9EQVNIQk9BUkRfTElOSycgZXhpc3RzLCB0aGVuIG9ubHkgYWRkICdyb29r
      LWNlcGgtZGFzaGJvYXJkLWxpbmsnIFNlY3JldAogICAgICAgIGlmIHNlbGYub3V0X21hcFsiUk9P
      S19FWFRFUk5BTF9EQVNIQk9BUkRfTElOSyJdOgogICAgICAgICAgICBqc29uX291dC5hcHBlbmQo
      CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgIm5hbWUiOiAicm9vay1jZXBo
      LWRhc2hib2FyZC1saW5rIiwKICAgICAgICAgICAgICAgICAgICAia2luZCI6ICJTZWNyZXQiLAog
      ICAgICAgICAgICAgICAgICAgICJkYXRhIjogewogICAgICAgICAgICAgICAgICAgICAgICAidXNl
      cklEIjogImNlcGgtZGFzaGJvYXJkLWxpbmsiLAogICAgICAgICAgICAgICAgICAgICAgICAidXNl
      cktleSI6IHNlbGYub3V0X21hcFsiUk9PS19FWFRFUk5BTF9EQVNIQk9BUkRfTElOSyJdLAogICAg
      ICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICkKICAgICAg
      ICBpZiBzZWxmLm91dF9tYXBbIlJCRF9NRVRBREFUQV9FQ19QT09MX05BTUUiXToKICAgICAgICAg
      ICAganNvbl9vdXQuYXBwZW5kKAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAg
      ICJuYW1lIjogImNlcGgtcmJkIiwKICAgICAgICAgICAgICAgICAgICAia2luZCI6ICJTdG9yYWdl
      Q2xhc3MiLAogICAgICAgICAgICAgICAgICAgICJkYXRhIjogewogICAgICAgICAgICAgICAgICAg
      ICAgICAiZGF0YVBvb2wiOiBzZWxmLm91dF9tYXBbIlJCRF9QT09MX05BTUUiXSwKICAgICAgICAg
      ICAgICAgICAgICAgICAgInBvb2wiOiBzZWxmLm91dF9tYXBbIlJCRF9NRVRBREFUQV9FQ19QT09M
      X05BTUUiXSwKICAgICAgICAgICAgICAgICAgICAgICAgImNzaS5zdG9yYWdlLms4cy5pby9wcm92
      aXNpb25lci1zZWNyZXQtbmFtZSI6IGYicm9vay17c2VsZi5vdXRfbWFwWydDU0lfUkJEX1BST1ZJ
      U0lPTkVSX1NFQ1JFVF9OQU1FJ119IiwKICAgICAgICAgICAgICAgICAgICAgICAgImNzaS5zdG9y
      YWdlLms4cy5pby9jb250cm9sbGVyLWV4cGFuZC1zZWNyZXQtbmFtZSI6IGYicm9vay17c2VsZi5v
      dXRfbWFwWydDU0lfUkJEX1BST1ZJU0lPTkVSX1NFQ1JFVF9OQU1FJ119IiwKICAgICAgICAgICAg
      ICAgICAgICAgICAgImNzaS5zdG9yYWdlLms4cy5pby9ub2RlLXN0YWdlLXNlY3JldC1uYW1lIjog
      ZiJyb29rLXtzZWxmLm91dF9tYXBbJ0NTSV9SQkRfTk9ERV9TRUNSRVRfTkFNRSddfSIsCiAgICAg
      ICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgKQogICAgICAg
      IGVsc2U6CiAgICAgICAgICAgIGpzb25fb3V0LmFwcGVuZCgKICAgICAgICAgICAgICAgIHsKICAg
      ICAgICAgICAgICAgICAgICAibmFtZSI6ICJjZXBoLXJiZCIsCiAgICAgICAgICAgICAgICAgICAg
      ImtpbmQiOiAiU3RvcmFnZUNsYXNzIiwKICAgICAgICAgICAgICAgICAgICAiZGF0YSI6IHsKICAg
      ICAgICAgICAgICAgICAgICAgICAgInBvb2wiOiBzZWxmLm91dF9tYXBbIlJCRF9QT09MX05BTUUi
      XSwKICAgICAgICAgICAgICAgICAgICAgICAgImNzaS5zdG9yYWdlLms4cy5pby9wcm92aXNpb25l
      ci1zZWNyZXQtbmFtZSI6IGYicm9vay17c2VsZi5vdXRfbWFwWydDU0lfUkJEX1BST1ZJU0lPTkVS
      X1NFQ1JFVF9OQU1FJ119IiwKICAgICAgICAgICAgICAgICAgICAgICAgImNzaS5zdG9yYWdlLms4
      cy5pby9jb250cm9sbGVyLWV4cGFuZC1zZWNyZXQtbmFtZSI6IGYicm9vay17c2VsZi5vdXRfbWFw
      WydDU0lfUkJEX1BST1ZJU0lPTkVSX1NFQ1JFVF9OQU1FJ119IiwKICAgICAgICAgICAgICAgICAg
      ICAgICAgImNzaS5zdG9yYWdlLms4cy5pby9ub2RlLXN0YWdlLXNlY3JldC1uYW1lIjogZiJyb29r
      LXtzZWxmLm91dF9tYXBbJ0NTSV9SQkRfTk9ERV9TRUNSRVRfTkFNRSddfSIsCiAgICAgICAgICAg
      ICAgICAgICAgfSwKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgKQogICAgICAgICMgaWYg
      J0NFUEhGU19GU19OQU1FJyBleGlzdHMsIHRoZW4gb25seSBhZGQgJ2NlcGhmcycgU3RvcmFnZUNs
      YXNzCiAgICAgICAgaWYgc2VsZi5vdXRfbWFwWyJDRVBIRlNfRlNfTkFNRSJdOgogICAgICAgICAg
      ICBqc29uX291dC5hcHBlbmQoCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAg
      Im5hbWUiOiAiY2VwaGZzIiwKICAgICAgICAgICAgICAgICAgICAia2luZCI6ICJTdG9yYWdlQ2xh
      c3MiLAogICAgICAgICAgICAgICAgICAgICJkYXRhIjogewogICAgICAgICAgICAgICAgICAgICAg
      ICAiZnNOYW1lIjogc2VsZi5vdXRfbWFwWyJDRVBIRlNfRlNfTkFNRSJdLAogICAgICAgICAgICAg
      ICAgICAgICAgICAicG9vbCI6IHNlbGYub3V0X21hcFsiQ0VQSEZTX1BPT0xfTkFNRSJdLAogICAg
      ICAgICAgICAgICAgICAgICAgICAiY3NpLnN0b3JhZ2UuazhzLmlvL3Byb3Zpc2lvbmVyLXNlY3Jl
      dC1uYW1lIjogZiJyb29rLXtzZWxmLm91dF9tYXBbJ0NTSV9DRVBIRlNfUFJPVklTSU9ORVJfU0VD
      UkVUX05BTUUnXX0iLAogICAgICAgICAgICAgICAgICAgICAgICAiY3NpLnN0b3JhZ2UuazhzLmlv
      L2NvbnRyb2xsZXItZXhwYW5kLXNlY3JldC1uYW1lIjogZiJyb29rLXtzZWxmLm91dF9tYXBbJ0NT
      SV9DRVBIRlNfUFJPVklTSU9ORVJfU0VDUkVUX05BTUUnXX0iLAogICAgICAgICAgICAgICAgICAg
      ICAgICAiY3NpLnN0b3JhZ2UuazhzLmlvL25vZGUtc3RhZ2Utc2VjcmV0LW5hbWUiOiBmInJvb2st
      e3NlbGYub3V0X21hcFsnQ1NJX0NFUEhGU19OT0RFX1NFQ1JFVF9OQU1FJ119IiwKICAgICAgICAg
      ICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICApCiAgICAgICAgIyBp
      ZiAnUkdXX0VORFBPSU5UJyBleGlzdHMsIHRoZW4gb25seSBhZGQgJ2NlcGgtcmd3JyBTdG9yYWdl
      Q2xhc3MKICAgICAgICBpZiBzZWxmLm91dF9tYXBbIlJHV19FTkRQT0lOVCJdOgogICAgICAgICAg
      ICBqc29uX291dC5hcHBlbmQoCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAg
      Im5hbWUiOiAiY2VwaC1yZ3ciLAogICAgICAgICAgICAgICAgICAgICJraW5kIjogIlN0b3JhZ2VD
      bGFzcyIsCiAgICAgICAgICAgICAgICAgICAgImRhdGEiOiB7CiAgICAgICAgICAgICAgICAgICAg
      ICAgICJlbmRwb2ludCI6IHNlbGYub3V0X21hcFsiUkdXX0VORFBPSU5UIl0sCiAgICAgICAgICAg
      ICAgICAgICAgICAgICJwb29sUHJlZml4Ijogc2VsZi5vdXRfbWFwWyJSR1dfUE9PTF9QUkVGSVgi
      XSwKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAp
      CiAgICAgICAgICAgIGpzb25fb3V0LmFwcGVuZCgKICAgICAgICAgICAgICAgIHsKICAgICAgICAg
      ICAgICAgICAgICAibmFtZSI6ICJyZ3ctYWRtaW4tb3BzLXVzZXIiLAogICAgICAgICAgICAgICAg
      ICAgICJraW5kIjogIlNlY3JldCIsCiAgICAgICAgICAgICAgICAgICAgImRhdGEiOiB7CiAgICAg
      ICAgICAgICAgICAgICAgICAgICJhY2Nlc3NLZXkiOiBzZWxmLm91dF9tYXBbIlJHV19BRE1JTl9P
      UFNfVVNFUl9BQ0NFU1NfS0VZIl0sCiAgICAgICAgICAgICAgICAgICAgICAgICJzZWNyZXRLZXki
      OiBzZWxmLm91dF9tYXBbIlJHV19BRE1JTl9PUFNfVVNFUl9TRUNSRVRfS0VZIl0sCiAgICAgICAg
      ICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgKQogICAgICAgICMg
      aWYgJ1JHV19UTFNfQ0VSVCcgZXhpc3RzLCB0aGVuIG9ubHkgYWRkIHRoZSAiY2VwaC1yZ3ctdGxz
      LWNlcnQiIHNlY3JldAogICAgICAgIGlmIHNlbGYub3V0X21hcFsiUkdXX1RMU19DRVJUIl06CiAg
      ICAgICAgICAgIGpzb25fb3V0LmFwcGVuZCgKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAg
      ICAgICAgICAibmFtZSI6ICJjZXBoLXJndy10bHMtY2VydCIsCiAgICAgICAgICAgICAgICAgICAg
      ImtpbmQiOiAiU2VjcmV0IiwKICAgICAgICAgICAgICAgICAgICAiZGF0YSI6IHsKICAgICAgICAg
      ICAgICAgICAgICAgICAgImNlcnQiOiBzZWxmLm91dF9tYXBbIlJHV19UTFNfQ0VSVCJdLAogICAg
      ICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICkKCiAgICAg
      ICAgcmV0dXJuIGpzb24uZHVtcHMoanNvbl9vdXQpICsgTElORVNFUAoKICAgIGRlZiB1cGdyYWRl
      X3VzZXJzX3Blcm1pc3Npb25zKHNlbGYpOgogICAgICAgIHVzZXJzID0gWwogICAgICAgICAgICAi
      Y2xpZW50LmNzaS1jZXBoZnMtbm9kZSIsCiAgICAgICAgICAgICJjbGllbnQuY3NpLWNlcGhmcy1w
      cm92aXNpb25lciIsCiAgICAgICAgICAgICJjbGllbnQuY3NpLXJiZC1ub2RlIiwKICAgICAgICAg
      ICAgImNsaWVudC5jc2ktcmJkLXByb3Zpc2lvbmVyIiwKICAgICAgICBdCiAgICAgICAgaWYgc2Vs
      Zi5ydW5fYXNfdXNlciAhPSAiIiBhbmQgc2VsZi5ydW5fYXNfdXNlciBub3QgaW4gdXNlcnM6CiAg
      ICAgICAgICAgIHVzZXJzLmFwcGVuZChzZWxmLnJ1bl9hc191c2VyKQogICAgICAgIGZvciB1c2Vy
      IGluIHVzZXJzOgogICAgICAgICAgICBzZWxmLnVwZ3JhZGVfdXNlcl9wZXJtaXNzaW9ucyh1c2Vy
      KQoKICAgIGRlZiB1cGdyYWRlX3VzZXJfcGVybWlzc2lvbnMoc2VsZiwgdXNlcik6CiAgICAgICAg
      IyBjaGVjayB3aGV0aGVyIHRoZSBnaXZlbiB1c2VyIGV4aXN0cyBvciBub3QKICAgICAgICBjbWRf
      anNvbiA9IHsicHJlZml4IjogImF1dGggZ2V0IiwgImVudGl0eSI6IGYie3VzZXJ9IiwgImZvcm1h
      dCI6ICJqc29uIn0KICAgICAgICByZXRfdmFsLCBqc29uX291dCwgZXJyX21zZyA9IHNlbGYuX2Nv
      bW1vbl9jbWRfanNvbl9nZW4oY21kX2pzb24pCiAgICAgICAgaWYgcmV0X3ZhbCAhPSAwIG9yIGxl
      bihqc29uX291dCkgPT0gMDoKICAgICAgICAgICAgcHJpbnQoZiJ1c2VyIHt1c2VyfSBub3QgZm91
      bmQgZm9yIHVwZ3JhZGluZy4iKQogICAgICAgICAgICByZXR1cm4KICAgICAgICBleGlzdGluZ19j
      YXBzID0ganNvbl9vdXRbMF1bImNhcHMiXQogICAgICAgIG5ld19jYXAsIF8gPSBzZWxmLmdldF9j
      YXBzX2FuZF9lbnRpdHkodXNlcikKICAgICAgICBjYXBfa2V5cyA9IFsibW9uIiwgIm1nciIsICJv
      c2QiLCAibWRzIl0KICAgICAgICBjYXBzID0gW10KICAgICAgICBmb3IgZWFjaENhcCBpbiBjYXBf
      a2V5czoKICAgICAgICAgICAgY3VyX2NhcF92YWx1ZXMgPSBleGlzdGluZ19jYXBzLmdldChlYWNo
      Q2FwLCAiIikKICAgICAgICAgICAgbmV3X2NhcF92YWx1ZXMgPSBuZXdfY2FwLmdldChlYWNoQ2Fw
      LCAiIikKICAgICAgICAgICAgY3VyX2NhcF9wZXJtX2xpc3QgPSBbCiAgICAgICAgICAgICAgICB4
      LnN0cmlwKCkgZm9yIHggaW4gY3VyX2NhcF92YWx1ZXMuc3BsaXQoIiwiKSBpZiB4LnN0cmlwKCkK
      ICAgICAgICAgICAgXQogICAgICAgICAgICBuZXdfY2FwX3Blcm1fbGlzdCA9IFsKICAgICAgICAg
      ICAgICAgIHguc3RyaXAoKSBmb3IgeCBpbiBuZXdfY2FwX3ZhbHVlcy5zcGxpdCgiLCIpIGlmIHgu
      c3RyaXAoKQogICAgICAgICAgICBdCiAgICAgICAgICAgICMgYXBwZW5kIG5ld19jYXBfbGlzdCB0
      byBjdXJfY2FwX2xpc3QgdG8gbWFpbnRhaW4gdGhlIG9yZGVyIG9mIGNhcHMKICAgICAgICAgICAg
      Y3VyX2NhcF9wZXJtX2xpc3QuZXh0ZW5kKG5ld19jYXBfcGVybV9saXN0KQogICAgICAgICAgICAj
      IGVsaW1pbmF0ZSBkdXBsaWNhdGVzIHdpdGhvdXQgdXNpbmcgJ3NldCcKICAgICAgICAgICAgIyBz
      ZXQgcmUtb3JkZXJzIGl0ZW1zIGluIHRoZSBsaXN0IGFuZCB3ZSBoYXZlIHRvIGtlZXAgdGhlIG9y
      ZGVyCiAgICAgICAgICAgIG5ld19jYXBfbGlzdCA9IFtdCiAgICAgICAgICAgIFtuZXdfY2FwX2xp
      c3QuYXBwZW5kKHgpIGZvciB4IGluIGN1cl9jYXBfcGVybV9saXN0IGlmIHggbm90IGluIG5ld19j
      YXBfbGlzdF0KICAgICAgICAgICAgZXhpc3RpbmdfY2Fwc1tlYWNoQ2FwXSA9ICIsICIuam9pbihu
      ZXdfY2FwX2xpc3QpCiAgICAgICAgICAgIGlmIGV4aXN0aW5nX2NhcHNbZWFjaENhcF06CiAgICAg
      ICAgICAgICAgICBjYXBzLmFwcGVuZChlYWNoQ2FwKQogICAgICAgICAgICAgICAgY2Fwcy5hcHBl
      bmQoZXhpc3RpbmdfY2Fwc1tlYWNoQ2FwXSkKICAgICAgICBjbWRfanNvbiA9IHsKICAgICAgICAg
      ICAgInByZWZpeCI6ICJhdXRoIGNhcHMiLAogICAgICAgICAgICAiZW50aXR5IjogdXNlciwKICAg
      ICAgICAgICAgImNhcHMiOiBjYXBzLAogICAgICAgICAgICAiZm9ybWF0IjogImpzb24iLAogICAg
      ICAgIH0KICAgICAgICByZXRfdmFsLCBqc29uX291dCwgZXJyX21zZyA9IHNlbGYuX2NvbW1vbl9j
      bWRfanNvbl9nZW4oY21kX2pzb24pCiAgICAgICAgaWYgcmV0X3ZhbCAhPSAwOgogICAgICAgICAg
      ICByYWlzZSBFeGVjdXRpb25GYWlsdXJlRXhjZXB0aW9uKAogICAgICAgICAgICAgICAgZiInYXV0
      aCBjYXBzIHt1c2VyfScgY29tbWFuZCBmYWlsZWQuXG4gRXJyb3I6IHtlcnJfbXNnfSIKICAgICAg
      ICAgICAgKQogICAgICAgIHByaW50KGYiVXBkYXRlZCB1c2VyIHt1c2VyfSBzdWNjZXNzZnVsbHku
      IikKCiAgICBkZWYgbWFpbihzZWxmKToKICAgICAgICBnZW5lcmF0ZWRfb3V0cHV0ID0gIiIKICAg
      ICAgICBpZiBzZWxmLl9hcmdfcGFyc2VyLnVwZ3JhZGU6CiAgICAgICAgICAgIHNlbGYudXBncmFk
      ZV91c2Vyc19wZXJtaXNzaW9ucygpCiAgICAgICAgZWxpZiBzZWxmLl9hcmdfcGFyc2VyLmZvcm1h
      dCA9PSAianNvbiI6CiAgICAgICAgICAgIGdlbmVyYXRlZF9vdXRwdXQgPSBzZWxmLmdlbl9qc29u
      X291dCgpCiAgICAgICAgZWxpZiBzZWxmLl9hcmdfcGFyc2VyLmZvcm1hdCA9PSAiYmFzaCI6CiAg
      ICAgICAgICAgIGdlbmVyYXRlZF9vdXRwdXQgPSBzZWxmLmdlbl9zaGVsbF9vdXQoKQogICAgICAg
      IGVsc2U6CiAgICAgICAgICAgIHJhaXNlIEV4ZWN1dGlvbkZhaWx1cmVFeGNlcHRpb24oCiAgICAg
      ICAgICAgICAgICBmIlVuc3VwcG9ydGVkIGZvcm1hdDoge3NlbGYuX2FyZ19wYXJzZXIuZm9ybWF0
      fSIKICAgICAgICAgICAgKQogICAgICAgIHByaW50KGdlbmVyYXRlZF9vdXRwdXQpCiAgICAgICAg
      aWYgc2VsZi5vdXRwdXRfZmlsZSBhbmQgZ2VuZXJhdGVkX291dHB1dDoKICAgICAgICAgICAgZk91
      dCA9IG9wZW4oc2VsZi5vdXRwdXRfZmlsZSwgbW9kZT0idyIsIGVuY29kaW5nPSJVVEYtOCIpCiAg
      ICAgICAgICAgIGZPdXQud3JpdGUoZ2VuZXJhdGVkX291dHB1dCkKICAgICAgICAgICAgZk91dC5j
      bG9zZSgpCgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMj
      CiMjIyMjIyMjIyMjIyMjIyMjIyMjIyBNQUlOICMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIyMjIyMj
      IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKaWYgX19uYW1lX18gPT0g
      Il9fbWFpbl9fIjoKICAgIHJqT2JqID0gUmFkb3NKU09OKCkKICAgIHRyeToKICAgICAgICByak9i
      ai5tYWluKCkKICAgIGV4Y2VwdCBFeGVjdXRpb25GYWlsdXJlRXhjZXB0aW9uIGFzIGVycjoKICAg
      ICAgICBwcmludChmIkV4ZWN1dGlvbiBGYWlsZWQ6IHtlcnJ9IikKICAgICAgICByYWlzZSBlcnIK
      ICAgIGV4Y2VwdCBLZXlFcnJvciBhcyBrRXJyOgogICAgICAgIHByaW50KGYiS2V5RXJyb3I6IHtr
      RXJyfSIpCiAgICBleGNlcHQgT1NFcnJvciBhcyBvc0VycjoKICAgICAgICBwcmludChmIkVycm9y
      IHdoaWxlIHRyeWluZyB0byBvdXRwdXQgdGhlIGRhdGE6IHtvc0Vycn0iKQogICAgZmluYWxseToK
      ICAgICAgICByak9iai5zaHV0ZG93bigpCg==
  name: rook-ceph.v{{.RookOperatorCsvVersion}}
  namespace: placeholder
spec:
  apiservicedefinitions: {}
  customresourcedefinitions:
    owned:
      - kind: CephCluster
        name: cephclusters.ceph.rook.io
        version: v1
        displayName: Ceph Cluster
        description: Represents a Ceph cluster.
      - kind: CephBlockPool
        name: cephblockpools.ceph.rook.io
        version: v1
        displayName: Ceph Block Pool
        description: Represents a Ceph Block Pool.
      - kind: CephObjectStore
        name: cephobjectstores.ceph.rook.io
        version: v1
        displayName: Ceph Object Store
        description: Represents a Ceph Object Store.
        specDescriptors:
          - description: Coding Chunks
            displayName: Coding Chunks
            path: dataPool.erasureCoded.codingChunks
            x-descriptors:
              - urn:alm:descriptor:com.tectonic.ui:fieldGroup:dataPool
              - urn:alm:descriptor:com.tectonic.ui:number
          - description: Data Chunks
            displayName: Data Chunks
            path: dataPool.erasureCoded.dataChunks
            x-descriptors:
              - urn:alm:descriptor:com.tectonic.ui:fieldGroup:dataPool
              - urn:alm:descriptor:com.tectonic.ui:number
          - description: failureDomain
            displayName: failureDomain
            path: dataPool.failureDomain
            x-descriptors:
              - urn:alm:descriptor:com.tectonic.ui:fieldGroup:dataPool
              - urn:alm:descriptor:com.tectonic.ui:text
          - description: Size
            displayName: Size
            path: dataPool.replicated.size
            x-descriptors:
              - urn:alm:descriptor:com.tectonic.ui:fieldGroup:dataPool
              - urn:alm:descriptor:com.tectonic.ui:number
          - description: Annotations
            displayName: Annotations
            path: gateway.annotations
            x-descriptors:
              - urn:alm:descriptor:com.tectonic.ui:fieldGroup:gateway
              - urn:alm:descriptor:io.kubernetes:annotations
          - description: Instances
            displayName: Instances
            path: gateway.instances
            x-descriptors:
              - urn:alm:descriptor:com.tectonic.ui:fieldGroup:gateway
              - urn:alm:descriptor:com.tectonic.ui:number
          - description: Resources
            displayName: Resources
            path: gateway.resources
            x-descriptors:
              - urn:alm:descriptor:com.tectonic.ui:fieldGroup:gateway
              - urn:alm:descriptor:com.tectonic.ui:resourceRequirements
          - description: placement
            displayName: placement
            path: gateway.placement
            x-descriptors:
              - urn:alm:descriptor:com.tectonic.ui:fieldGroup:gateway
              - urn:alm:descriptor:io.kubernetes:placement
          - description: securePort
            displayName: securePort
            path: gateway.securePort
            x-descriptors:
              - urn:alm:descriptor:com.tectonic.ui:fieldGroup:gateway
              - urn:alm:descriptor:io.kubernetes:securePort
          - description: sslCertificateRef
            displayName: sslCertificateRef
            path: gateway.sslCertificateRef
            x-descriptors:
              - urn:alm:descriptor:com.tectonic.ui:fieldGroup:gateway
              - urn:alm:descriptor:io.kubernetes:sslCertificateRef
          - description: Type
            displayName: Type
            path: gateway.type
            x-descriptors:
              - urn:alm:descriptor:com.tectonic.ui:fieldGroup:gateway
              - urn:alm:descriptor:com.tectonic.ui:text
          - description: Coding Chunks
            displayName: Coding Chunks
            path: metadataPool.erasureCoded.codingChunks
            x-descriptors:
              - urn:alm:descriptor:com.tectonic.ui:fieldGroup:metadataPool
              - urn:alm:descriptor:com.tectonic.ui:number
          - description: Data Chunks
            displayName: Data Chunks
            path: metadataPool.erasureCoded.dataChunks
            x-descriptors:
              - urn:alm:descriptor:com.tectonic.ui:fieldGroup:metadataPool
              - urn:alm:descriptor:com.tectonic.ui:number
          - description: failureDomain
            displayName: failureDomain
            path: metadataPool.failureDomain
            x-descriptors:
              - urn:alm:descriptor:com.tectonic.ui:fieldGroup:metadataPool
              - urn:alm:descriptor:com.tectonic.ui:text
          - description: Size
            displayName: Size
            path: metadataPool.replicated.size
            x-descriptors:
              - urn:alm:descriptor:com.tectonic.ui:fieldGroup:metadataPool
              - urn:alm:descriptor:com.tectonic.ui:number
      - kind: CephObjectStoreUser
        name: cephobjectstoreusers.ceph.rook.io
        version: v1
        displayName: Ceph Object Store User
        description: Represents a Ceph Object Store User.
      - kind: CephNFS
        name: cephnfses.ceph.rook.io
        version: v1
        displayName: Ceph NFS
        description: Represents a cluster of Ceph NFS ganesha gateways.
      - kind: CephClient
        name: cephclients.ceph.rook.io
        version: v1
        displayName: Ceph Client
        description: Represents a Ceph User.
      - kind: CephFilesystem
        name: cephfilesystems.ceph.rook.io
        version: v1
        displayName: Ceph Filesystem
        description: Represents a Ceph Filesystem.
      - kind: CephFilesystemMirror
        name: cephfilesystemmirrors.ceph.rook.io
        version: v1
        displayName: Ceph Filesystem Mirror
        description: Represents a Ceph Filesystem Mirror.
      - kind: CephRBDMirror
        name: cephrbdmirrors.ceph.rook.io
        version: v1
        displayName: Ceph RBD Mirror
        description: Represents a Ceph RBD Mirror.
      - kind: CephObjectRealm
        name: cephobjectrealms.ceph.rook.io
        version: v1
        displayName: Ceph Object Store Realm
        description: Represents a Ceph Object Store Realm.
      - kind: CephObjectZoneGroup
        name: cephobjectzonegroups.ceph.rook.io
        version: v1
        displayName: Ceph Object Store Zone Group
        description: Represents a Ceph Object Store Zone Group.
      - kind: CephObjectZone
        name: cephobjectzones.ceph.rook.io
        version: v1
        displayName: Ceph Object Store Zone
        description: Represents a Ceph Object Store Zone.
      - kind: CephBucketNotification
        name: cephbucketnotifications.ceph.rook.io
        version: v1
        displayName: Ceph Bucket Notification
        description: Represents a Ceph Bucket Notification.
      - kind: CephBucketTopic
        name: cephbuckettopics.ceph.rook.io
        version: v1
        displayName: Ceph Bucket Topic
        description: Represents a Ceph Bucket Topic.
      - kind: CephFilesystemSubVolumeGroup
        name: cephfilesystemsubvolumegroups.ceph.rook.io
        version: v1
        displayName: Ceph Filesystem SubVolumeGroup
        description: Represents a Ceph Filesystem SubVolumeGroup.
      - kind: CephBlockPoolRadosNamespace
        name: cephblockpoolradosnamespaces.ceph.rook.io
        version: v1
        displayName: Ceph BlockPool Rados Namespace
        description: Represents a Ceph BlockPool Rados Namespace.
  description: |2

    The Rook-Ceph storage operator packages, deploys, manages, upgrades and scales Ceph storage for providing persistent storage to infrastructure services (Logging, Metrics, Registry) as well as stateful applications in Kubernetes clusters.

    ## Rook-Ceph Storage Operator

    Rook runs as a cloud-native service in Kubernetes clusters for optimal integration with applications in need of storage, and handles the heavy-lifting behind the scenes such as provisioning and management.
    Rook orchestrates battle-tested open-source storage technology Ceph, which has years of production deployments and runs some of the worlds largest clusters.

    Ceph is a massively scalable, software-defined, cloud native storage platform that offers block, file and object storage services.
    Ceph can be used to back a wide variety of applications including relational databases, NoSQL databases, CI/CD tool-sets, messaging, AI/ML and analytics applications.
    Ceph is a proven storage platform that backs some of the world's largest storage deployments and has a large vibrant open source community backing the project.

    ## Supported features
    * **High Availability and resiliency** - Ceph has no single point of failures (SPOF) and all its components work natively in a highly available fashion
    * **Data Protection** - Ceph periodically scrub for inconsistent objects and repair them if necessary, making sure your replicas are always coherent
    * **Consistent storage platform across hybrid cloud** - Ceph can be deployed anywhere (on-premise or bare metal) and thus offers a similar experience regardless
    * **Block, File & Object storage service** - Ceph can expose your data through several storage interfaces, solving all the application use cases
    * **Scale up/down** - addition and removal of storage is fully covered by the operator.
    * **Dashboard** - The Operator deploys a dashboard for monitoring and introspecting your cluster.

    ## Before you start
    https://rook.io/docs/rook/v1.0/k8s-pre-reqs.html
  displayName: Rook-Ceph
  icon:
    - base64data: PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDIzLjAuMiwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHZpZXdCb3g9IjAgMCA3MCA3MCIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNzAgNzA7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPHN0eWxlIHR5cGU9InRleHQvY3NzIj4KCS5zdDB7ZmlsbDojMkIyQjJCO30KPC9zdHlsZT4KPGc+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggY2xhc3M9InN0MCIgZD0iTTUwLjUsNjcuNkgxOS45Yy04LDAtMTQuNS02LjUtMTQuNS0xNC41VjI5LjJjMC0xLjEsMC45LTIuMSwyLjEtMi4xaDU1LjRjMS4xLDAsMi4xLDAuOSwyLjEsMi4xdjIzLjkKCQkJCUM2NSw2MS4xLDU4LjUsNjcuNiw1MC41LDY3LjZ6IE05LjYsMzEuMnYyMS45YzAsNS43LDQuNiwxMC4zLDEwLjMsMTAuM2gzMC42YzUuNywwLDEwLjMtNC42LDEwLjMtMTAuM1YzMS4ySDkuNnoiLz4KCQk8L2c+CgkJPGc+CgkJCTxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik00Mi40LDU2LjdIMjhjLTEuMSwwLTIuMS0wLjktMi4xLTIuMXYtNy4yYzAtNS4xLDQuMi05LjMsOS4zLTkuM3M5LjMsNC4yLDkuMyw5LjN2Ny4yCgkJCQlDNDQuNSw1NS43LDQzLjYsNTYuNyw0Mi40LDU2Ljd6IE0zMCw1Mi41aDEwLjN2LTUuMmMwLTIuOS0yLjMtNS4yLTUuMi01LjJjLTIuOSwwLTUuMiwyLjMtNS4yLDUuMlY1Mi41eiIvPgoJCTwvZz4KCQk8Zz4KCQkJPHBhdGggY2xhc3M9InN0MCIgZD0iTTYyLjksMjMuMkM2Mi45LDIzLjIsNjIuOSwyMy4yLDYyLjksMjMuMmwtMTEuMSwwYy0xLjEsMC0yLjEtMC45LTIuMS0yLjFjMC0xLjEsMC45LTIuMSwyLjEtMi4xCgkJCQljMCwwLDAsMCwwLDBsOS4xLDBWNi43aC02Ljl2My41YzAsMC41LTAuMiwxLjEtMC42LDEuNWMtMC40LDAuNC0wLjksMC42LTEuNSwwLjZsMCwwbC0xMS4xLDBjLTEuMSwwLTIuMS0wLjktMi4xLTIuMVY2LjdoLTYuOQoJCQkJdjMuNWMwLDEuMS0wLjksMi4xLTIuMSwyLjFsLTExLjEsMGMtMC41LDAtMS4xLTAuMi0xLjUtMC42Yy0wLjQtMC40LTAuNi0wLjktMC42LTEuNVY2LjdIOS42djEyLjRoOWMxLjEsMCwyLjEsMC45LDIuMSwyLjEKCQkJCXMtMC45LDIuMS0yLjEsMi4xaC0xMWMtMS4xLDAtMi4xLTAuOS0yLjEtMi4xVjQuNmMwLTEuMSwwLjktMi4xLDIuMS0yLjFoMTEuMWMxLjEsMCwyLjEsMC45LDIuMSwyLjF2My41bDcsMFY0LjYKCQkJCWMwLTEuMSwwLjktMi4xLDIuMS0yLjFoMTEuMWMxLjEsMCwyLjEsMC45LDIuMSwyLjF2My41bDYuOSwwVjQuNmMwLTEuMSwwLjktMi4xLDIuMS0yLjFoMTEuMUM2NCwyLjYsNjUsMy41LDY1LDQuNnYxNi41CgkJCQljMCwwLjUtMC4yLDEuMS0wLjYsMS41QzY0LDIzLDYzLjQsMjMuMiw2Mi45LDIzLjJ6Ii8+CgkJPC9nPgoJPC9nPgo8L2c+Cjwvc3ZnPg==
      mediatype: image/svg+xml
  install:
    spec:
      clusterPermissions:
        - rules:
            - apiGroups:
                - ""
              resources:
                - configmaps
                - nodes
                - nodes/proxy
                - persistentvolumes
              verbs:
                - get
                - list
                - watch
            - apiGroups:
                - ""
              resources:
                - events
              verbs:
                - create
                - patch
                - list
                - get
                - watch
            - apiGroups:
                - storage.k8s.io
              resources:
                - storageclasses
              verbs:
                - get
                - list
                - watch
          serviceAccountName: rook-ceph-mgr
        - rules:
            - apiGroups:
                - ""
              resources:
                - nodes
              verbs:
                - get
                - list
          serviceAccountName: rook-ceph-osd
        - rules:
            - apiGroups:
                - ""
              resources:
                - pods
                - nodes
                - nodes/proxy
                - services
                - secrets
                - configmaps
              verbs:
                - get
                - list
                - watch
            - apiGroups:
                - ""
              resources:
                - events
                - persistentvolumes
                - persistentvolumeclaims
                - endpoints
              verbs:
                - get
                - list
                - watch
                - patch
                - create
                - update
                - delete
            - apiGroups:
                - storage.k8s.io
              resources:
                - storageclasses
              verbs:
                - get
                - list
                - watch
            - apiGroups:
                - batch
              resources:
                - jobs
                - cronjobs
              verbs:
                - get
                - list
                - watch
                - create
                - update
                - delete
                - deletecollection
            - apiGroups:
                - ceph.rook.io
              resources:
                - cephclients
                - cephclusters
                - cephblockpools
                - cephfilesystems
                - cephnfses
                - cephobjectstores
                - cephobjectstoreusers
                - cephobjectrealms
                - cephobjectzonegroups
                - cephobjectzones
                - cephbuckettopics
                - cephbucketnotifications
                - cephrbdmirrors
                - cephfilesystemmirrors
                - cephfilesystemsubvolumegroups
                - cephblockpoolradosnamespaces
              verbs:
                - get
                - list
                - watch
                - update
            - apiGroups:
                - ceph.rook.io
              resources:
                - cephclients/status
                - cephclusters/status
                - cephblockpools/status
                - cephfilesystems/status
                - cephnfses/status
                - cephobjectstores/status
                - cephobjectstoreusers/status
                - cephobjectrealms/status
                - cephobjectzonegroups/status
                - cephobjectzones/status
                - cephbuckettopics/status
                - cephbucketnotifications/status
                - cephrbdmirrors/status
                - cephfilesystemmirrors/status
                - cephfilesystemsubvolumegroups/status
                - cephblockpoolradosnamespaces/status
              verbs:
                - update
            - apiGroups:
                - ceph.rook.io
              resources:
                - cephclients/finalizers
                - cephclusters/finalizers
                - cephblockpools/finalizers
                - cephfilesystems/finalizers
                - cephnfses/finalizers
                - cephobjectstores/finalizers
                - cephobjectstoreusers/finalizers
                - cephobjectrealms/finalizers
                - cephobjectzonegroups/finalizers
                - cephobjectzones/finalizers
                - cephbuckettopics/finalizers
                - cephbucketnotifications/finalizers
                - cephrbdmirrors/finalizers
                - cephfilesystemmirrors/finalizers
                - cephfilesystemsubvolumegroups/finalizers
                - cephblockpoolradosnamespaces/finalizers
              verbs:
                - update
            - apiGroups:
                - policy
                - apps
                - extensions
              resources:
                - poddisruptionbudgets
                - deployments
                - replicasets
              verbs:
                - get
                - list
                - watch
                - create
                - update
                - delete
                - deletecollection
            - apiGroups:
                - apps
              resources:
                - deployments/finalizers
              verbs:
                - update
            - apiGroups:
                - healthchecking.openshift.io
              resources:
                - machinedisruptionbudgets
              verbs:
                - get
                - list
                - watch
                - create
                - update
                - delete
            - apiGroups:
                - machine.openshift.io
              resources:
                - machines
              verbs:
                - get
                - list
                - watch
                - create
                - update
                - delete
            - apiGroups:
                - storage.k8s.io
              resources:
                - csidrivers
              verbs:
                - create
                - delete
                - get
                - update
            - apiGroups:
                - k8s.cni.cncf.io
              resources:
                - network-attachment-definitions
              verbs:
                - get
            - apiGroups:
                - ""
              resources:
                - secrets
                - configmaps
              verbs:
                - get
                - create
                - update
                - delete
            - apiGroups:
                - storage.k8s.io
              resources:
                - storageclasses
              verbs:
                - get
            - apiGroups:
                - objectbucket.io
              resources:
                - objectbucketclaims
              verbs:
                - list
                - watch
                - get
                - update
            - apiGroups:
                - objectbucket.io
              resources:
                - objectbuckets
              verbs:
                - list
                - watch
                - get
                - create
                - update
                - delete
            - apiGroups:
                - objectbucket.io
              resources:
                - objectbucketclaims/status
                - objectbuckets/status
              verbs:
                - update
            - apiGroups:
                - objectbucket.io
              resources:
                - objectbucketclaims/finalizers
                - objectbuckets/finalizers
              verbs:
                - update
            - apiGroups:
                - ""
              resources:
                - pods
                - pods/log
              verbs:
                - get
                - list
            - apiGroups:
                - ""
              resources:
                - pods/exec
              verbs:
                - create
            - apiGroups:
                - admissionregistration.k8s.io
              resources:
                - validatingwebhookconfigurations
              verbs:
                - create
                - get
                - delete
                - update
          serviceAccountName: rook-ceph-system
        - rules:
            - apiGroups:
                - ""
              resources:
                - nodes
              verbs:
                - get
          serviceAccountName: rook-csi-cephfs-plugin-sa
        - rules:
            - apiGroups:
                - ""
              resources:
                - secrets
              verbs:
                - get
                - list
            - apiGroups:
                - ""
              resources:
                - nodes
              verbs:
                - get
                - list
                - watch
            - apiGroups:
                - ""
              resources:
                - persistentvolumes
              verbs:
                - get
                - list
                - watch
                - create
                - delete
                - patch
            - apiGroups:
                - ""
              resources:
                - persistentvolumeclaims
              verbs:
                - get
                - list
                - watch
                - patch
                - update
            - apiGroups:
                - storage.k8s.io
              resources:
                - storageclasses
              verbs:
                - get
                - list
                - watch
            - apiGroups:
                - ""
              resources:
                - events
              verbs:
                - list
                - watch
                - create
                - update
                - patch
            - apiGroups:
                - storage.k8s.io
              resources:
                - volumeattachments
              verbs:
                - get
                - list
                - watch
                - patch
            - apiGroups:
                - storage.k8s.io
              resources:
                - volumeattachments/status
              verbs:
                - patch
            - apiGroups:
                - ""
              resources:
                - persistentvolumeclaims/status
              verbs:
                - patch
            - apiGroups:
                - snapshot.storage.k8s.io
              resources:
                - volumesnapshots
              verbs:
                - get
                - list
            - apiGroups:
                - snapshot.storage.k8s.io
              resources:
                - volumesnapshotclasses
              verbs:
                - get
                - list
                - watch
            - apiGroups:
                - snapshot.storage.k8s.io
              resources:
                - volumesnapshotcontents
              verbs:
                - get
                - list
                - watch
                - patch
                - update
            - apiGroups:
                - snapshot.storage.k8s.io
              resources:
                - volumesnapshotcontents/status
              verbs:
                - update
                - patch
          serviceAccountName: rook-csi-cephfs-provisioner-sa
        - rules:
            - apiGroups:
                - ""
              resources:
                - nodes
              verbs:
                - get
          serviceAccountName: rook-csi-nfs-plugin-sa
        - rules:
            - apiGroups:
                - ""
              resources:
                - persistentvolumes
              verbs:
                - get
                - list
                - watch
                - create
                - delete
                - patch
            - apiGroups:
                - ""
              resources:
                - persistentvolumeclaims
              verbs:
                - get
                - list
                - watch
                - patch
                - update
            - apiGroups:
                - storage.k8s.io
              resources:
                - storageclasses
              verbs:
                - get
                - list
                - watch
            - apiGroups:
                - ""
              resources:
                - events
              verbs:
                - get
                - list
                - watch
                - create
                - update
                - patch
            - apiGroups:
                - storage.k8s.io
              resources:
                - csinodes
              verbs:
                - get
                - list
                - watch
            - apiGroups:
                - ""
              resources:
                - nodes
              verbs:
                - get
                - list
                - watch
            - apiGroups:
                - coordination.k8s.io
              resources:
                - leases
              verbs:
                - get
                - list
                - watch
                - create
                - update
                - patch
            - apiGroups:
                - ""
              resources:
                - secrets
              verbs:
                - get
            - apiGroups:
                - snapshot.storage.k8s.io
              resources:
                - volumesnapshotclasses
              verbs:
                - get
                - list
                - watch
            - apiGroups:
                - snapshot.storage.k8s.io
              resources:
                - volumesnapshotcontents
              verbs:
                - get
                - list
                - watch
                - update
                - patch
            - apiGroups:
                - snapshot.storage.k8s.io
              resources:
                - volumesnapshotcontents/status
              verbs:
                - update
                - patch
            - apiGroups:
                - snapshot.storage.k8s.io
              resources:
                - volumesnapshots
              verbs:
                - get
                - list
            - apiGroups:
                - ""
              resources:
                - persistentvolumeclaims/status
              verbs:
                - patch
            - apiGroups:
                - storage.k8s.io
              resources:
                - volumeattachments
              verbs:
                - get
                - list
                - watch
                - patch
            - apiGroups:
                - storage.k8s.io
              resources:
                - volumeattachments/status
              verbs:
                - patch
          serviceAccountName: rook-csi-nfs-provisioner-sa
        - rules:
            - apiGroups:
                - ""
              resources:
                - secrets
              verbs:
                - get
                - list
            - apiGroups:
                - ""
              resources:
                - persistentvolumes
              verbs:
                - get
                - list
            - apiGroups:
                - storage.k8s.io
              resources:
                - volumeattachments
              verbs:
                - get
                - list
            - apiGroups:
                - ""
              resources:
                - configmaps
              verbs:
                - get
            - apiGroups:
                - ""
              resources:
                - serviceaccounts
              verbs:
                - get
            - apiGroups:
                - ""
              resources:
                - serviceaccounts/token
              verbs:
                - create
            - apiGroups:
                - ""
              resources:
                - nodes
              verbs:
                - get
          serviceAccountName: rook-csi-rbd-plugin-sa
        - rules:
            - apiGroups:
                - ""
              resources:
                - secrets
              verbs:
                - get
                - list
                - watch
            - apiGroups:
                - ""
              resources:
                - persistentvolumes
              verbs:
                - get
                - list
                - watch
                - create
                - delete
                - patch
            - apiGroups:
                - ""
              resources:
                - persistentvolumeclaims
              verbs:
                - get
                - list
                - watch
                - update
            - apiGroups:
                - storage.k8s.io
              resources:
                - storageclasses
              verbs:
                - get
                - list
                - watch
            - apiGroups:
                - ""
              resources:
                - events
              verbs:
                - list
                - watch
                - create
                - update
                - patch
            - apiGroups:
                - storage.k8s.io
              resources:
                - volumeattachments
              verbs:
                - get
                - list
                - watch
                - patch
            - apiGroups:
                - storage.k8s.io
              resources:
                - volumeattachments/status
              verbs:
                - patch
            - apiGroups:
                - ""
              resources:
                - nodes
              verbs:
                - get
                - list
                - watch
            - apiGroups:
                - storage.k8s.io
              resources:
                - csinodes
              verbs:
                - get
                - list
                - watch
            - apiGroups:
                - ""
              resources:
                - persistentvolumeclaims/status
              verbs:
                - patch
            - apiGroups:
                - snapshot.storage.k8s.io
              resources:
                - volumesnapshots
              verbs:
                - get
                - list
                - watch
            - apiGroups:
                - snapshot.storage.k8s.io
              resources:
                - volumesnapshotclasses
              verbs:
                - get
                - list
                - watch
            - apiGroups:
                - snapshot.storage.k8s.io
              resources:
                - volumesnapshotcontents
              verbs:
                - get
                - list
                - watch
                - patch
                - update
            - apiGroups:
                - snapshot.storage.k8s.io
              resources:
                - volumesnapshotcontents/status
              verbs:
                - update
                - patch
            - apiGroups:
                - ""
              resources:
                - configmaps
              verbs:
                - get
            - apiGroups:
                - ""
              resources:
                - serviceaccounts
              verbs:
                - get
            - apiGroups:
                - ""
              resources:
                - serviceaccounts/token
              verbs:
                - create
            - apiGroups:
                - ""
              resources:
                - nodes
              verbs:
                - get
                - list
                - watch
            - apiGroups:
                - storage.k8s.io
              resources:
                - csinodes
              verbs:
                - get
                - list
                - watch
          serviceAccountName: rook-csi-rbd-provisioner-sa
        - rules:
            - verbs:
                - use
              apiGroups:
                - security.openshift.io
              resources:
                - securitycontextconstraints
              resourceNames:
                - privileged
          serviceAccountName: rook-ceph-system
      deployments:
        - label:
            app.kubernetes.io/component: rook-ceph-operator
            app.kubernetes.io/instance: rook-ceph
            app.kubernetes.io/name: rook-ceph
            app.kubernetes.io/part-of: rook-ceph-operator
            operator: rook
            storage-backend: ceph
          name: rook-ceph-operator
          spec:
            replicas: 1
            selector:
              matchLabels:
                app: rook-ceph-operator
            strategy:
              type: Recreate
            template:
              metadata:
                labels:
                  app: rook-ceph-operator
              spec:
                containers:
                  - args:
                      - ceph
                      - operator
                    env:
                      - name: ROOK_CURRENT_NAMESPACE_ONLY
                        value: "false"
                      - name: ROOK_DISCOVER_DEVICES_INTERVAL
                        value: 60m
                      - name: ROOK_HOSTPATH_REQUIRES_PRIVILEGED
                        value: "true"
                      - name: ROOK_DISABLE_DEVICE_HOTPLUG
                        value: "false"
                      - name: DISCOVER_DAEMON_UDEV_BLACKLIST
                        value: (?i)dm-[0-9]+,(?i)rbd[0-9]+,(?i)nbd[0-9]+
                      - name: ROOK_ENABLE_MACHINE_DISRUPTION_BUDGET
                        value: "false"
                      - name: ROOK_UNREACHABLE_NODE_TOLERATION_SECONDS
                        value: "5"
                      - name: NODE_NAME
                        valueFrom:
                          fieldRef:
                            fieldPath: spec.nodeName
                      - name: POD_NAME
                        valueFrom:
                          fieldRef:
                            fieldPath: metadata.name
                      - name: POD_NAMESPACE
                        valueFrom:
                          fieldRef:
                            fieldPath: metadata.namespace
                    image: {{.RookOperatorImage}}
                    name: rook-ceph-operator
                    ports:
                      - containerPort: 9443
                        name: https-webhook
                        protocol: TCP
                    resources: {}
                    securityContext:
                      runAsGroup: 2016
                      runAsNonRoot: true
                      runAsUser: 2016
                    volumeMounts:
                      - mountPath: /var/lib/rook
                        name: rook-config
                      - mountPath: /etc/ceph
                        name: default-config-dir
                      - mountPath: /etc/webhook
                        name: webhook-cert
                serviceAccountName: rook-ceph-system
                volumes:
                  - emptyDir: {}
                    name: rook-config
                  - emptyDir: {}
                    name: default-config-dir
                  - emptyDir: {}
                    name: webhook-cert
      permissions:
        - rules:
            - apiGroups:
                - ""
              resources:
                - pods
                - configmaps
              verbs:
                - get
                - list
                - watch
                - create
                - update
                - delete
          serviceAccountName: rook-ceph-cmd-reporter
        - rules:
            - apiGroups:
                - ""
              resources:
                - pods
                - services
                - pods/log
              verbs:
                - get
                - list
                - watch
                - create
                - update
                - delete
            - apiGroups:
                - batch
              resources:
                - jobs
              verbs:
                - get
                - list
                - watch
                - create
                - update
                - delete
            - apiGroups:
                - ceph.rook.io
              resources:
                - cephclients
                - cephclusters
                - cephblockpools
                - cephfilesystems
                - cephnfses
                - cephobjectstores
                - cephobjectstoreusers
                - cephobjectrealms
                - cephobjectzonegroups
                - cephobjectzones
                - cephbuckettopics
                - cephbucketnotifications
                - cephrbdmirrors
                - cephfilesystemmirrors
                - cephfilesystemsubvolumegroups
                - cephblockpoolradosnamespaces
              verbs:
                - get
                - list
                - watch
                - create
                - update
                - delete
                - patch
            - apiGroups:
                - apps
              resources:
                - deployments/scale
                - deployments
              verbs:
                - patch
                - delete
            - apiGroups:
                - ""
              resources:
                - persistentvolumeclaims
              verbs:
                - delete
            - apiGroups:
                - ""
              resources:
                - configmaps
              verbs:
                - get
                - list
                - watch
          serviceAccountName: rook-ceph-mgr
        - rules:
            - apiGroups:
                - ""
              resources:
                - secrets
              verbs:
                - get
                - update
            - apiGroups:
                - ""
              resources:
                - configmaps
              verbs:
                - get
                - list
                - watch
                - create
                - update
                - delete
            - apiGroups:
                - ceph.rook.io
              resources:
                - cephclusters
                - cephclusters/finalizers
              verbs:
                - get
                - list
                - create
                - update
                - delete
          serviceAccountName: rook-ceph-osd
        - rules:
            - apiGroups:
                - ""
              resources:
                - configmaps
              verbs:
                - get
            - apiGroups:
                - apps
              resources:
                - deployments
              verbs:
                - get
                - delete
            - apiGroups:
                - batch
              resources:
                - jobs
              verbs:
                - get
                - list
                - delete
            - apiGroups:
                - ""
              resources:
                - persistentvolumeclaims
              verbs:
                - get
                - update
                - delete
                - list
          serviceAccountName: rook-ceph-purge-osd
        - rules:
            - apiGroups:
                - ""
              resources:
                - configmaps
              verbs:
                - get
          serviceAccountName: rook-ceph-rgw
        - rules:
            - apiGroups:
                - ""
                - apps
                - extensions
              resources:
                - secrets
                - pods
                - pods/log
                - services
                - configmaps
                - deployments
                - daemonsets
              verbs:
                - get
                - list
                - watch
                - patch
                - create
                - update
                - delete
            - apiGroups:
                - ""
              resources:
                - pods
                - configmaps
                - services
              verbs:
                - get
                - list
                - watch
                - patch
                - create
                - update
                - delete
            - apiGroups:
                - apps
                - extensions
              resources:
                - daemonsets
                - statefulsets
                - deployments
              verbs:
                - get
                - list
                - watch
                - create
                - update
                - delete
            - apiGroups:
                - batch
              resources:
                - cronjobs
              verbs:
                - delete
            - apiGroups:
                - cert-manager.io
              resources:
                - certificates
                - issuers
              verbs:
                - get
                - create
                - delete
            - apiGroups:
                - multicluster.x-k8s.io
              resources:
                - serviceexports
              verbs:
                - get
                - create
          serviceAccountName: rook-ceph-system
        - rules:
            - apiGroups:
                - coordination.k8s.io
              resources:
                - leases
              verbs:
                - get
                - watch
                - list
                - delete
                - update
                - create
          serviceAccountName: rook-csi-cephfs-provisioner-sa
        - rules:
            - apiGroups:
                - csiaddons.openshift.io
              resources:
                - csiaddonsnodes
              verbs:
                - create
          serviceAccountName: rook-csi-rbd-plugin-sa
        - rules:
            - apiGroups:
                - coordination.k8s.io
              resources:
                - leases
              verbs:
                - get
                - watch
                - list
                - delete
                - update
                - create
            - apiGroups:
                - csiaddons.openshift.io
              resources:
                - csiaddonsnodes
              verbs:
                - create
          serviceAccountName: rook-csi-rbd-provisioner-sa
    strategy: deployment
  installModes:
    - type: OwnNamespace
      supported: true
    - type: SingleNamespace
      supported: true
    - type: MultiNamespace
      supported: false
    - type: AllNamespaces
      supported: false
  keywords:
    - rook
    - ceph
    - storage
    - object storage
    - open source
    - block storage
    - shared filesystem
  links:
    - name: Blog
      url: https://blog.rook.io
    - name: Documentation
      url: https://rook.github.io/docs/rook/v1.0/
  maintainers:
    - name: Red Hat, Inc.
      email: customerservice@redhat.com
  maturity: alpha
  provider:
    name: Provider Name
    url: https://your.domain
  version: {{.RookOperatorCsvVersion}}
  replaces: rook-ceph.v1.1.1
  minKubeVersion: 1.10.0
  labels:
    alm-owner-etcd: rookoperator
    operated-by: rookoperator
  selector:
    matchLabels:
      alm-owner-etcd: rookoperator
      operated-by: rookoperator
